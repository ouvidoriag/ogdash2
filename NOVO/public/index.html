<!doctype html>
<html lang="pt-br">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Ouvidoria - Duque de Caxias - Dashboard</title>
    <link rel="icon" type="image/png" href="/dc-logo.png" />
    <!-- Tailwind CSS via CDN (apenas para desenvolvimento) -->
    <!-- Em produ√ß√£o, usar build process ou CSS compilado -->
    <script>
      // Carregar Tailwind CSS apenas se n√£o estiver em produ√ß√£o
      if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
        const tailwindScript = document.createElement('script');
        tailwindScript.src = 'https://cdn.tailwindcss.com';
        tailwindScript.onload = () => {
          if (window.tailwind) {
            window.tailwind.config = window.tailwind.config || {};
            window.tailwind.config.silent = true;
          }
        };
        document.head.appendChild(tailwindScript);
      } else {
        // Em produ√ß√£o, usar CSS compilado (adicionar link para arquivo CSS compilado)
        const tailwindCSS = document.createElement('link');
        tailwindCSS.rel = 'stylesheet';
        tailwindCSS.href = '/styles/tailwind.css'; // Arquivo CSS compilado
        document.head.appendChild(tailwindCSS);
      }
    </script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
    <!-- Google Fonts - Rajdhani (mesma fonte do painel de login) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
      :root {
        --bg: #0b1020;
        --panel: #0f172a;
        --muted: #94a3b8;
        --primary: #22d3ee;
        --accent: #a78bfa;
        --success: #34d399;
        --danger: #fb7185;
        --text-primary: #f1f5f9;
        --text-secondary: #cbd5e1;
        --border: rgba(255,255,255,0.08);
      }
      
      /* Modo Escuro (padr√£o) */
      body.dark-mode,
      body:not(.light-mode) {
        --bg: #0b1020;
        --panel: #0f172a;
        --muted: #94a3b8;
        --text-primary: #f1f5f9;
        --text-secondary: #cbd5e1;
        --border: rgba(255,255,255,0.08);
      }
      
      /* Modo Claro */
      body.light-mode {
        --bg: #f5f7fb;
        --panel: #ffffff;
        --muted: #334155;
        --text-primary: #0f172a;
        --text-secondary: #1e293b;
        --border: rgba(15,23,42,0.12);
        --light-accent: #e0f2ff;
        --light-soft: #eef2ff;
      }
      
      /* Aplicar fonte Rajdhani globalmente */
      * {
        font-family: 'Rajdhani', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      }
      
      body { 
        font-family: 'Rajdhani', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        background: radial-gradient(1200px 600px at top left, rgba(34,211,238,0.08), transparent 60%), 
                    radial-gradient(1200px 600px at bottom right, rgba(167,139,250,0.08), transparent 60%), 
                    var(--bg);
        color: var(--text-primary);
        transition: background-color 0.3s ease, color 0.3s ease;
      }
      
      /* Garantir que inputs, buttons, selects e textareas tamb√©m usem Rajdhani */
      input, button, select, textarea, label, span, div, p, h1, h2, h3, h4, h5, h6, a, li, td, th {
        font-family: 'Rajdhani', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      }
      
      body.light-mode {
        background: radial-gradient(1500px 700px at top left, rgba(34,211,238,0.12), transparent 60%), 
                    radial-gradient(1500px 700px at bottom right, rgba(167,139,250,0.12), transparent 60%), 
                    linear-gradient(160deg, #f8fbff 0%, #eef2ff 35%, #e0f2ff 100%);
      }
      
      .glass { 
        background: linear-gradient(180deg, rgba(255,255,255,0.04), rgba(255,255,255,0.02)); 
        box-shadow: 0 10px 30px rgba(0,0,0,0.35), inset 0 1px 0 rgba(255,255,255,0.08); 
        border: 1px solid var(--border);
        transition: background 0.3s ease, border-color 0.3s ease, box-shadow 0.3s ease;
      }
      
      body.light-mode .glass {
        background: linear-gradient(180deg, rgba(255,255,255,0.97), rgba(255,255,255,0.9)); 
        box-shadow: 0 18px 40px rgba(15,23,42,0.12), inset 0 1px 0 rgba(255,255,255,0.85); 
        border: 1px solid rgba(148,163,184,0.25);
      }

      body.light-mode .glass .section-title,
      body.light-mode .glass .text-xs {
        color: var(--text-primary) !important;
      }

      body.light-mode .glass .muted-label {
        color: var(--text-secondary) !important;
      }
      
      body.light-mode .glass {
        color: var(--text-primary) !important;
      }
      
      body.light-mode .glass * {
        color: inherit;
      }
      
      .neon { text-shadow: 0 0 12px rgba(34,211,238,0.65), 0 0 24px rgba(167,139,250,0.45); }
      body.light-mode .neon { text-shadow: 0 0 8px rgba(34,211,238,0.4), 0 0 16px rgba(167,139,250,0.3); }
      
      .glow-ring { box-shadow: 0 0 0 2px rgba(34,211,238,0.15), 0 0 32px rgba(34,211,238,0.25); }
      body.light-mode .glow-ring { box-shadow: 0 0 0 2px rgba(34,211,238,0.2), 0 0 24px rgba(34,211,238,0.3); }
      
      .skeleton { background: rgba(255,255,255,0.06); }
      body.light-mode .skeleton { background: rgba(148,163,184,0.15); }
      
      /* Estilos para gr√°ficos e KPIs clic√°veis e interligados */
      .chart-clickable {
        transition: all 0.2s ease;
      }
      .chart-clickable:hover {
        transform: scale(1.02);
        box-shadow: 0 0 20px rgba(34, 211, 238, 0.2);
      }
      
      .kpi-clickable {
        transition: all 0.2s ease;
        border: 1px solid transparent;
      }
      .kpi-clickable:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        border-color: rgba(34, 211, 238, 0.3);
      }
      .kpi-clickable.kpi-active {
        border-color: rgba(34, 211, 238, 0.5) !important;
        background: rgba(34, 211, 238, 0.05) !important;
        box-shadow: 0 0 20px rgba(34, 211, 238, 0.15);
      }
      
      body.light-mode .kpi-clickable:hover {
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      }
      body.light-mode .kpi-clickable.kpi-active {
        border-color: rgba(34, 211, 238, 0.4) !important;
        background: rgba(34, 211, 238, 0.1) !important;
      }
      
      canvas { max-height: 340px; }
      
      /* Bot√£o de altern√¢ncia de tema */
      .theme-toggle-container {
        position: fixed;
        top: 20px;
        right: 20px;
        z-index: 1000;
      }
      
      .theme-toggle {
        position: relative;
        width: 50px;
        height: 26px;
        background: rgba(255,255,255,0.1);
        border-radius: 13px;
        border: 1px solid var(--border);
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      }
      
      body.light-mode .theme-toggle {
        background: rgba(0,0,0,0.1);
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      }
      
      .theme-toggle::before {
        content: '';
        position: absolute;
        width: 20px;
        height: 20px;
        border-radius: 50%;
        background: #fbbf24;
        top: 2px;
        left: 2px;
        transition: all 0.3s ease;
        box-shadow: 0 2px 4px rgba(0,0,0,0.2);
      }
      
      body.light-mode .theme-toggle::before {
        left: calc(100% - 22px);
        background: #f59e0b;
      }
      
      .theme-toggle:hover {
        transform: scale(1.05);
        box-shadow: 0 6px 16px rgba(0,0,0,0.2);
      }
      
      body.light-mode .theme-toggle:hover {
        box-shadow: 0 6px 16px rgba(0,0,0,0.15);
      }
      
      .sr-only {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border-width: 0;
      }
      
      nav[id="sideMenuOuvidoria"] div[data-page].active,
      nav[id="sideMenuZeladoria"] div[data-page].active,
      nav[id="sideMenuEsic"] div[data-page].active {
        background: linear-gradient(90deg, rgba(34,211,238,0.15) 0%, rgba(34,211,238,0.05) 100%);
        border-left: 3px solid #22d3ee;
        color: #22d3ee;
        font-weight: 600;
      }
      
      body.light-mode nav[id="sideMenuOuvidoria"] div[data-page].active,
      body.light-mode nav[id="sideMenuZeladoria"] div[data-page].active,
      body.light-mode nav[id="sideMenuEsic"] div[data-page].active {
        background: linear-gradient(90deg, rgba(34,211,238,0.25) 0%, rgba(34,211,238,0.15) 100%);
        border-left: 3px solid #0891b2;
        color: #0e7490 !important;
        font-weight: 600;
      }
      
      nav[id="sideMenuOuvidoria"] div[data-page]:hover:not(.active),
      nav[id="sideMenuZeladoria"] div[data-page]:hover:not(.active),
      nav[id="sideMenuEsic"] div[data-page]:hover:not(.active) {
        background: rgba(255,255,255,0.05);
      }
      
      body.light-mode nav[id="sideMenuOuvidoria"] div[data-page]:hover:not(.active),
      body.light-mode nav[id="sideMenuZeladoria"] div[data-page]:hover:not(.active),
      body.light-mode nav[id="sideMenuEsic"] div[data-page]:hover:not(.active) {
        background: rgba(0,0,0,0.05);
      }
      
      /* Estilo para bot√£o E-SIC */
      #btnSectionEsic {
        background: transparent;
        color: var(--text-primary);
        border: 1px solid transparent;
      }
      
      #btnSectionEsic:hover {
        background: rgba(34,211,238,0.15);
        color: #22d3ee;
        border-color: rgba(34,211,238,0.3);
      }
      
      body.light-mode #btnSectionEsic:hover {
        background: rgba(34,211,238,0.2);
        color: #0891b2;
      }
      
      .section-selector {
        background: transparent;
        color: #94a3b8;
        border: none;
      }
      
      body.light-mode .section-selector {
        color: #64748b;
      }
      
      .section-selector.active {
        background: linear-gradient(90deg, rgba(34,211,238,0.15) 0%, rgba(34,211,238,0.05) 100%);
        color: #22d3ee;
        font-weight: 600;
      }
      
      body.light-mode .section-selector.active {
        background: linear-gradient(90deg, rgba(34,211,238,0.25) 0%, rgba(34,211,238,0.15) 100%);
        color: #0e7490 !important;
        font-weight: 600;
      }
      
      .section-selector:hover:not(.active) {
        background: rgba(255,255,255,0.05);
        color: #cbd5e1;
      }
      
      body.light-mode .section-selector:hover:not(.active) {
        background: rgba(0,0,0,0.05);
        color: #475569;
      }
      
      :where(.overflow-y-auto, .overflow-auto, .overflow-y-scroll)::-webkit-scrollbar {
        width: 12px;
        height: 12px;
      }
      :where(.overflow-y-auto, .overflow-auto, .overflow-y-scroll)::-webkit-scrollbar-track {
        background: transparent;
      }
      :where(.overflow-y-auto, .overflow-auto, .overflow-y-scroll)::-webkit-scrollbar-thumb {
        background: linear-gradient(180deg, #0a0a0a, #1a1a1a);
        border-radius: 10px;
        border: 2px solid transparent;
        background-clip: padding-box;
      }
      :where(.overflow-y-auto, .overflow-auto, .overflow-y-scroll)::-webkit-scrollbar-thumb:hover {
        background: linear-gradient(180deg, #111, #222);
      }
      /* Estilos para marcadores do mapa Leaflet */
      .custom-marker {
        background: transparent !important;
        border: none !important;
      }
      .marker-pin {
        width: 30px !important;
        height: 30px !important;
        border-radius: 50% 50% 50% 0 !important;
        border: 3px solid !important;
        transform: rotate(-45deg) !important;
        position: relative !important;
        box-shadow: 0 2px 8px rgba(0,0,0,0.6) !important;
        z-index: 1000 !important;
      }
      .marker-pin-inner {
        width: 16px !important;
        height: 16px !important;
        background: white !important;
        border-radius: 50% !important;
        position: absolute !important;
        top: 50% !important;
        left: 50% !important;
        transform: translate(-50%, -50%) rotate(45deg) !important;
      }
      .marker-cluster {
        background: transparent !important;
        border: none !important;
      }
      .cluster-marker {
        width: 40px !important;
        height: 40px !important;
        border-radius: 50% !important;
        background: linear-gradient(135deg, #22d3ee, #a78bfa) !important;
        color: white !important;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
        font-weight: 700 !important;
        font-size: 14px !important;
        box-shadow: 0 3px 10px rgba(0,0,0,0.5) !important;
        border: 3px solid white !important;
      }
      .cluster-marker.cluster-medium {
        width: 50px !important;
        height: 50px !important;
        font-size: 16px !important;
      }
      .cluster-marker.cluster-large {
        width: 60px !important;
        height: 60px !important;
        font-size: 18px !important;
      }
      .custom-popup .leaflet-popup-content-wrapper {
        background: #0f172a !important;
        color: #e2e8f0 !important;
        border-radius: 8px !important;
        box-shadow: 0 4px 20px rgba(0,0,0,0.5) !important;
      }
      .custom-popup .leaflet-popup-tip {
        background: #0f172a !important;
      }
      .custom-popup .leaflet-popup-close-button {
        color: #94a3b8 !important;
        font-size: 20px !important;
        padding: 4px 8px !important;
      }
      .custom-popup .leaflet-popup-close-button:hover {
        color: #22d3ee !important;
      }
      /* Garantir que os marcadores apare√ßam acima do mapa */
      .leaflet-marker-icon {
        z-index: 1000 !important;
      }
      .leaflet-marker-pane {
        z-index: 600 !important;
      }
      
      body.light-mode :where(.overflow-y-auto, .overflow-auto, .overflow-y-scroll)::-webkit-scrollbar-thumb {
        background: linear-gradient(180deg, #cbd5e1, #94a3b8);
      }
      body.light-mode :where(.overflow-y-auto, .overflow-auto, .overflow-y-scroll)::-webkit-scrollbar-thumb:hover {
        background: linear-gradient(180deg, #94a3b8, #64748b);
      }
      
      /* Ajustes de texto para modo claro */
      body.light-mode .text-slate-100 { color: #0f172a !important; }
      body.light-mode .text-slate-200 { color: #0f172a !important; }
      body.light-mode .text-slate-300 { color: #1e293b !important; }
      body.light-mode .text-slate-400 { color: #334155 !important; }
      body.light-mode .text-slate-500,
      body.light-mode .text-slate-600 { color: #475569 !important; }
      body.light-mode [class~="text-white"],
      body.light-mode [class*="text-white/"] { color: #0f172a !important; }
      body.light-mode .text-gray-200,
      body.light-mode .text-gray-300,
      body.light-mode .text-gray-400 { color: #1e293b !important; }
      body.light-mode .text-gray-500,
      body.light-mode .text-gray-600 { color: #334155 !important; }
      body.light-mode .bg-slate-800\/30 { background-color: rgba(30,41,59,0.15) !important; }
      body.light-mode .bg-slate-800\/50 { background-color: rgba(30,41,59,0.2) !important; }
      body.light-mode .bg-slate-900\/30 { background-color: rgba(15,23,42,0.12) !important; }
      body.light-mode .bg-slate-900\/50 { background-color: rgba(15,23,42,0.18) !important; }
      body.light-mode .bg-white\/5 { background-color: rgba(0,0,0,0.05) !important; }
      
      /* Ajustes de hover para modo claro */
      body.light-mode .hover\:bg-white\/5:hover { background-color: rgba(0,0,0,0.05) !important; }
      
      /* Ajustes de bordas para modo claro */
      body.light-mode .border-white\/10 { border-color: rgba(0,0,0,0.1) !important; }
      body.light-mode .border-white\/5 { border-color: rgba(0,0,0,0.05) !important; }
      
      /* Ajustes de cores de texto espec√≠ficas para modo claro */
      body.light-mode .text-violet-300 { color: #7c3aed !important; }
      body.light-mode .text-cyan-300 { color: #0891b2 !important; }
      body.light-mode .text-emerald-300 { color: #059669 !important; }
      body.light-mode .text-amber-300 { color: #d97706 !important; }
      body.light-mode .text-blue-300 { color: #2563eb !important; }
      body.light-mode .text-rose-300 { color: #e11d48 !important; }
      body.light-mode .text-emerald-400 { color: #10b981 !important; }
      
      /* Ajustes de backgrounds com opacidade para modo claro */
      body.light-mode .bg-cyan-500\/20 { background-color: rgba(6,182,212,0.15) !important; }
      body.light-mode .bg-violet-500\/20 { background-color: rgba(139,92,246,0.15) !important; }
      body.light-mode .bg-blue-500\/20 { background-color: rgba(59,130,246,0.15) !important; }
      body.light-mode .bg-amber-500\/20 { background-color: rgba(245,158,11,0.15) !important; }
      body.light-mode .bg-emerald-500\/20 { background-color: rgba(16,185,129,0.15) !important; }
      body.light-mode .bg-emerald-600\/20 { background-color: rgba(5,150,105,0.15) !important; }
      body.light-mode .bg-rose-500\/20 { background-color: rgba(244,63,94,0.15) !important; }
      
      /* Ajustes de barras de progresso */
      body.light-mode .bg-slate-800 { background-color: rgba(30,41,59,0.3) !important; }
      
      /* Ajustes de distritos e itens interativos */
      body.light-mode .hover\:border-cyan-400\/50:hover { border-color: rgba(6,182,212,0.4) !important; }
      
      /* Ajustes de chat */
      body.light-mode .bg-slate-800\/60 { background-color: rgba(30,41,59,0.25) !important; }
      
      /* Garantir que todos os textos sejam leg√≠veis */
      body.light-mode .text-slate-200 { color: #1e293b !important; }
      body.light-mode .text-slate-300 { color: #334155 !important; }
      body.light-mode .text-slate-400 { color: #475569 !important; }
      
      /* Ajustes adicionais para elementos espec√≠ficos */
      body.light-mode .border-emerald-500\/20 { border-color: rgba(16,185,129,0.2) !important; }
      
      /* Ajustes para bot√µes de marcar/desmarcar todos */
      body.light-mode .btn-marcar-todos {
        background-color: rgba(6,182,212,0.15) !important;
        color: #0891b2 !important;
      }
      body.light-mode .btn-marcar-todos:hover {
        background-color: rgba(6,182,212,0.25) !important;
        color: #0e7490 !important;
      }
      body.light-mode .btn-desmarcar-todos {
        background-color: rgba(30,41,59,0.2) !important;
        color: #475569 !important;
      }
      body.light-mode .btn-desmarcar-todos:hover {
        background-color: rgba(30,41,59,0.3) !important;
        color: #334155 !important;
      }
      
      /* Ajustes para controles de legenda */
      body.light-mode .legend-controls {
        border-top-color: rgba(0,0,0,0.1) !important;
      }
      
      /* Ajustes para itens de legenda */
      body.light-mode .legend-item {
        border-color: rgba(0,0,0,0.1) !important;
      }
      body.light-mode .legend-item:hover {
        background-color: rgba(0,0,0,0.05) !important;
      }
      body.light-mode .legend-item.border-white\/20 {
        border-color: rgba(0,0,0,0.2) !important;
      }
      
      /* For√ßar cores escuras em todos os textos no modo claro */
      body.light-mode * {
        color: inherit;
      }
      
      body.light-mode h1,
      body.light-mode h2,
      body.light-mode h3,
      body.light-mode h4,
      body.light-mode h5,
      body.light-mode h6 {
        color: #0f172a !important;
      }
      
      body.light-mode p,
      body.light-mode span,
      body.light-mode div:not(.glass) {
        color: inherit;
      }
    </style>
    <script>
      // Sistema de altern√¢ncia de tema (modo claro/escuro)
      (function() {
        const THEME_KEY = 'dashboard-theme';
        const LIGHT_MODE = 'light';
        const DARK_MODE = 'dark';
        
        // Carregar tema salvo ou usar padr√£o (escuro)
        function loadTheme() {
          const savedTheme = localStorage.getItem(THEME_KEY) || DARK_MODE;
          applyTheme(savedTheme);
        }
        
        // Aplicar tema
        function applyTheme(theme) {
          const body = document.body;
          if (theme === LIGHT_MODE) {
            body.classList.remove('dark-mode');
            body.classList.add('light-mode');
          } else {
            body.classList.remove('light-mode');
            body.classList.add('dark-mode');
          }
          localStorage.setItem(THEME_KEY, theme);
          
          // Atualizar gr√°ficos se Chart.js estiver dispon√≠vel
          if (window.Chart) {
            const textColor = theme === LIGHT_MODE ? '#1e293b' : '#94a3b8';
            const gridColor = theme === LIGHT_MODE ? 'rgba(0,0,0,0.1)' : 'rgba(255,255,255,0.05)';
            const tooltipBg = theme === LIGHT_MODE ? 'rgba(255, 255, 255, 0.98)' : 'rgba(15, 23, 42, 0.95)';
            const tooltipTitleColor = theme === LIGHT_MODE ? '#0f172a' : '#e2e8f0';
            const tooltipBodyColor = theme === LIGHT_MODE ? '#1e293b' : '#cbd5e1';
            const tooltipBorderColor = theme === LIGHT_MODE ? 'rgba(15,23,42,0.2)' : 'rgba(34, 211, 238, 0.3)';
            
            // Atualizar todos os gr√°ficos Chart.js
            Chart.helpers.each(Chart.instances, function(chart) {
              if (chart.options && chart.options.scales) {
                Object.keys(chart.options.scales).forEach(scaleKey => {
                  const scale = chart.options.scales[scaleKey];
                  if (scale.ticks) {
                    scale.ticks.color = textColor;
                    scale.ticks.font = scale.ticks.font || {};
                    scale.ticks.font.weight = '500';
                  }
                  if (scale.grid) {
                    scale.grid.color = gridColor;
                    scale.grid.lineWidth = theme === LIGHT_MODE ? 1 : 1;
                  }
                });
              }
              
              if (chart.options && chart.options.plugins) {
                if (chart.options.plugins.tooltip) {
                  const tooltip = chart.options.plugins.tooltip;
                  if (tooltip.backgroundColor !== undefined) tooltip.backgroundColor = tooltipBg;
                  if (tooltip.titleColor !== undefined) tooltip.titleColor = tooltipTitleColor;
                  if (tooltip.bodyColor !== undefined) tooltip.bodyColor = tooltipBodyColor;
                  if (tooltip.borderColor !== undefined) tooltip.borderColor = tooltipBorderColor;
                }
                
                // Atualizar legendas se existirem
                if (chart.options.plugins.legend) {
                  chart.options.plugins.legend.labels = chart.options.plugins.legend.labels || {};
                  chart.options.plugins.legend.labels.color = textColor;
                }
              }
              
              chart.update('none');
            });
          }
        }
        
        // Alternar tema
        function toggleTheme() {
          const currentTheme = localStorage.getItem(THEME_KEY) || DARK_MODE;
          const newTheme = currentTheme === LIGHT_MODE ? DARK_MODE : LIGHT_MODE;
          applyTheme(newTheme);
        }
        
        // Inicializar quando DOM estiver pronto
        if (document.readyState === 'loading') {
          document.addEventListener('DOMContentLoaded', loadTheme);
        } else {
          loadTheme();
        }
        
        // Adicionar event listener ao bot√£o quando dispon√≠vel
        function initThemeToggle() {
          const toggleBtn = document.getElementById('themeToggle');
          if (toggleBtn) {
            toggleBtn.addEventListener('click', toggleTheme);
          } else {
            // Tentar novamente ap√≥s um pequeno delay
            setTimeout(initThemeToggle, 100);
          }
        }
        
        initThemeToggle();
        
        // Exportar para uso global se necess√°rio
        window.themeManager = {
          toggle: toggleTheme,
          set: applyTheme,
          get: () => localStorage.getItem(THEME_KEY) || DARK_MODE
        };
      })();
      
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
          navigator.serviceWorker.register('/sw.js')
            .then(reg => {
              if (window.Logger) {
                window.Logger.success('Service Worker registrado:', reg.scope);
              } else {
                console.log('‚úÖ Service Worker registrado:', reg.scope);
              }
            })
            .catch(err => {
              if (window.Logger) {
                window.Logger.warn('Service Worker n√£o registrado:', err);
              }
            });
        });
      }
    </script>
  </head>
  <body class="text-slate-100">
    <!-- Bot√µes fixos no topo direito (tema + informa√ß√µes de secretarias) -->
    <div class="theme-toggle-container flex items-center gap-2">
      <button id="secretariasInfoButton" class="theme-toggle relative w-8 h-8 flex items-center justify-center rounded-full border border-cyan-400/60 bg-slate-900/70 hover:bg-slate-800/90 transition-colors shadow-lg"
              title="Informa√ß√µes de Secretarias (dados e emails)" aria-label="Informa√ß√µes de Secretarias">
        <span class="sr-only">Informa√ß√µes de Secretarias</span>
        <span class="text-xs text-cyan-300 font-semibold">i</span>
      </button>
      <button id="themeToggle" class="theme-toggle" title="Alternar entre modo claro e escuro" aria-label="Alternar tema">
        <span class="sr-only">Alternar tema</span>
      </button>
    </div>
    
    <div class="min-h-screen grid grid-cols-12 gap-6 p-6">
      <aside class="col-span-12 lg:col-span-3 xl:col-span-2 glass rounded-2xl p-5">
        <div class="mb-6">
          <div class="flex items-center mb-4">
            <div class="flex items-center gap-3">
              <img src="/dc-logo.png" alt="Duque de Caxias" class="h-12 w-auto object-contain" />
              <div>
                <div id="sectionTitle" class="text-lg font-semibold">Ouvidoria</div>
                <div class="text-xs text-slate-400">Dashboard Inteligente</div>
              </div>
            </div>
          </div>
          <div class="flex flex-wrap gap-2 bg-slate-800/50 rounded-lg p-1">
            <button id="btnSectionCentral" data-section="central" class="flex-1 min-w-[100px] px-2 py-2 rounded-md text-xs font-medium transition-all section-selector" title="Painel Central - Gest√£o Integrada">
              üèôÔ∏è Central
            </button>
            <button id="btnSectionOuvidoria" data-section="ouvidoria" class="flex-1 min-w-[100px] px-2 py-2 rounded-md text-xs font-medium transition-all section-selector active">
              üìã Ouvidoria
            </button>
            <button id="btnSectionZeladoria" data-section="zeladoria" class="flex-1 min-w-[100px] px-2 py-2 rounded-md text-xs font-medium transition-all section-selector">
              üèóÔ∏è Zeladoria
            </button>
            <button id="btnSectionEsic" data-section="esic" class="flex-1 min-w-[100px] px-2 py-2 rounded-md text-xs font-medium transition-all section-selector" onclick="if(typeof window.switchSection === 'function'){window.switchSection('esic');}else{console.error('switchSection n√£o dispon√≠vel');}">
              üìã E-SIC
            </button>
          </div>
        </div>
        
        <nav id="sideMenuCentral" class="space-y-3 text-sm" style="display: none;">
          <div class="space-y-1">
            <div data-page="central-dashboard" class="active px-3 py-2 rounded-lg hover:bg-white/5 cursor-pointer transition-colors">üè† Home</div>
            <div data-page="central-dashboard" class="px-3 py-2 rounded-lg hover:bg-white/5 cursor-pointer transition-colors">üìä Vis√£o Geral</div>
            <div data-page="cora-chat" class="px-3 py-2 rounded-lg hover:bg-white/5 cursor-pointer transition-colors">üí¨ Cora - Chat</div>
          </div>
          
          <div class="space-y-1 pt-2 border-t border-white/10">
            <div class="text-xs font-semibold text-slate-400 uppercase tracking-wider px-3 mb-2">üìä M√≥dulos</div>
            <div data-page="central-zeladoria" class="px-3 py-2 rounded-lg hover:bg-white/5 cursor-pointer transition-colors">üßπ Zeladoria</div>
            <div data-page="central-ouvidoria" class="px-3 py-2 rounded-lg hover:bg-white/5 cursor-pointer transition-colors">üì£ Ouvidoria</div>
            <div data-page="central-esic" class="px-3 py-2 rounded-lg hover:bg-white/5 cursor-pointer transition-colors">üìã E-SIC</div>
            <div data-page="central-cora" class="px-3 py-2 rounded-lg hover:bg-white/5 cursor-pointer transition-colors">üõ∞Ô∏è CORA</div>
          </div>
        </nav>
        
        <nav id="sideMenuOuvidoria" class="space-y-3 text-sm">
          <div class="space-y-1">
            <div data-page="home" class="active px-3 py-2 rounded-lg hover:bg-white/5 cursor-pointer transition-colors">üè† Home</div>
            <div data-page="main" class="px-3 py-2 rounded-lg hover:bg-white/5 cursor-pointer transition-colors">üìä Vis√£o Geral</div>
            <div data-page="cora-chat" class="px-3 py-2 rounded-lg hover:bg-white/5 cursor-pointer transition-colors">üí¨ Cora - Chat</div>
          </div>
          
          <div class="space-y-1 pt-2 border-t border-white/10">
            <div class="text-xs font-semibold text-slate-400 uppercase tracking-wider px-3 mb-2">üîç FILTROS</div>
            <div data-page="filtros-avancados" class="px-3 py-2 rounded-lg hover:bg-white/5 cursor-pointer transition-colors">üîç Filtros Avan√ßados</div>
          </div>
          
          <div class="space-y-1 pt-2 border-t border-white/10">
            <div class="text-xs font-semibold text-slate-400 uppercase tracking-wider px-3 mb-2">üìä An√°lises Principais</div>
            <div data-page="orgao-mes" class="px-3 py-2 rounded-lg hover:bg-white/5 cursor-pointer transition-colors">üè¢ Por √ìrg√£o e M√™s</div>
            <div data-page="tempo-medio" class="px-3 py-2 rounded-lg hover:bg-white/5 cursor-pointer transition-colors">‚è±Ô∏è Tempo M√©dio</div>
            <div data-page="vencimento" class="px-3 py-2 rounded-lg hover:bg-white/5 cursor-pointer transition-colors">‚è∞ Vencimento</div>
            <div data-page="protocolos-demora" class="px-3 py-2 rounded-lg hover:bg-white/5 cursor-pointer transition-colors">‚è≥ Protocolos com Maior Demora</div>
            <div data-page="notificacoes" class="px-3 py-2 rounded-lg hover:bg-white/5 cursor-pointer transition-colors">üìß Notifica√ß√µes de Email</div>
            <div data-page="tema" class="px-3 py-2 rounded-lg hover:bg-white/5 cursor-pointer transition-colors">üìë Por Tema</div>
            <div data-page="assunto" class="px-3 py-2 rounded-lg hover:bg-white/5 cursor-pointer transition-colors">üìù Por Assunto</div>
            <div data-page="cadastrante" class="px-3 py-2 rounded-lg hover:bg-white/5 cursor-pointer transition-colors">üë§ Por Cadastrante</div>
            <div data-page="reclamacoes" class="px-3 py-2 rounded-lg hover:bg-white/5 cursor-pointer transition-colors">üö® Reclama√ß√µes e Den√∫ncias</div>
            <div data-page="projecao-2026" class="px-3 py-2 rounded-lg hover:bg-white/5 cursor-pointer transition-colors">üìà Proje√ß√£o 2026</div>
          </div>
          
          <div class="space-y-1 pt-2 border-t border-white/10">
            <div class="text-xs font-semibold text-slate-400 uppercase tracking-wider px-3 mb-2">üìà Relat√≥rios por Dimens√£o</div>
            <div data-page="tipo" class="px-3 py-2 rounded-lg hover:bg-white/5 cursor-pointer transition-colors">üìã Tipos</div>
            <div data-page="status" class="px-3 py-2 rounded-lg hover:bg-white/5 cursor-pointer transition-colors">üìä Status</div>
            <div data-page="responsavel" class="px-3 py-2 rounded-lg hover:bg-white/5 cursor-pointer transition-colors">üë• Respons√°veis</div>
            <div data-page="canal" class="px-3 py-2 rounded-lg hover:bg-white/5 cursor-pointer transition-colors">üì° Canais</div>
            <div data-page="prioridade" class="px-3 py-2 rounded-lg hover:bg-white/5 cursor-pointer transition-colors">‚ö° Prioridades</div>
            <div data-page="bairro" class="px-3 py-2 rounded-lg hover:bg-white/5 cursor-pointer transition-colors">üìç Bairro</div>
          </div>
          
          <div class="space-y-1 pt-2 border-t border-white/10">
            <div class="text-xs font-semibold text-slate-400 uppercase tracking-wider px-3 mb-2">üè• Unidades de Sa√∫de</div>
            <div data-page="unidades-saude" class="px-3 py-2 rounded-lg hover:bg-white/5 cursor-pointer transition-colors">üè• Unidades de Sa√∫de</div>
          </div>
        </nav>
        
        <nav id="sideMenuZeladoria" class="space-y-3 text-sm" style="display: none;">
          <div class="space-y-1">
            <div data-page="zeladoria-home" class="active px-3 py-2 rounded-lg hover:bg-white/5 cursor-pointer transition-colors">üè† Home</div>
            <div data-page="zeladoria-overview" class="px-3 py-2 rounded-lg hover:bg-white/5 cursor-pointer transition-colors">üìä Vis√£o Geral</div>
            <div data-page="zeladoria-cora-chat" class="px-3 py-2 rounded-lg hover:bg-white/5 cursor-pointer transition-colors">üí¨ Cora - Chat</div>
          </div>
          
          <div class="space-y-1 pt-2 border-t border-white/10">
            <div class="text-xs font-semibold text-slate-400 uppercase tracking-wider px-3 mb-2">üèóÔ∏è Colab</div>
            <div data-page="zeladoria-colab-demandas" class="px-3 py-2 rounded-lg hover:bg-white/5 cursor-pointer transition-colors">üìã Demandas</div>
            <div data-page="zeladoria-colab-criar" class="px-3 py-2 rounded-lg hover:bg-white/5 cursor-pointer transition-colors">‚ûï Criar Demanda</div>
            <div data-page="zeladoria-colab-categorias" class="px-3 py-2 rounded-lg hover:bg-white/5 cursor-pointer transition-colors">üè∑Ô∏è Categorias</div>
          </div>
          
          <div class="space-y-1 pt-2 border-t border-white/10">
            <div class="text-xs font-semibold text-slate-400 uppercase tracking-wider px-3 mb-2">üìä An√°lises Principais</div>
            <div data-page="zeladoria-status" class="px-3 py-2 rounded-lg hover:bg-white/5 cursor-pointer transition-colors">üìä Por Status</div>
            <div data-page="zeladoria-categoria" class="px-3 py-2 rounded-lg hover:bg-white/5 cursor-pointer transition-colors">üìÇ Por Categoria</div>
            <div data-page="zeladoria-departamento" class="px-3 py-2 rounded-lg hover:bg-white/5 cursor-pointer transition-colors">üè¢ Por Departamento</div>
            <div data-page="zeladoria-bairro" class="px-3 py-2 rounded-lg hover:bg-white/5 cursor-pointer transition-colors">üìç Por Bairro</div>
            <div data-page="zeladoria-responsavel" class="px-3 py-2 rounded-lg hover:bg-white/5 cursor-pointer transition-colors">üë• Por Respons√°vel</div>
            <div data-page="zeladoria-canal" class="px-3 py-2 rounded-lg hover:bg-white/5 cursor-pointer transition-colors">üì° Por Canal</div>
            <div data-page="zeladoria-tempo" class="px-3 py-2 rounded-lg hover:bg-white/5 cursor-pointer transition-colors">‚è±Ô∏è Tempo de Resolu√ß√£o</div>
          </div>
          
          <div class="space-y-1 pt-2 border-t border-white/10">
            <div class="text-xs font-semibold text-slate-400 uppercase tracking-wider px-3 mb-2">üìà Relat√≥rios</div>
            <div data-page="zeladoria-mensal" class="px-3 py-2 rounded-lg hover:bg-white/5 cursor-pointer transition-colors">üìÖ An√°lise Mensal</div>
            <div data-page="zeladoria-geografica" class="px-3 py-2 rounded-lg hover:bg-white/5 cursor-pointer transition-colors">üó∫Ô∏è An√°lise Geogr√°fica</div>
            <div data-page="zeladoria-mapa" class="px-3 py-2 rounded-lg hover:bg-white/5 cursor-pointer transition-colors">üó∫Ô∏è Mapa Interativo</div>
            <div data-page="zeladoria-colab-mapa" class="px-3 py-2 rounded-lg hover:bg-white/5 cursor-pointer transition-colors">üó∫Ô∏è Mapa Colab</div>
          </div>
          
        </nav>
        
        <nav id="sideMenuEsic" class="space-y-3 text-sm" style="display: none;">
          <div class="space-y-1">
            <div data-page="esic-home" class="active px-3 py-2 rounded-lg hover:bg-white/5 cursor-pointer transition-colors">üè† Home</div>
            <div data-page="esic-overview" class="px-3 py-2 rounded-lg hover:bg-white/5 cursor-pointer transition-colors">üìä Vis√£o Geral</div>
            <div data-page="cora-chat" class="px-3 py-2 rounded-lg hover:bg-white/5 cursor-pointer transition-colors">üí¨ Cora - Chat</div>
          </div>
          
          <div class="space-y-1 pt-2 border-t border-white/10">
            <div class="text-xs font-semibold text-slate-400 uppercase tracking-wider px-3 mb-2">üìä An√°lises Principais</div>
            <div data-page="esic-status" class="px-3 py-2 rounded-lg hover:bg-white/5 cursor-pointer transition-colors">üìà Por Status</div>
            <div data-page="esic-tipo-informacao" class="px-3 py-2 rounded-lg hover:bg-white/5 cursor-pointer transition-colors">üìë Tipo de Informa√ß√£o</div>
            <div data-page="esic-responsavel" class="px-3 py-2 rounded-lg hover:bg-white/5 cursor-pointer transition-colors">üë§ Por Respons√°vel</div>
            <div data-page="esic-unidade" class="px-3 py-2 rounded-lg hover:bg-white/5 cursor-pointer transition-colors">üè¢ Por Unidade</div>
            <div data-page="esic-canal" class="px-3 py-2 rounded-lg hover:bg-white/5 cursor-pointer transition-colors">üìû Por Canal</div>
          </div>
          
          <div class="space-y-1 pt-2 border-t border-white/10">
            <div class="text-xs font-semibold text-slate-400 uppercase tracking-wider px-3 mb-2">üìà Relat√≥rios</div>
            <div data-page="esic-mensal" class="px-3 py-2 rounded-lg hover:bg-white/5 cursor-pointer transition-colors">üìÖ An√°lise Mensal</div>
          </div>
        </nav>
        
        <div class="mt-8 pt-6 border-t border-white/10">
          <div class="text-xs font-semibold text-slate-300 mb-4 uppercase tracking-wider">Equipe Respons√°vel</div>
          <div class="space-y-3 text-xs">
            <div class="pb-2 border-b border-white/5">
              <div class="text-slate-400 mb-1">Ouvidoria Geral</div>
              <div class="text-slate-200 font-medium">Edrisio Avelino</div>
              <div class="text-slate-500 text-[10px] mt-0.5">Ouvidor Geral</div>
            </div>
            <div class="space-y-2">
              <div>
                <div class="text-slate-200 font-medium">Nilton Quaresma</div>
                <div class="text-slate-500 text-[10px]">Diretor de Ouvidoria</div>
              </div>
              <div>
                <div class="text-slate-200 font-medium">David Freitas</div>
                <div class="text-slate-500 text-[10px]">Diretor de An√°lise de Dados</div>
              </div>
              <div>
                <div class="text-slate-200 font-medium">Wellington Ribeiro</div>
                <div class="text-slate-500 text-[10px]">Desenvolvedor Full Stack da Ouvidoria</div>
              </div>
            </div>
            <div class="pt-2 mt-2 border-t border-white/5">
              <div class="text-slate-400 mb-2 text-[10px] uppercase tracking-wide">Analistas Estrat√©gicos da Ouvidoria</div>
              <div class="space-y-1 text-slate-300">
                <div class="text-[11px]">‚Ä¢ Nikolas Brian</div>
                <div class="text-[11px]">‚Ä¢ Rildo Luiz</div>
              </div>
            </div>
          </div>
        </div>
      </aside>

      <main id="pages" class="col-span-12 lg:col-span-9 xl:col-span-10 space-y-6">
        <div id="filterIndicator" class="hidden fixed top-4 left-1/2 transform -translate-x-1/2 z-50"></div>
        <div id="pageTitle" class="mb-4"></div>
        
        <!-- PAINEL CENTRAL - GEST√ÉO INTEGRADA MUNICIPAL -->
        <section id="page-central-dashboard" style="display: none;">
          <header class="glass rounded-2xl p-6 mb-6">
            <div class="flex items-center justify-between mb-4">
              <div>
                <h1 class="neon text-3xl font-bold mb-2">üèôÔ∏è Painel Central</h1>
                <p class="text-slate-400">Gest√£o Integrada Municipal - Vis√£o Unificada</p>
              </div>
              <div class="text-xs text-slate-500">
                √öltima atualiza√ß√£o: <span id="centralLastUpdate">‚Äî</span>
              </div>
            </div>
          </header>
          
          <!-- KPIs Consolidados -->
          <section class="mb-6">
            <h2 class="text-xl font-semibold text-cyan-300 mb-4">üìä KPIs Consolidados</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
              <div class="glass rounded-xl p-5 border border-cyan-500/20">
                <div class="text-xs text-slate-400 mb-1">üßπ Zeladoria</div>
                <div id="kpiZeladoria" class="text-2xl font-bold text-cyan-300">‚Äî</div>
                <div class="text-xs text-slate-500 mt-1">Total de Demandas</div>
              </div>
              <div class="glass rounded-xl p-5 border border-violet-500/20">
                <div class="text-xs text-slate-400 mb-1">üì£ Ouvidoria</div>
                <div id="kpiOuvidoria" class="text-2xl font-bold text-violet-300">‚Äî</div>
                <div class="text-xs text-slate-500 mt-1">Total de Manifesta√ß√µes</div>
              </div>
              <div class="glass rounded-xl p-5 border border-emerald-500/20">
                <div class="text-xs text-slate-400 mb-1">üìã E-SIC</div>
                <div id="kpiEsic" class="text-2xl font-bold text-emerald-300">‚Äî</div>
                <div class="text-xs text-slate-500 mt-1">Total de Solicita√ß√µes</div>
              </div>
              <div class="glass rounded-xl p-5 border border-amber-500/20">
                <div class="text-xs text-slate-400 mb-1">üõ∞Ô∏è CORA</div>
                <div id="kpiCora" class="text-2xl font-bold text-amber-300">‚Äî</div>
                <div class="text-xs text-slate-500 mt-1">Ocorr√™ncias Ativas</div>
              </div>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-4">
              <div class="glass rounded-xl p-5 border border-rose-500/20">
                <div class="text-xs text-slate-400 mb-1">Total Geral</div>
                <div id="kpiTotalGeral" class="text-3xl font-bold text-rose-300">‚Äî</div>
                <div class="text-xs text-slate-500 mt-1">Todas as Demandas</div>
              </div>
              <div class="glass rounded-xl p-5 border border-indigo-500/20">
                <div class="text-xs text-slate-400 mb-1">Em Atendimento</div>
                <div id="kpiEmAtendimento" class="text-3xl font-bold text-indigo-300">‚Äî</div>
                <div class="text-xs text-slate-500 mt-1">Todas as Demandas</div>
              </div>
              <div class="glass rounded-xl p-5 border border-teal-500/20">
                <div class="text-xs text-slate-400 mb-1">Tempo M√©dio</div>
                <div id="kpiTempoMedio" class="text-3xl font-bold text-teal-300">‚Äî</div>
                <div class="text-xs text-slate-500 mt-1">Dias (consolidado)</div>
              </div>
            </div>
          </section>
          
          <!-- Gr√°ficos Comparativos -->
          <section class="mb-6">
            <h2 class="text-xl font-semibold text-cyan-300 mb-4">üìà Gr√°ficos Comparativos</h2>
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
              <div class="glass rounded-2xl p-5">
                <h3 class="font-semibold text-cyan-300 mb-3">Volume por Sistema</h3>
                <div class="rounded-xl overflow-hidden bg-slate-900/30 p-3">
                  <canvas id="chartVolumeSistemas"></canvas>
                </div>
              </div>
              <div class="glass rounded-2xl p-5">
                <h3 class="font-semibold text-violet-300 mb-3">Evolu√ß√£o Temporal</h3>
                <div class="rounded-xl overflow-hidden bg-slate-900/30 p-3">
                  <canvas id="chartEvolucaoTemporal"></canvas>
                </div>
              </div>
            </div>
          </section>
          
          <!-- Alertas e Indicadores Cr√≠ticos -->
          <section class="mb-6">
            <h2 class="text-xl font-semibold text-rose-300 mb-4">üö® Alertas e Indicadores Cr√≠ticos</h2>
            <div id="centralAlerts" class="space-y-3">
              <div class="text-center text-slate-400 py-4">Carregando alertas...</div>
            </div>
          </section>
          
          <!-- Timeline de Eventos -->
          <section class="mb-6">
            <h2 class="text-xl font-semibold text-amber-300 mb-4">üìÖ Timeline de Eventos</h2>
            <div id="centralTimeline" class="space-y-3">
              <div class="text-center text-slate-400 py-4">Carregando timeline...</div>
            </div>
          </section>
        </section>
        
        <section id="page-home" class="">
          <div class="glass rounded-2xl p-8 md:p-12 text-center">
            <div class="mb-8">
              <div class="inline-block relative">
                <div class="w-32 h-32 md:w-40 md:h-40 mx-auto rounded-full bg-gradient-to-br from-cyan-400 via-purple-500 to-pink-500 flex items-center justify-center text-6xl md:text-7xl">
                  ü§ñ
                </div>
              </div>
            </div>
            
            <h1 class="text-4xl md:text-6xl font-extrabold mb-4 neon">
              Ol√°, Gestor Municipal! üëã
            </h1>
            <h2 class="text-2xl md:text-4xl font-bold text-cyan-300 mb-8">
              Eu sou a <span class="text-purple-400">Cora</span>
            </h2>
            
            <p class="text-lg md:text-xl text-slate-300 mb-12 max-w-3xl mx-auto">
              Sua assistente virtual inteligente especializada em an√°lises de ouvidoria
            </p>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-12">
              <div class="glass rounded-xl p-6 hover:scale-105 transition-transform duration-100">
                <div class="text-4xl mb-4">üí¨</div>
                <h3 class="text-xl font-bold text-cyan-300 mb-2">Chat Inteligente</h3>
                <p class="text-sm text-slate-400">
                  Fa√ßa perguntas em linguagem natural e receba respostas precisas baseadas em dados reais
                </p>
              </div>
              
              <div class="glass rounded-xl p-6 hover:scale-105 transition-transform duration-100">
                <div class="text-4xl mb-4">üìä</div>
                <h3 class="text-xl font-bold text-purple-300 mb-2">An√°lises em Tempo Real</h3>
                <p class="text-sm text-slate-400">
                  Acesso direto ao banco de dados para fornecer informa√ß√µes atualizadas e precisas
                </p>
              </div>
              
              <div class="glass rounded-xl p-6 hover:scale-105 transition-transform duration-100">
                <div class="text-4xl mb-4">üß†</div>
                <h3 class="text-xl font-bold text-pink-300 mb-2">Processamento Inteligente</h3>
                <p class="text-sm text-slate-400">
                  An√°lise avan√ßada de dados com capacidade de c√°lculos matem√°ticos e an√°lises estat√≠sticas
                </p>
              </div>
            </div>
            
            <div class="mt-8">
              <a href="/chat" class="inline-block px-8 py-4 bg-gradient-to-r from-cyan-500 to-purple-500 rounded-xl font-bold text-lg hover:scale-105 transition-transform duration-100 glow-ring">
                üöÄ Come√ßar a Conversar com a Cora
              </a>
            </div>
          </div>
        </section>
        
        <section id="page-main" style="display: none;">
          <header class="glass rounded-2xl p-6 mb-6">
            <div class="flex items-center gap-4">
              <img src="/dc-logo.png" alt="Duque de Caxias" class="h-14 w-auto object-contain" />
              <div>
                <h1 class="text-xl md:text-2xl font-bold neon">Vis√£o Geral ‚Ä¢ Intelig√™ncia Estrat√©gicas</h1>
                <div class="text-slate-400 text-xs">Dados interligados: clique para filtrar todo o painel</div>
              </div>
            </div>
          </header>

          <!-- ============================================ -->
          <!-- SE√á√ÉO 1: RESUMO EXECUTIVO - KPIs Principais -->
          <!-- ============================================ -->
          <section class="mb-6">
            <div class="flex items-center gap-2 mb-4">
              <div class="h-px flex-1 bg-gradient-to-r from-transparent via-cyan-500/50 to-transparent"></div>
              <h2 class="text-sm font-semibold text-cyan-400 uppercase tracking-wider px-3">üìä Resumo Executivo</h2>
              <div class="h-px flex-1 bg-gradient-to-r from-transparent via-cyan-500/50 to-transparent"></div>
            </div>
            <div class="grid grid-cols-12 gap-6">
              <div class="col-span-12 md:col-span-4 glass rounded-2xl p-5">
                <div class="flex items-center justify-between mb-2">
                  <div class="text-slate-400 text-sm font-medium">Total de Manifesta√ß√µes</div>
                  <div class="text-2xl">üìà</div>
                </div>
                <div class="flex items-end gap-3 mt-2">
                  <div id="kpiTotal" class="text-3xl font-extrabold text-cyan-300">‚Äî</div>
                  <div id="kpiTotalDelta" class="text-xs text-slate-400 mb-1">‚Äî</div>
                </div>
                <canvas id="sparkTotal" height="32" class="mt-3"></canvas>
              </div>
              <div class="col-span-12 md:col-span-4 glass rounded-2xl p-5">
                <div class="flex items-center justify-between mb-2">
                  <div class="text-slate-400 text-sm font-medium">√öltimos 7 dias</div>
                  <div class="text-2xl">üìÖ</div>
                </div>
                <div class="flex items-end gap-3 mt-2">
                  <div id="kpi7" class="text-3xl font-extrabold text-violet-300">‚Äî</div>
                  <div id="kpi7Delta" class="text-xs text-slate-400 mb-1">‚Äî</div>
                </div>
                <canvas id="spark7" height="32" class="mt-3"></canvas>
              </div>
              <div class="col-span-12 md:col-span-4 glass rounded-2xl p-5">
                <div class="flex items-center justify-between mb-2">
                  <div class="text-slate-400 text-sm font-medium">√öltimos 30 dias</div>
                  <div class="text-2xl">üìä</div>
                </div>
                <div class="flex items-end gap-3 mt-2">
                  <div id="kpi30" class="text-3xl font-extrabold text-emerald-300">‚Äî</div>
                  <div id="kpi30Delta" class="text-xs text-slate-400 mb-1">‚Äî</div>
                </div>
                <canvas id="spark30" height="32" class="mt-3"></canvas>
              </div>
            </div>
          </section>

          <!-- ============================================ -->
          <!-- SE√á√ÉO 2: DISTRIBUI√á√ïES E CATEGORIAS -->
          <!-- ============================================ -->
          <section class="mb-6">
            <div class="flex items-center gap-2 mb-4">
              <div class="h-px flex-1 bg-gradient-to-r from-transparent via-pink-500/50 to-transparent"></div>
              <h2 class="text-sm font-semibold text-pink-400 uppercase tracking-wider px-3">üìä Distribui√ß√µes e Categorias</h2>
              <div class="h-px flex-1 bg-gradient-to-r from-transparent via-pink-500/50 to-transparent"></div>
            </div>
            <div class="grid grid-cols-12 gap-6">
              <div class="col-span-12 lg:col-span-4 glass rounded-2xl p-5">
                <h3 class="font-semibold text-pink-300 mb-3">üìù Tipos de Manifesta√ß√£o</h3>
                <div class="text-xs text-slate-400 mb-3">Distribui√ß√£o por tipo</div>
                <div class="rounded-xl overflow-hidden bg-slate-900/30 p-3 mb-3">
                  <canvas id="chartTiposManifestacao"></canvas>
                </div>
                <div id="tiposInfo" class="mb-3 p-3 bg-slate-800/50 rounded-lg text-center text-sm"></div>
                <div id="legendTiposManifestacao" class="space-y-2 max-h-[200px] overflow-y-auto text-xs scrollbar-thin scrollbar-thumb-slate-600 scrollbar-track-slate-800"></div>
              </div>
              <div class="col-span-12 lg:col-span-4 glass rounded-2xl p-5">
                <h3 class="font-semibold text-amber-300 mb-3">üìû Canais de Atendimento</h3>
                <div class="text-xs text-slate-400 mb-3">Distribui√ß√£o por canal</div>
                <div class="rounded-xl overflow-hidden bg-slate-900/30 p-3 mb-3">
                  <canvas id="chartCanais"></canvas>
                </div>
                <div id="canaisInfo" class="mb-3 p-3 bg-slate-800/50 rounded-lg text-center text-sm"></div>
                <div id="legendCanais" class="space-y-2 max-h-[200px] overflow-y-auto text-xs scrollbar-thin scrollbar-thumb-slate-600 scrollbar-track-slate-800"></div>
              </div>
              <div class="col-span-12 lg:col-span-4 glass rounded-2xl p-5">
                <h3 class="font-semibold text-red-300 mb-3">‚ö° Prioridades</h3>
                <div class="text-xs text-slate-400 mb-3">Distribui√ß√£o por n√≠vel de prioridade</div>
                <div class="rounded-xl overflow-hidden bg-slate-900/30 p-3 mb-3">
                  <canvas id="chartPrioridades"></canvas>
                </div>
                <div id="prioridadesInfo" class="mb-3 p-3 bg-slate-800/50 rounded-lg text-center text-sm"></div>
                <div id="legendPrioridades" class="space-y-2 max-h-[200px] overflow-y-auto text-xs scrollbar-thin scrollbar-thumb-slate-600 scrollbar-track-slate-800"></div>
              </div>
            </div>
          </section>

          <!-- ============================================ -->
          <!-- SE√á√ÉO 3: RANKINGS E TOP PERFORMERS -->
          <!-- ============================================ -->
          <section class="mb-6">
            <div class="flex items-center gap-2 mb-4">
              <div class="h-px flex-1 bg-gradient-to-r from-transparent via-purple-500/50 to-transparent"></div>
              <h2 class="text-sm font-semibold text-purple-400 uppercase tracking-wider px-3">üèÜ Rankings e Top Performers</h2>
              <div class="h-px flex-1 bg-gradient-to-r from-transparent via-purple-500/50 to-transparent"></div>
            </div>
            <div class="grid grid-cols-12 gap-6">
              <div class="col-span-12 lg:col-span-4 glass rounded-2xl p-5">
                <h3 class="font-semibold text-cyan-300 mb-3">üèõÔ∏è Top √ìrg√£os</h3>
                <div class="text-xs text-slate-400 mb-3">Top 5 √≥rg√£os com mais manifesta√ß√µes</div>
                <div class="rounded-xl overflow-hidden bg-slate-900/30 p-3">
                  <canvas id="chartTopOrgaos"></canvas>
                </div>
              </div>
              <div class="col-span-12 lg:col-span-4 glass rounded-2xl p-5">
                <h3 class="font-semibold text-emerald-300 mb-3">üìë Top Temas</h3>
                <div class="text-xs text-slate-400 mb-3">Top 5 temas mais frequentes</div>
                <div class="rounded-xl overflow-hidden bg-slate-900/30 p-3">
                  <canvas id="chartTopTemas"></canvas>
                </div>
              </div>
              <div class="col-span-12 lg:col-span-4 glass rounded-2xl p-5">
                <h3 class="font-semibold text-indigo-300 mb-3">üìç Top Unidades de Cadastro</h3>
                <div class="text-xs text-slate-400 mb-3">Top 5 unidades com mais registros</div>
                <div class="rounded-xl overflow-hidden bg-slate-900/30 p-3">
                  <canvas id="chartUnidadesCadastro"></canvas>
                </div>
              </div>
            </div>
          </section>

          <!-- ============================================ -->
          <!-- SE√á√ÉO 4: STATUS E SLA -->
          <!-- ============================================ -->
          <section class="mb-6">
            <div class="flex items-center gap-2 mb-4">
              <div class="h-px flex-1 bg-gradient-to-r from-transparent via-violet-500/50 to-transparent"></div>
              <h2 class="text-sm font-semibold text-violet-400 uppercase tracking-wider px-3">üéØ Status e SLA</h2>
              <div class="h-px flex-1 bg-gradient-to-r from-transparent via-violet-500/50 to-transparent"></div>
            </div>
            <div class="grid grid-cols-12 gap-6">
              <div class="col-span-12 lg:col-span-6 glass rounded-2xl p-5">
                <h3 class="font-semibold text-violet-300 mb-3">üìä Funil por Status</h3>
                <div class="rounded-xl overflow-hidden bg-slate-900/30 p-3 mb-3">
                  <canvas id="chartFunnelStatus"></canvas>
                </div>
                <div id="statusInfo" class="mb-3 p-3 bg-slate-800/50 rounded-lg text-center text-sm"></div>
                <div id="legendFunnelStatus" class="space-y-2 max-h-[200px] overflow-y-auto text-xs scrollbar-thin scrollbar-thumb-slate-600 scrollbar-track-slate-800"></div>
              </div>
              <div class="col-span-12 lg:col-span-6 glass rounded-2xl p-5">
                <h3 class="font-semibold text-teal-300 mb-3">‚è±Ô∏è Status de SLA</h3>
                <div class="rounded-xl overflow-hidden bg-slate-900/30 p-3 mb-3">
                  <canvas id="chartSLA"></canvas>
                </div>
                <div id="slaInfo" class="mb-3 p-3 bg-slate-800/50 rounded-lg text-sm"></div>
                <div id="legendSLA" class="space-y-2 max-h-[200px] overflow-y-auto text-xs scrollbar-thin scrollbar-thumb-slate-600 scrollbar-track-slate-800"></div>
              </div>
            </div>
          </section>

          <!-- ============================================ -->
          <!-- SE√á√ÉO 5: AN√ÅLISE TEMPORAL -->
          <!-- ============================================ -->
          <section class="mb-6">
            <div class="flex items-center gap-2 mb-4">
              <div class="h-px flex-1 bg-gradient-to-r from-transparent via-blue-500/50 to-transparent"></div>
              <h2 class="text-sm font-semibold text-blue-400 uppercase tracking-wider px-3">üìà An√°lise Temporal</h2>
              <div class="h-px flex-1 bg-gradient-to-r from-transparent via-blue-500/50 to-transparent"></div>
            </div>
            <div class="grid grid-cols-12 gap-6">
              <div class="col-span-12 lg:col-span-8 glass rounded-2xl p-5">
                <h3 class="font-semibold text-cyan-300 mb-3">üìä Tend√™ncia Mensal (√öltimos 12 meses)</h3>
                <div class="rounded-xl overflow-visible bg-slate-900/30 p-3 mb-3">
                  <canvas id="chartTrend"></canvas>
                </div>
                <div id="chartTrendInfo" class="grid grid-cols-2 md:grid-cols-4 gap-3 text-sm">
                  <div class="text-center p-2 bg-slate-800/30 rounded-lg">
                    <div class="text-slate-400 text-xs mb-1">M√©dia</div>
                    <div id="trendMedia" class="text-cyan-300 font-bold">‚Äî</div>
                  </div>
                  <div class="text-center p-2 bg-slate-800/30 rounded-lg">
                    <div class="text-slate-400 text-xs mb-1">Total</div>
                    <div id="trendTotal" class="text-violet-300 font-bold">‚Äî</div>
                  </div>
                  <div class="text-center p-2 bg-slate-800/30 rounded-lg">
                    <div class="text-slate-400 text-xs mb-1">Maior</div>
                    <div id="trendMax" class="text-emerald-300 font-bold">‚Äî</div>
                  </div>
                  <div class="text-center p-2 bg-slate-800/30 rounded-lg">
                    <div class="text-slate-400 text-xs mb-1">Menor</div>
                    <div id="trendMin" class="text-rose-300 font-bold">‚Äî</div>
                  </div>
                </div>
              </div>
              <div class="col-span-12 lg:col-span-4 glass rounded-2xl p-5">
                <h3 class="font-semibold text-cyan-300 mb-3">üìÖ Distribui√ß√£o Di√°ria (√öltimos 30 dias)</h3>
                <div class="rounded-xl overflow-hidden bg-slate-900/30 p-3 mb-3">
                  <canvas id="chartDailyDistribution"></canvas>
                </div>
                <div id="dailyInfo" class="p-3 bg-slate-800/50 rounded-lg text-sm"></div>
              </div>
            </div>
          </section>

          <section class="mb-6">
            <div class="flex items-center gap-2 mb-4">
              <div class="h-px flex-1 bg-gradient-to-r from-transparent via-cyan-500/50 to-transparent"></div>
              <h2 class="text-sm font-semibold text-cyan-400 uppercase tracking-wider px-3">üìä Status Atual</h2>
              <div class="h-px flex-1 bg-gradient-to-r from-transparent via-cyan-500/50 to-transparent"></div>
            </div>
            <div class="grid grid-cols-12 gap-6">
              <div class="col-span-12 glass rounded-2xl p-5">
                <h3 class="font-semibold text-cyan-300 text-lg mb-4">üìä Status Atual</h3>
                <div id="statusOverviewCards" class="space-y-3">
                  <div class="text-center text-slate-400 py-4">Carregando...</div>
                </div>
              </div>
            </div>
          </section>
        </section>
        
        <!-- P√°gina: Por √ìrg√£o e M√™s -->
        <section id="page-orgao-mes" style="display: none;">
          <header class="glass rounded-2xl p-6 mb-6">
            <div class="flex items-center justify-between mb-4">
              <h2 class="neon text-xl font-bold">Por √ìrg√£o e M√™s</h2>
              <div class="text-xs text-slate-400">An√°lise detalhada de manifesta√ß√µes</div>
            </div>
            
            
            <!-- KPIs Principais -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mt-4">
              <div class="glass rounded-xl p-4 border border-cyan-500/20">
                <div class="text-xs text-slate-400 mb-1">Total de Manifesta√ß√µes</div>
                <div id="kpiTotalOrgaos" class="text-2xl font-bold text-cyan-300">‚Äî</div>
              </div>
              <div class="glass rounded-xl p-4 border border-violet-500/20">
                <div class="text-xs text-slate-400 mb-1">√ìrg√£os √önicos</div>
                <div id="kpiOrgaosUnicos" class="text-2xl font-bold text-violet-300">‚Äî</div>
              </div>
              <div class="glass rounded-xl p-4 border border-emerald-500/20">
                <div class="text-xs text-slate-400 mb-1">M√©dia por √ìrg√£o</div>
                <div id="kpiMediaOrgao" class="text-2xl font-bold text-emerald-300">‚Äî</div>
              </div>
              <div class="glass rounded-xl p-4 border border-amber-500/20">
                <div class="text-xs text-slate-400 mb-1">Per√≠odo Analisado</div>
                <div id="kpiPeriodo" class="text-lg font-bold text-amber-300">‚Äî</div>
              </div>
            </div>
          </header>
          
          <div class="grid grid-cols-12 gap-6 mb-6">
            <!-- Lista de √ìrg√£os -->
            <div class="col-span-12 lg:col-span-5 glass rounded-2xl p-5">
              <div class="flex items-center justify-between mb-4">
                <h3 class="font-semibold text-xl text-cyan-400">Manifesta√ß√µes por √ìrg√£o</h3>
                <div class="text-xs text-slate-400">Total: <span id="totalOrgaos" class="font-bold text-cyan-300">‚Äî</span></div>
              </div>
              
              <!-- Barra de Busca -->
              <div class="mb-4">
                <input 
                  type="text" 
                  id="searchOrgaos" 
                  placeholder="üîç Buscar √≥rg√£o..." 
                  class="w-full px-4 py-2 bg-slate-800/50 border border-slate-700 rounded-lg text-slate-200 placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent transition-all"
                />
              </div>
              
              <!-- Controles de Ordena√ß√£o -->
              <div class="flex items-center gap-2 mb-4">
                <button 
                  id="btnSortOrgaos" 
                  class="px-3 py-1 text-xs bg-slate-800/50 border border-slate-700 rounded-lg text-slate-300 hover:bg-slate-700/50 transition-colors"
                  onclick="toggleSortOrgaos()"
                >
                  Ordenar: <span id="sortMode">Maior ‚Üí Menor</span>
                </button>
              </div>
              
              <div id="listaOrgaos" class="space-y-2 max-h-[600px] overflow-y-auto custom-scrollbar">
                <div class="text-center text-slate-400 py-4">Carregando...</div>
              </div>
            </div>
            
            <!-- Gr√°fico Mensal -->
            <div class="col-span-12 lg:col-span-7 glass rounded-2xl p-5">
              <div class="flex items-center justify-between mb-4">
                <h3 class="font-semibold text-xl text-violet-400">Manifesta√ß√µes por M√™s</h3>
                <div class="text-xs text-slate-400">
                  <span id="infoMensal">Clique em um m√™s para filtrar</span>
                </div>
              </div>
              
              <!-- Estat√≠sticas do Gr√°fico Mensal -->
              <div class="grid grid-cols-3 gap-3 mb-4">
                <div class="glass rounded-lg p-3 border border-violet-500/20">
                  <div class="text-xs text-slate-400 mb-1">M√™s com Mais</div>
                  <div id="mesMax" class="text-sm font-bold text-violet-300">‚Äî</div>
                </div>
                <div class="glass rounded-lg p-3 border border-violet-500/20">
                  <div class="text-xs text-slate-400 mb-1">M√™s com Menos</div>
                  <div id="mesMin" class="text-sm font-bold text-violet-300">‚Äî</div>
                </div>
                <div class="glass rounded-lg p-3 border border-violet-500/20">
                  <div class="text-xs text-slate-400 mb-1">M√©dia Mensal</div>
                  <div id="mesMedia" class="text-sm font-bold text-violet-300">‚Äî</div>
                </div>
              </div>
              
              <div class="rounded-xl overflow-hidden bg-slate-900/30 p-4">
                <canvas id="chartOrgaoMes"></canvas>
              </div>
              
              <!-- Legenda e Informa√ß√µes -->
              <div id="infoOrgaoMes" class="mt-4 p-3 bg-slate-800/50 rounded-lg text-xs text-slate-400">
                üí° Dica: Clique em um m√™s no gr√°fico para filtrar os dados por per√≠odo
              </div>
            </div>
          </div>
          
          <!-- Gr√°fico de Compara√ß√£o (Opcional) -->
          <div class="grid grid-cols-12 gap-6">
            <div class="col-span-12 glass rounded-2xl p-5">
              <h3 class="font-semibold text-lg text-amber-400 mb-4">Top 10 √ìrg√£os</h3>
              <div class="rounded-xl overflow-hidden bg-slate-900/30 p-4">
                <canvas id="chartTopOrgaosBar"></canvas>
              </div>
            </div>
          </div>
        </section>
        
        <!-- P√°gina: Tempo M√©dio -->
        <section id="page-tempo-medio" style="display: none;">
          <header class="glass rounded-2xl p-6 mb-6">
            <div class="flex items-center justify-between mb-4">
              <h2 class="neon text-xl font-bold">‚è±Ô∏è Tempo M√©dio de Atendimento</h2>
              <div class="text-xs text-slate-400">An√°lise detalhada de tempo de resposta</div>
            </div>
            
            <!-- Filtros -->
            <div class="mb-4">
              <div>
                <label for="filtroMesTempoMedio" class="block text-sm font-medium text-slate-300 mb-2">
                  üìÖ Filtrar por m√™s:
                </label>
                <select 
                  id="filtroMesTempoMedio" 
                  class="w-full px-4 py-3 bg-slate-800/50 border border-slate-700 rounded-lg text-slate-200 focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent transition-all"
                >
                  <option value="">Todos os meses</option>
                </select>
              </div>
            </div>
            
            <!-- KPIs Principais -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mt-4 mb-4">
              <div class="glass rounded-xl p-4 border border-cyan-500/20">
                <div class="text-xs text-slate-400 mb-1">M√©dia Geral</div>
                <div id="statMedia" class="text-2xl font-bold text-cyan-300">‚Äî</div>
                <div class="text-xs text-slate-500 mt-1">dias</div>
              </div>
              <div class="glass rounded-xl p-4 border border-violet-500/20">
                <div class="text-xs text-slate-400 mb-1">Mediana</div>
                <div id="statMediana" class="text-2xl font-bold text-violet-300">‚Äî</div>
                <div class="text-xs text-slate-500 mt-1">dias</div>
              </div>
              <div class="glass rounded-xl p-4 border border-emerald-500/20">
                <div class="text-xs text-slate-400 mb-1">M√≠nimo</div>
                <div id="statMinimo" class="text-2xl font-bold text-emerald-300">‚Äî</div>
                <div class="text-xs text-slate-500 mt-1">dias</div>
              </div>
              <div class="glass rounded-xl p-4 border border-rose-500/20">
                <div class="text-xs text-slate-400 mb-1">M√°ximo</div>
                <div id="statMaximo" class="text-2xl font-bold text-red-300">‚Äî</div>
                <div class="text-xs text-slate-500 mt-1">dias</div>
              </div>
            </div>
          </header>

          <!-- Gr√°fico Principal e Ranking -->
          <div class="grid grid-cols-12 gap-6 mb-6">
            <div class="col-span-12 lg:col-span-8 glass rounded-2xl p-6 border border-cyan-500/20 shadow-lg shadow-cyan-500/10">
              <div class="flex items-center justify-between mb-4">
                <h3 class="font-bold text-lg text-cyan-400 flex items-center gap-2">
                  <span class="text-2xl">üìä</span>
                  Tempo M√©dio por √ìrg√£o/Unidade
                </h3>
                <div class="text-xs text-slate-400">Top 10 unidades</div>
              </div>
              <div class="rounded-xl overflow-hidden bg-gradient-to-br from-slate-900/50 via-slate-800/30 to-slate-900/50 p-4 border border-cyan-500/10">
                <canvas id="chartTempoMedio"></canvas>
              </div>
              <div class="mt-4 text-xs text-slate-400 flex items-center justify-center gap-2">
                <div class="w-3 h-3 rounded-full bg-gradient-to-r from-cyan-500 to-violet-500"></div>
                <span>M√©dia de dias para atendimento</span>
              </div>
            </div>
            <div class="col-span-12 lg:col-span-4 glass rounded-2xl p-5 border border-violet-500/20 shadow-lg shadow-violet-500/10">
              <div class="flex items-center justify-between mb-4">
                <h3 class="font-bold text-lg text-violet-400 flex items-center gap-2">
                  <span class="text-2xl">üèÜ</span>
                  Ranking
                </h3>
                <div class="flex items-center gap-2">
                  <button 
                    id="btnOrdenacaoDecrescente" 
                    class="px-3 py-1.5 text-xs font-medium rounded-lg transition-all duration-200 bg-violet-500/20 text-violet-300 border border-violet-500/30 hover:bg-violet-500/30 active:scale-95"
                    title="Maior tempo primeiro (quem mais demora)">
                    ‚¨áÔ∏è Decrescente
                  </button>
                  <button 
                    id="btnOrdenacaoCrescente" 
                    class="px-3 py-1.5 text-xs font-medium rounded-lg transition-all duration-200 bg-slate-700/30 text-slate-400 border border-slate-600/30 hover:bg-slate-600/40 hover:text-slate-300 active:scale-95"
                    title="Menor tempo primeiro (quem √© mais r√°pido)">
                    ‚¨ÜÔ∏è Crescente
                  </button>
                </div>
              </div>
              <div id="listaTempoMedio" class="space-y-2 max-h-[500px] overflow-y-auto custom-scrollbar">
                <div class="text-center text-slate-400 py-4">Carregando...</div>
              </div>
            </div>
          </div>

          <!-- Tend√™ncias Temporais -->
          <div class="mb-6">
            <div class="flex items-center gap-2 mb-4">
              <div class="h-px flex-1 bg-gradient-to-r from-transparent via-blue-500/50 to-transparent"></div>
              <h2 class="text-sm font-semibold text-blue-400 uppercase tracking-wider px-3">üìà Tend√™ncias Temporais</h2>
              <div class="h-px flex-1 bg-gradient-to-r from-transparent via-blue-500/50 to-transparent"></div>
            </div>
            <div class="grid grid-cols-12 gap-6">
              <div class="col-span-12 lg:col-span-4 glass rounded-2xl p-5">
                <h3 class="font-semibold mb-3 text-cyan-400">Tend√™ncia Di√°ria</h3>
                <div class="text-xs text-slate-400 mb-3">√öltimos 30 dias</div>
                <div class="rounded-xl overflow-hidden bg-slate-900/30 p-3">
                  <canvas id="chartTempoMedioDia"></canvas>
                </div>
              </div>
              <div class="col-span-12 lg:col-span-4 glass rounded-2xl p-5">
                <h3 class="font-semibold mb-3 text-cyan-400">Tend√™ncia Semanal</h3>
                <div class="text-xs text-slate-400 mb-3">√öltimas 12 semanas</div>
                <div class="rounded-xl overflow-hidden bg-slate-900/30 p-3">
                  <canvas id="chartTempoMedioSemana"></canvas>
                </div>
              </div>
              <div class="col-span-12 lg:col-span-4 glass rounded-2xl p-5">
                <h3 class="font-semibold mb-3 text-cyan-400">Tend√™ncia Mensal</h3>
                <div class="text-xs text-slate-400 mb-3">√öltimos 12 meses</div>
                <div class="rounded-xl overflow-hidden bg-slate-900/30 p-3">
                  <canvas id="chartTempoMedioMes"></canvas>
                </div>
              </div>
            </div>
          </div>

          <!-- An√°lise por Unidade -->
          <div class="mb-6">
            <div class="flex items-center gap-2 mb-4">
              <div class="h-px flex-1 bg-gradient-to-r from-transparent via-violet-500/50 to-transparent"></div>
              <h2 class="text-sm font-semibold text-violet-400 uppercase tracking-wider px-3">üè¢ An√°lise por Unidade</h2>
              <div class="h-px flex-1 bg-gradient-to-r from-transparent via-violet-500/50 to-transparent"></div>
            </div>
            <div class="grid grid-cols-12 gap-6">
              <div class="col-span-12 lg:col-span-6 glass rounded-2xl p-5">
                <h3 class="font-semibold mb-3 text-violet-400">Tempo M√©dio por Unidade de Cadastro</h3>
                <div class="rounded-xl overflow-hidden bg-slate-900/30 p-3">
                  <canvas id="chartTempoMedioUnidade"></canvas>
                </div>
              </div>
              <div class="col-span-12 lg:col-span-6 glass rounded-2xl p-5">
                <h3 class="font-semibold mb-3 text-emerald-400">Tempo M√©dio por Unidade de Cadastro por M√™s</h3>
                <div class="rounded-xl overflow-hidden bg-slate-900/30 p-3 mb-3">
                  <canvas id="chartTempoMedioUnidadeMes"></canvas>
                </div>
                <div id="legendTempoMedioUnidadeMes" class="space-y-2 max-h-[200px] overflow-y-auto text-xs"></div>
              </div>
            </div>
          </div>
        </section>
        
        <!-- P√°gina: Vencimento -->
        <section id="page-vencimento" style="display: none;">
          <header class="glass rounded-2xl p-6 mb-6">
            <div class="flex items-center justify-between mb-4">
              <h2 class="neon text-xl font-bold">‚è∞ Protocolos Pr√≥ximos de Vencer</h2>
              <div class="text-xs text-slate-400">An√°lise de prazos e vencimentos</div>
            </div>
            
            <!-- KPIs Principais -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mt-4 mb-4">
              <div class="glass rounded-xl p-4 border border-cyan-500/20">
                <div class="text-xs text-slate-400 mb-1">Total de Protocolos</div>
                <div id="kpiTotalVencimento" class="text-2xl font-bold text-cyan-300">‚Äî</div>
                <div class="text-xs text-slate-500 mt-1" id="filtroLabelVencimento">vencidos</div>
              </div>
              <div class="glass rounded-xl p-4 border border-red-500/20">
                <div class="text-xs text-slate-400 mb-1">Vencidos</div>
                <div id="kpiVencidos" class="text-2xl font-bold text-red-300">‚Äî</div>
                <div class="text-xs text-slate-500 mt-1">protocolos</div>
              </div>
              <div class="glass rounded-xl p-4 border border-orange-500/20">
                <div class="text-xs text-slate-400 mb-1">Vencendo em 3 dias</div>
                <div id="kpiVencendo3" class="text-2xl font-bold text-orange-300">‚Äî</div>
                <div class="text-xs text-slate-500 mt-1">protocolos</div>
              </div>
              <div class="glass rounded-xl p-4 border border-amber-500/20">
                <div class="text-xs text-slate-400 mb-1">Vencendo em 7 dias</div>
                <div id="kpiVencendo7" class="text-2xl font-bold text-amber-300">‚Äî</div>
                <div class="text-xs text-slate-500 mt-1">protocolos</div>
              </div>
            </div>
            
            <!-- Filtros -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
              <div>
                <label for="selectFiltroVencimento" class="block text-sm font-medium text-slate-300 mb-2">
                  Filtrar por prazo:
                </label>
                <select 
                  id="selectFiltroVencimento" 
                  class="w-full px-4 py-3 bg-slate-800/50 border border-slate-700 rounded-lg text-slate-200 focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent transition-all"
                >
                  <option value="vencidos">Vencidos</option>
                  <option value="3">Vencendo em at√© 3 dias</option>
                  <option value="7">Vencendo em at√© 7 dias</option>
                  <option value="15">Vencendo em at√© 15 dias</option>
                  <option value="30">Vencendo em at√© 30 dias</option>
                </select>
              </div>
              <div>
                <label for="selectSecretariaVencimento" class="block text-sm font-medium text-slate-300 mb-2">
                  Filtrar por secretaria:
                </label>
                <select 
                  id="selectSecretariaVencimento" 
                  class="w-full px-4 py-3 bg-slate-800/50 border border-slate-700 rounded-lg text-slate-200 focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent transition-all"
                >
                  <option value="">Todas as secretarias</option>
                </select>
              </div>
            </div>
          </header>
          
          <div class="glass rounded-2xl p-6">
            <div class="mb-4">
              <h3 class="font-semibold text-lg text-cyan-400 mb-2">Lista de Protocolos</h3>
              <p class="text-sm text-slate-400">
                Protocolos n√£o conclu√≠dos com prazo de vencimento pr√≥ximo ou j√° vencidos.
                <br>
                <span class="text-xs">Ouvidoria: 30 dias</span>
              </p>
            </div>
            <div id="tableVencimento" class="overflow-x-auto">
              <div class="text-center py-8 text-slate-400">
                <div class="text-2xl mb-2 animate-spin">‚è≥</div>
                <div>Carregando protocolos...</div>
              </div>
            </div>
          </div>
        </section>
        
        <!-- P√°gina: Protocolos com Maior Demora -->
        <section id="page-protocolos-demora" style="display: none;">
          <header class="glass rounded-2xl p-6 mb-6">
            <div class="flex items-center justify-between mb-4">
              <h2 class="neon text-xl font-bold">‚è≥ Protocolos com Maior Tempo de Demora</h2>
              <div class="text-xs text-slate-400">Top 10 protocolos com maior tempo de demora</div>
            </div>
            
            <!-- KPIs Principais -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mt-4 mb-4">
              <div class="glass rounded-xl p-4 border border-red-500/20">
                <div class="text-xs text-slate-400 mb-1">Total de Protocolos</div>
                <div id="kpiTotalDemora" class="text-2xl font-bold text-red-300">‚Äî</div>
                <div class="text-xs text-slate-500 mt-1">com maior demora</div>
              </div>
              <div class="glass rounded-xl p-4 border border-orange-500/20">
                <div class="text-xs text-slate-400 mb-1">Maior Demora</div>
                <div id="kpiMaiorDemora" class="text-2xl font-bold text-orange-300">‚Äî</div>
                <div class="text-xs text-slate-500 mt-1">dias</div>
              </div>
              <div class="glass rounded-xl p-4 border border-yellow-500/20">
                <div class="text-xs text-slate-400 mb-1">M√©dia de Demora</div>
                <div id="kpiMediaDemora" class="text-2xl font-bold text-yellow-300">‚Äî</div>
                <div class="text-xs text-slate-500 mt-1">dias</div>
              </div>
              <div class="glass rounded-xl p-4 border border-amber-500/20">
                <div class="text-xs text-slate-400 mb-1">N√£o Conclu√≠dos</div>
                <div id="kpiNaoConcluidos" class="text-2xl font-bold text-amber-300">‚Äî</div>
                <div class="text-xs text-slate-500 mt-1">protocolos</div>
              </div>
            </div>
          </header>
          
          <div class="glass rounded-2xl p-6">
            <div class="mb-4">
              <h3 class="font-semibold text-lg text-red-400 mb-2">Top 10 Protocolos com Maior Tempo de Demora</h3>
              <p class="text-sm text-slate-400">
                Protocolos ordenados por tempo de demora (em dias).
                <br>
                <span class="text-xs">Tempo de demora = Data atual/conclus√£o - Data de cria√ß√£o</span>
              </p>
            </div>
            <div id="tableProtocolosDemora" class="overflow-x-auto">
              <div class="text-center py-8 text-slate-400">
                <div class="text-2xl mb-2 animate-spin">‚è≥</div>
                <div>Carregando protocolos...</div>
              </div>
            </div>
          </div>
        </section>
        
        <!-- P√°gina: Notifica√ß√µes de Email -->
        <section id="page-notificacoes" style="display: none;">
          <header class="glass rounded-2xl p-6 mb-6">
            <div class="flex items-center justify-between mb-4">
              <h2 class="neon text-xl font-bold">üìß Verifica√ß√£o de Notifica√ß√µes de Email</h2>
              <div class="text-xs text-slate-400">Hist√≥rico e estat√≠sticas de emails enviados</div>
            </div>
            
            <!-- KPIs Principais -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mt-4 mb-4">
              <div class="glass rounded-xl p-4 border border-cyan-500/20">
                <div class="text-xs text-slate-400 mb-1">Total de Notifica√ß√µes</div>
                <div id="notificacoes-total" class="text-2xl font-bold text-cyan-300">‚Äî</div>
              </div>
              <div class="glass rounded-xl p-4 border border-green-500/20">
                <div class="text-xs text-slate-400 mb-1">Enviadas Hoje</div>
                <div id="notificacoes-hoje" class="text-2xl font-bold text-green-300">‚Äî</div>
              </div>
              <div class="glass rounded-xl p-4 border border-red-500/20">
                <div class="text-xs text-slate-400 mb-1">Erros</div>
                <div id="notificacoes-erros" class="text-2xl font-bold text-red-300">‚Äî</div>
              </div>
              <div class="glass rounded-xl p-4 border border-yellow-500/20">
                <div class="text-xs text-slate-400 mb-1">√öltima Execu√ß√£o</div>
                <div id="notificacoes-ultima-exec" class="text-lg font-bold text-yellow-300">‚Äî</div>
              </div>
            </div>
            
            <!-- Estat√≠sticas e Resumo -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
              <div class="glass rounded-xl p-4 border border-violet-500/20">
                <h3 class="text-sm font-semibold text-violet-400 mb-3">Por Tipo de Notifica√ß√£o</h3>
                <canvas id="notificacoes-chart-tipo"></canvas>
              </div>
              <div class="glass rounded-xl p-4 border border-blue-500/20">
                <h3 class="text-sm font-semibold text-blue-400 mb-3">Resumo de Hoje</h3>
                <div id="notificacoes-resumo-hoje" class="text-sm text-slate-300">
                  Carregando...
                </div>
              </div>
            </div>
            
            <!-- Filtros -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mt-4">
              <div>
                <label for="notificacoes-filtro-tipo" class="block text-sm font-medium text-slate-300 mb-2">
                  Tipo:
                </label>
                <select id="notificacoes-filtro-tipo" class="w-full px-4 py-2 bg-slate-800/50 border border-slate-700 rounded-lg text-slate-200">
                  <option value="">Todos</option>
                  <option value="15_dias">15 Dias Antes</option>
                  <option value="vencimento">Vencimento Hoje</option>
                  <option value="60_dias_vencido">60 Dias Vencido</option>
                </select>
              </div>
              <div>
                <label for="notificacoes-filtro-secretaria" class="block text-sm font-medium text-slate-300 mb-2">
                  Secretaria:
                </label>
                <input type="text" id="notificacoes-filtro-secretaria" placeholder="Filtrar por secretaria..." 
                  class="w-full px-4 py-2 bg-slate-800/50 border border-slate-700 rounded-lg text-slate-200">
              </div>
              <div>
                <label for="notificacoes-filtro-status" class="block text-sm font-medium text-slate-300 mb-2">
                  Status:
                </label>
                <select id="notificacoes-filtro-status" class="w-full px-4 py-2 bg-slate-800/50 border border-slate-700 rounded-lg text-slate-200">
                  <option value="">Todos</option>
                  <option value="enviado">Enviado</option>
                  <option value="erro">Erro</option>
                  <option value="pendente">Pendente</option>
                </select>
              </div>
              <div class="flex items-end gap-2">
                <button id="notificacoes-btn-aplicar" class="flex-1 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors">
                  Aplicar
                </button>
                <button id="notificacoes-btn-limpar" class="px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded-lg transition-colors">
                  Limpar
                </button>
              </div>
            </div>
          </header>
          
          <!-- Se√ß√£o: Controle Manual de Envio -->
          <div class="glass rounded-2xl p-6 mb-6">
            <div class="mb-4">
              <h3 class="font-semibold text-lg text-cyan-400 mb-2">üì§ Controle Manual de Envio</h3>
              <p class="text-sm text-slate-400">
                Carregue vencimentos, selecione quais secretarias receber√£o emails e envie manualmente.
              </p>
            </div>
            
            <!-- Bot√µes para carregar vencimentos -->
            <div class="flex flex-wrap gap-3 mb-4">
              <button id="notificacoes-btn-hoje" data-tipo-vencimento="hoje" 
                class="px-4 py-2 bg-yellow-600 hover:bg-yellow-700 text-white rounded-lg transition-colors font-semibold">
                ‚ö†Ô∏è Vencimento Hoje
              </button>
              <button id="notificacoes-btn-15" data-tipo-vencimento="15" 
                class="px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors font-semibold">
                üü¢ 15 Dias Antes
              </button>
              <button id="notificacoes-btn-60" data-tipo-vencimento="60" 
                class="px-4 py-2 bg-red-800 hover:bg-red-900 text-white rounded-lg transition-colors font-semibold">
                üî¥ 60+ Dias Vencido
              </button>
            </div>
            
            <!-- Loading -->
            <div id="notificacoes-controle-loading" class="hidden mb-4 p-4 bg-slate-800/50 rounded-lg text-center">
              <span class="animate-spin inline-block mr-2">‚è≥</span>
              <span class="text-slate-300">Carregando vencimentos...</span>
            </div>
            
            <!-- Painel de Vencimentos -->
            <div id="notificacoes-painel-vencimentos" class="hidden mb-4 p-4 bg-slate-800/30 rounded-lg border border-slate-700">
              <!-- Ser√° preenchido dinamicamente -->
            </div>
            
            <!-- Lista de Emails -->
            <div id="notificacoes-lista-emails-container" class="hidden">
              <div class="flex items-center justify-between mb-3">
                <h4 class="font-semibold text-slate-300">Secretarias que receber√£o emails:</h4>
                <div class="flex items-center gap-3">
                  <button id="notificacoes-btn-selecionar-todos" 
                    class="px-3 py-1 text-sm bg-slate-700 hover:bg-slate-600 text-white rounded transition-colors">
                    Selecionar Todos
                  </button>
                  <span id="notificacoes-contador-selecionados" class="text-sm text-slate-400">0 selecionado(s)</span>
                </div>
              </div>
              
              <div id="notificacoes-lista-emails" class="space-y-2 max-h-96 overflow-y-auto">
                <!-- Ser√° preenchido dinamicamente -->
              </div>
              
              <div class="mt-4 pt-4 border-t border-slate-700">
                <button id="notificacoes-btn-enviar" 
                  class="w-full px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors font-semibold disabled:opacity-50 disabled:cursor-not-allowed"
                  disabled>
                  üìß Enviar Emails Selecionados
                </button>
              </div>
              
              <!-- Loading de envio -->
              <div id="notificacoes-envio-loading" class="hidden mt-4 p-4 bg-blue-500/20 border border-blue-500/50 rounded-lg text-center">
                <span class="animate-spin inline-block mr-2">‚è≥</span>
                <span class="text-blue-300">Enviando emails...</span>
              </div>
              
              <!-- Resultado do envio -->
              <div id="notificacoes-envio-resultado" class="hidden mt-4 p-4 bg-slate-800/50 rounded-lg border border-slate-700">
                <!-- Ser√° preenchido dinamicamente -->
              </div>
            </div>
          </div>
          
          <div class="glass rounded-2xl p-6">
            <div class="mb-4">
              <h3 class="font-semibold text-lg text-cyan-400 mb-2">Hist√≥rico de Notifica√ß√µes</h3>
              <p class="text-sm text-slate-400">
                Lista de todos os emails enviados pelo sistema de notifica√ß√µes autom√°ticas.
              </p>
            </div>
            
            <div id="notificacoes-error" class="hidden mb-4 p-3 bg-red-500/20 border border-red-500/50 rounded-lg text-red-400 text-sm"></div>
            
            <div class="overflow-x-auto">
              <table class="w-full">
                <thead>
                  <tr class="border-b border-slate-700">
                    <th class="px-4 py-3 text-left text-xs font-semibold text-slate-400 uppercase">Protocolo</th>
                    <th class="px-4 py-3 text-left text-xs font-semibold text-slate-400 uppercase">Secretaria</th>
                    <th class="px-4 py-3 text-left text-xs font-semibold text-slate-400 uppercase">Email</th>
                    <th class="px-4 py-3 text-left text-xs font-semibold text-slate-400 uppercase">Status</th>
                    <th class="px-4 py-3 text-left text-xs font-semibold text-slate-400 uppercase">Tipo</th>
                    <th class="px-4 py-3 text-left text-xs font-semibold text-slate-400 uppercase">Enviado Em</th>
                    <th class="px-4 py-3 text-left text-xs font-semibold text-slate-400 uppercase">Dias Restantes</th>
                  </tr>
                </thead>
                <tbody id="notificacoes-table-body">
                  <tr>
                    <td colspan="7" class="text-center py-8 text-slate-500">
                      Carregando...
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            
            <div id="notificacoes-paginacao" class="flex justify-center gap-2 mt-4"></div>
          </div>
        </section>
        
        <!-- P√°gina: Por Tema -->
        <section id="page-tema" style="display: none;">
          <header class="glass rounded-2xl p-6 mb-6">
            <div class="flex items-center justify-between mb-4">
              <h2 class="neon text-xl font-bold">üìë Manifesta√ß√µes por Tema</h2>
              <div class="text-xs text-slate-400">An√°lise detalhada por tema</div>
            </div>
            
            <!-- Filtros -->
            <div class="mb-4">
              <div>
                <label for="filtroMesTema" class="block text-sm font-medium text-slate-300 mb-2">
                  üìÖ Filtrar por m√™s:
                </label>
                <select 
                  id="filtroMesTema" 
                  class="w-full px-4 py-3 bg-slate-800/50 border border-slate-700 rounded-lg text-slate-200 focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent transition-all"
                >
                  <option value="">Todos os meses</option>
                </select>
              </div>
            </div>
            
            <!-- KPIs Principais -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mt-4">
              <div class="glass rounded-xl p-4 border border-cyan-500/20">
                <div class="text-xs text-slate-400 mb-1">Total de Manifesta√ß√µes</div>
                <div id="kpiTotalTema" class="text-2xl font-bold text-cyan-300">‚Äî</div>
              </div>
              <div class="glass rounded-xl p-4 border border-violet-500/20">
                <div class="text-xs text-slate-400 mb-1">Temas √önicos</div>
                <div id="kpiTemasUnicos" class="text-2xl font-bold text-violet-300">‚Äî</div>
              </div>
              <div class="glass rounded-xl p-4 border border-emerald-500/20">
                <div class="text-xs text-slate-400 mb-1">Tema Mais Comum</div>
                <div id="kpiTemaMaisComum" class="text-lg font-bold text-emerald-300 truncate">‚Äî</div>
              </div>
              <div class="glass rounded-xl p-4 border border-amber-500/20">
                <div class="text-xs text-slate-400 mb-1">M√©dia por Tema</div>
                <div id="kpiMediaTema" class="text-2xl font-bold text-amber-300">‚Äî</div>
              </div>
            </div>
          </header>
          
          <!-- Gr√°ficos Principais -->
          <div class="grid grid-cols-12 gap-6 mb-6">
            <div class="col-span-12 lg:col-span-8 glass rounded-2xl p-5">
              <div class="flex items-center justify-between mb-3">
                <h3 class="font-semibold text-violet-400">Distribui√ß√£o por Tema</h3>
                <div class="flex items-center gap-2 text-xs text-slate-400">
                  <span class="flex items-center gap-1">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 15l-2 5L9 9l11 4-5 2zm0 0l5 5M7.188 2.239l.777 2.897M5.136 7.965l-2.898-.777M13.95 4.05l-2.122 2.122m-5.657 5.656l-2.12 2.122" />
                    </svg>
                    Top 10
                  </span>
                  <span class="text-slate-500">‚Ä¢</span>
                  <span class="flex items-center gap-1">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 15l-2 5L9 9l11 4-5 2zm0 0l5 5M7.188 2.239l.777 2.897M5.136 7.965l-2.898-.777M13.95 4.05l-2.122 2.122m-5.657 5.656l-2.12 2.122" />
                    </svg>
                    Clique para filtrar
                  </span>
                </div>
              </div>
              <div class="rounded-xl overflow-hidden bg-slate-900/30 p-3" style="min-height: 400px;">
                <canvas id="chartTema"></canvas>
              </div>
              <p class="text-xs text-slate-400 mt-2 flex items-center gap-1">
                <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
                Clique em uma barra para filtrar por tema. Clique com bot√£o direito para limpar filtros.
              </p>
            </div>
            <div class="col-span-12 lg:col-span-4 glass rounded-2xl p-5">
              <h3 class="font-semibold mb-3 text-violet-400">Status Geral</h3>
              <div class="rounded-xl overflow-hidden bg-slate-900/30 p-3 mb-3">
                <canvas id="chartStatusTema"></canvas>
              </div>
              <div id="legendStatusTema" class="space-y-2 max-h-[250px] overflow-y-auto text-xs"></div>
            </div>
          </div>

          <!-- An√°lise Temporal -->
          <div class="mb-6">
            <div class="flex items-center gap-2 mb-4">
              <div class="h-px flex-1 bg-gradient-to-r from-transparent via-blue-500/50 to-transparent"></div>
              <h2 class="text-sm font-semibold text-blue-400 uppercase tracking-wider px-3">üìà An√°lise Temporal</h2>
              <div class="h-px flex-1 bg-gradient-to-r from-transparent via-blue-500/50 to-transparent"></div>
            </div>
            <div class="glass rounded-2xl p-5">
              <h3 class="font-semibold mb-3 text-violet-400">Temas por M√™s</h3>
              <div class="rounded-xl overflow-hidden bg-slate-900/30 p-3 mb-3">
                <canvas id="chartTemaMes"></canvas>
              </div>
              <div id="legendTemaMes" class="space-y-2 text-xs"></div>
            </div>
          </div>

          <!-- Lista Completa -->
          <div class="glass rounded-2xl p-5">
            <h3 class="font-semibold mb-3 text-violet-400">Lista Completa de Temas</h3>
            <div id="listaTemas" class="space-y-2 max-h-[500px] overflow-y-auto">
              <div class="text-center text-slate-400 py-4">Carregando...</div>
            </div>
          </div>
        </section>
        
        <!-- P√°gina: Por Assunto -->
        <section id="page-assunto" style="display: none;">
          <header class="glass rounded-2xl p-6 mb-6">
            <div class="flex items-center justify-between mb-4">
              <h2 class="neon text-xl font-bold">üìù Manifesta√ß√µes por Assunto</h2>
              <div class="text-xs text-slate-400">An√°lise detalhada por assunto</div>
            </div>
            
            <!-- Filtros -->
            <div class="mb-4">
              <div>
                <label for="filtroMesAssunto" class="block text-sm font-medium text-slate-300 mb-2">
                  üìÖ Filtrar por m√™s:
                </label>
                <select 
                  id="filtroMesAssunto" 
                  class="w-full px-4 py-3 bg-slate-800/50 border border-slate-700 rounded-lg text-slate-200 focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent transition-all"
                >
                  <option value="">Todos os meses</option>
                </select>
              </div>
            </div>
            
            <!-- KPIs Principais -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mt-4">
              <div class="glass rounded-xl p-4 border border-cyan-500/20">
                <div class="text-xs text-slate-400 mb-1">Total de Manifesta√ß√µes</div>
                <div id="kpiTotalAssunto" class="text-2xl font-bold text-cyan-300">‚Äî</div>
              </div>
              <div class="glass rounded-xl p-4 border border-violet-500/20">
                <div class="text-xs text-slate-400 mb-1">Assuntos √önicos</div>
                <div id="kpiAssuntosUnicos" class="text-2xl font-bold text-violet-300">‚Äî</div>
              </div>
              <div class="glass rounded-xl p-4 border border-emerald-500/20">
                <div class="text-xs text-slate-400 mb-1">Assunto Mais Comum</div>
                <div id="kpiAssuntoMaisComum" class="text-lg font-bold text-emerald-300 truncate">‚Äî</div>
              </div>
              <div class="glass rounded-xl p-4 border border-amber-500/20">
                <div class="text-xs text-slate-400 mb-1">M√©dia por Assunto</div>
                <div id="kpiMediaAssunto" class="text-2xl font-bold text-amber-300">‚Äî</div>
              </div>
            </div>
          </header>
          
          <!-- Gr√°ficos Principais -->
          <div class="grid grid-cols-12 gap-6 mb-6">
            <div class="col-span-12 lg:col-span-8 glass rounded-2xl p-5">
              <h3 class="font-semibold mb-3 text-emerald-400">Top 15 Assuntos</h3>
              <div class="rounded-xl overflow-hidden bg-slate-900/30 p-3">
                <canvas id="chartAssunto"></canvas>
              </div>
            </div>
            <div class="col-span-12 lg:col-span-4 glass rounded-2xl p-5">
              <h3 class="font-semibold mb-3 text-emerald-400">Status</h3>
              <div class="rounded-xl overflow-hidden bg-slate-900/30 p-3 mb-3">
                <canvas id="chartStatusAssunto"></canvas>
              </div>
              <div id="legendStatusAssunto" class="space-y-2 max-h-[250px] overflow-y-auto text-xs"></div>
            </div>
          </div>

          <!-- An√°lise Temporal -->
          <div class="mb-6">
            <div class="flex items-center gap-2 mb-4">
              <div class="h-px flex-1 bg-gradient-to-r from-transparent via-blue-500/50 to-transparent"></div>
              <h2 class="text-sm font-semibold text-blue-400 uppercase tracking-wider px-3">üìà An√°lise Temporal</h2>
              <div class="h-px flex-1 bg-gradient-to-r from-transparent via-blue-500/50 to-transparent"></div>
            </div>
            <div class="glass rounded-2xl p-5">
              <h3 class="font-semibold mb-3 text-emerald-400">Assuntos por M√™s</h3>
              <div class="rounded-xl overflow-hidden bg-slate-900/30 p-3 mb-3">
                <canvas id="chartAssuntoMes"></canvas>
              </div>
              <div id="legendAssuntoMes" class="space-y-2 text-xs"></div>
            </div>
          </div>

          <!-- Lista Completa -->
          <div class="glass rounded-2xl p-5">
            <h3 class="font-semibold mb-3 text-emerald-400">Lista Completa de Assuntos</h3>
            <div id="listaAssuntos" class="space-y-2 max-h-[500px] overflow-y-auto">
              <div class="text-center text-slate-400 py-4">Carregando...</div>
            </div>
          </div>
        </section>
        
        <!-- P√°gina: Tipos -->
        <section id="page-tipo" style="display: none;">
          <header class="glass rounded-2xl p-6 mb-6">
            <div class="flex items-center justify-between mb-4">
              <h2 class="neon text-xl font-bold">üìã Tipos de Manifesta√ß√£o</h2>
              <div class="text-xs text-slate-400">An√°lise por tipo de manifesta√ß√£o</div>
            </div>
            
            <!-- KPIs Principais -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mt-4">
              <div class="glass rounded-xl p-4 border border-cyan-500/20">
                <div class="text-xs text-slate-400 mb-1">Total de Manifesta√ß√µes</div>
                <div id="kpiTotalTipo" class="text-2xl font-bold text-cyan-300">‚Äî</div>
              </div>
              <div class="glass rounded-xl p-4 border border-violet-500/20">
                <div class="text-xs text-slate-400 mb-1">Tipos √önicos</div>
                <div id="kpiTiposUnicos" class="text-2xl font-bold text-violet-300">‚Äî</div>
              </div>
              <div class="glass rounded-xl p-4 border border-emerald-500/20">
                <div class="text-xs text-slate-400 mb-1">Tipo Mais Comum</div>
                <div id="kpiTipoMaisComum" class="text-lg font-bold text-emerald-300 truncate">‚Äî</div>
              </div>
              <div class="glass rounded-xl p-4 border border-amber-500/20">
                <div class="text-xs text-slate-400 mb-1">M√©dia por Tipo</div>
                <div id="kpiMediaTipo" class="text-2xl font-bold text-amber-300">‚Äî</div>
              </div>
            </div>
          </header>
          <div class="grid grid-cols-12 gap-6">
            <div class="col-span-12 md:col-span-6 glass rounded-2xl p-5">
              <h3 class="font-semibold mb-3 text-violet-400">Distribui√ß√£o por Tipo</h3>
              <div class="rounded-xl overflow-hidden bg-slate-900/30 p-3 mb-3">
                <canvas id="chartTipo"></canvas>
              </div>
              <div id="legendTipo" class="space-y-2 max-h-[300px] overflow-y-auto text-xs"></div>
            </div>
            <div class="col-span-12 md:col-span-6 glass rounded-2xl p-5">
              <h3 class="font-semibold mb-3 text-violet-400">Top Tipos (Rank)</h3>
              <ul id="rankTipo" class="space-y-2"></ul>
            </div>
          </div>
        </section>
        
        <!-- P√°gina: Respons√°veis -->
        <section id="page-responsavel" style="display: none;">
          <header class="glass rounded-2xl p-6 mb-6">
            <div class="flex items-center justify-between mb-4">
              <h2 class="neon text-xl font-bold">üë• Respons√°veis pelo Tratamento da Demanda</h2>
              <div class="text-xs text-slate-400">An√°lise por respons√°vel</div>
            </div>
            
            <!-- Filtros -->
            <div class="mb-4">
              <div>
                <label for="filtroMesResponsavel" class="block text-sm font-medium text-slate-300 mb-2">
                  üìÖ Filtrar por m√™s:
                </label>
                <select 
                  id="filtroMesResponsavel" 
                  class="w-full px-4 py-3 bg-slate-800/50 border border-slate-700 rounded-lg text-slate-200 focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent transition-all"
                >
                  <option value="">Todos os meses</option>
                </select>
              </div>
            </div>
            
            <!-- KPIs Principais -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mt-4">
              <div class="glass rounded-xl p-4 border border-cyan-500/20">
                <div class="text-xs text-slate-400 mb-1">Total de Manifesta√ß√µes</div>
                <div id="kpiTotalResponsavel" class="text-2xl font-bold text-cyan-300">‚Äî</div>
              </div>
              <div class="glass rounded-xl p-4 border border-violet-500/20">
                <div class="text-xs text-slate-400 mb-1">Respons√°veis √önicos</div>
                <div id="kpiResponsaveisUnicos" class="text-2xl font-bold text-violet-300">‚Äî</div>
              </div>
              <div class="glass rounded-xl p-4 border border-emerald-500/20">
                <div class="text-xs text-slate-400 mb-1">Respons√°vel Mais Ativo</div>
                <div id="kpiResponsavelMaisAtivo" class="text-lg font-bold text-emerald-300 truncate">‚Äî</div>
              </div>
              <div class="glass rounded-xl p-4 border border-amber-500/20">
                <div class="text-xs text-slate-400 mb-1">M√©dia por Respons√°vel</div>
                <div id="kpiMediaResponsavel" class="text-2xl font-bold text-amber-300">‚Äî</div>
              </div>
            </div>
          </header>
          <div class="grid grid-cols-12 gap-6">
            <div class="col-span-12 md:col-span-6 glass rounded-2xl p-5">
              <h3 class="font-semibold mb-3 text-violet-400">Distribui√ß√£o por Respons√°vel</h3>
              <div class="rounded-xl overflow-hidden bg-slate-900/30 p-3">
                <canvas id="chartResponsavel"></canvas>
              </div>
            </div>
            <div class="col-span-12 md:col-span-6 glass rounded-2xl p-5">
              <h3 class="font-semibold mb-3 text-violet-400">Top Respons√°veis (Rank)</h3>
              <ul id="rankResponsavel" class="space-y-2"></ul>
            </div>
          </div>
        </section>
        
        <!-- P√°gina: Canal -->
        <section id="page-canal" style="display: none;">
          <header class="glass rounded-2xl p-6 mb-6">
            <div class="flex items-center justify-between mb-4">
              <h2 class="neon text-xl font-bold">üìû Canais de Atendimento</h2>
              <div class="text-xs text-slate-400">An√°lise por canal de entrada</div>
            </div>
            
            <!-- Filtros -->
            <div class="mb-4">
              <div>
                <label for="filtroMesCanal" class="block text-sm font-medium text-slate-300 mb-2">
                  üìÖ Filtrar por m√™s:
                </label>
                <select 
                  id="filtroMesCanal" 
                  class="w-full px-4 py-3 bg-slate-800/50 border border-slate-700 rounded-lg text-slate-200 focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent transition-all"
                >
                  <option value="">Todos os meses</option>
                </select>
              </div>
            </div>
            
            <!-- KPIs Principais -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mt-4">
              <div class="glass rounded-xl p-4 border border-cyan-500/20">
                <div class="text-xs text-slate-400 mb-1">Total de Manifesta√ß√µes</div>
                <div id="kpiTotalCanal" class="text-2xl font-bold text-cyan-300">‚Äî</div>
              </div>
              <div class="glass rounded-xl p-4 border border-violet-500/20">
                <div class="text-xs text-slate-400 mb-1">Canais √önicos</div>
                <div id="kpiCanaisUnicos" class="text-2xl font-bold text-violet-300">‚Äî</div>
              </div>
              <div class="glass rounded-xl p-4 border border-emerald-500/20">
                <div class="text-xs text-slate-400 mb-1">Canal Mais Usado</div>
                <div id="kpiCanalMaisUsado" class="text-lg font-bold text-emerald-300 truncate">‚Äî</div>
              </div>
              <div class="glass rounded-xl p-4 border border-amber-500/20">
                <div class="text-xs text-slate-400 mb-1">M√©dia por Canal</div>
                <div id="kpiMediaCanal" class="text-2xl font-bold text-amber-300">‚Äî</div>
              </div>
            </div>
          </header>
          <div class="grid grid-cols-12 gap-6">
            <div class="col-span-12 md:col-span-6 glass rounded-2xl p-5">
              <h3 class="font-semibold mb-3 text-emerald-400">Distribui√ß√£o por Canal</h3>
              <div class="rounded-xl overflow-hidden bg-slate-900/30 p-3 mb-3">
                <canvas id="chartCanal"></canvas>
              </div>
              <div id="legendCanal" class="space-y-2 max-h-[300px] overflow-y-auto text-xs"></div>
            </div>
            <div class="col-span-12 md:col-span-6 glass rounded-2xl p-5">
              <h3 class="font-semibold mb-3 text-emerald-400">Top Canais (Rank)</h3>
              <ul id="rankCanal" class="space-y-2"></ul>
            </div>
          </div>
        </section>
        
        <!-- P√°gina: Prioridade -->
        <section id="page-prioridade" style="display: none;">
          <header class="glass rounded-2xl p-6 mb-6">
            <div class="flex items-center justify-between mb-4">
              <h2 class="neon text-xl font-bold">‚ö° Prioridades das Demandas</h2>
              <div class="text-xs text-slate-400">An√°lise por n√≠vel de prioridade</div>
            </div>
            
            <!-- Filtros -->
            <div class="mb-4">
              <div>
                <label for="filtroMesPrioridade" class="block text-sm font-medium text-slate-300 mb-2">
                  üìÖ Filtrar por m√™s:
                </label>
                <select 
                  id="filtroMesPrioridade" 
                  class="w-full px-4 py-3 bg-slate-800/50 border border-slate-700 rounded-lg text-slate-200 focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent transition-all"
                >
                  <option value="">Todos os meses</option>
                </select>
              </div>
            </div>
            
            <!-- KPIs Principais -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mt-4">
              <div class="glass rounded-xl p-4 border border-cyan-500/20">
                <div class="text-xs text-slate-400 mb-1">Total de Manifesta√ß√µes</div>
                <div id="kpiTotalPrioridade" class="text-2xl font-bold text-cyan-300">‚Äî</div>
              </div>
              <div class="glass rounded-xl p-4 border border-violet-500/20">
                <div class="text-xs text-slate-400 mb-1">Prioridades √önicas</div>
                <div id="kpiPrioridadesUnicas" class="text-2xl font-bold text-violet-300">‚Äî</div>
              </div>
              <div class="glass rounded-xl p-4 border border-rose-500/20">
                <div class="text-xs text-slate-400 mb-1">Prioridade Mais Comum</div>
                <div id="kpiPrioridadeMaisComum" class="text-lg font-bold text-rose-300 truncate">‚Äî</div>
              </div>
              <div class="glass rounded-xl p-4 border border-amber-500/20">
                <div class="text-xs text-slate-400 mb-1">M√©dia por Prioridade</div>
                <div id="kpiMediaPrioridade" class="text-2xl font-bold text-amber-300">‚Äî</div>
              </div>
            </div>
          </header>
          <div class="grid grid-cols-12 gap-6">
            <div class="col-span-12 md:col-span-6 glass rounded-2xl p-5">
              <h3 class="font-semibold mb-3 text-rose-400">Distribui√ß√£o por Prioridade</h3>
              <div class="rounded-xl overflow-hidden bg-slate-900/30 p-3 mb-3">
                <canvas id="chartPrioridade"></canvas>
              </div>
              <div id="legendPrioridade" class="space-y-2 max-h-[300px] overflow-y-auto text-xs"></div>
            </div>
            <div class="col-span-12 md:col-span-6 glass rounded-2xl p-5">
              <h3 class="font-semibold mb-3 text-rose-400">Ranking de Prioridades</h3>
              <ul id="rankPrioridade" class="space-y-2"></ul>
            </div>
          </div>
        </section>
        
        <!-- P√°gina: Status -->
        <section id="page-status" style="display: none;">
          <header class="glass rounded-2xl p-6 mb-6">
            <div class="flex items-center justify-between mb-4">
              <h2 class="neon text-xl font-bold">üìä Status das Manifesta√ß√µes</h2>
              <div class="text-xs text-slate-400">An√°lise por status</div>
            </div>
            
            <!-- KPIs Principais -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mt-4">
              <div class="glass rounded-xl p-4 border border-cyan-500/20">
                <div class="text-xs text-slate-400 mb-1">Total de Manifesta√ß√µes</div>
                <div id="kpiTotalStatus" class="text-2xl font-bold text-cyan-300">‚Äî</div>
              </div>
              <div class="glass rounded-xl p-4 border border-violet-500/20">
                <div class="text-xs text-slate-400 mb-1">Status √önicos</div>
                <div id="kpiStatusUnicos" class="text-2xl font-bold text-violet-300">‚Äî</div>
              </div>
              <div class="glass rounded-xl p-4 border border-emerald-500/20">
                <div class="text-xs text-slate-400 mb-1">Status Mais Comum</div>
                <div id="kpiStatusMaisComum" class="text-lg font-bold text-emerald-300 truncate">‚Äî</div>
              </div>
              <div class="glass rounded-xl p-4 border border-amber-500/20">
                <div class="text-xs text-slate-400 mb-1">Taxa de Conclus√£o</div>
                <div id="kpiTaxaConclusao" class="text-2xl font-bold text-amber-300">‚Äî</div>
              </div>
            </div>
          </header>
          <div class="grid grid-cols-12 gap-6">
            <div class="col-span-12 md:col-span-6 glass rounded-2xl p-5">
              <h3 class="font-semibold mb-3 text-sky-400">Distribui√ß√£o por Status</h3>
              <div class="rounded-xl overflow-hidden bg-slate-900/30 p-3 mb-3">
                <canvas id="chartStatusPage"></canvas>
              </div>
              <div id="legendStatusPage" class="space-y-2 max-h-[300px] overflow-y-auto text-xs"></div>
            </div>
            <div class="col-span-12 md:col-span-6 glass rounded-2xl p-5">
              <h3 class="font-semibold mb-3 text-sky-400">Status por M√™s</h3>
              <div class="rounded-xl overflow-hidden bg-slate-900/30 p-3 mb-3">
                <canvas id="chartStatusMes"></canvas>
              </div>
              <div id="legendStatusMes" class="space-y-2 text-xs"></div>
            </div>
          </div>
        </section>
        
        <!-- P√°gina: Bairro -->
        <section id="page-bairro" style="display: none;">
          <header class="glass rounded-2xl p-6 mb-6">
            <div class="flex items-center justify-between mb-4">
              <h2 class="neon text-xl font-bold">üèòÔ∏è An√°lise por Bairro</h2>
              <div class="text-xs text-slate-400">An√°lise geogr√°fica por bairro</div>
            </div>
            
            <!-- KPIs Principais -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mt-4">
              <div class="glass rounded-xl p-4 border border-cyan-500/20">
                <div class="text-xs text-slate-400 mb-1">Total de Manifesta√ß√µes</div>
                <div id="kpiTotalBairro" class="text-2xl font-bold text-cyan-300">‚Äî</div>
              </div>
              <div class="glass rounded-xl p-4 border border-violet-500/20">
                <div class="text-xs text-slate-400 mb-1">Bairros √önicos</div>
                <div id="kpiBairrosUnicos" class="text-2xl font-bold text-violet-300">‚Äî</div>
              </div>
              <div class="glass rounded-xl p-4 border border-amber-500/20">
                <div class="text-xs text-slate-400 mb-1">Bairro Mais Ativo</div>
                <div id="kpiBairroMaisAtivo" class="text-lg font-bold text-amber-300 truncate">‚Äî</div>
              </div>
              <div class="glass rounded-xl p-4 border border-emerald-500/20">
                <div class="text-xs text-slate-400 mb-1">M√©dia por Bairro</div>
                <div id="kpiMediaBairro" class="text-2xl font-bold text-emerald-300">‚Äî</div>
              </div>
            </div>
          </header>
          <div class="grid grid-cols-12 gap-6">
            <div class="col-span-12 md:col-span-6 glass rounded-2xl p-5">
              <h3 class="font-semibold mb-3 text-amber-400">Top 15 Bairros</h3>
              <div class="rounded-xl overflow-hidden bg-slate-900/30 p-3">
                <canvas id="chartBairro"></canvas>
              </div>
            </div>
            <div class="col-span-12 md:col-span-6 glass rounded-2xl p-5">
              <h3 class="font-semibold mb-3 text-amber-400">Bairros por M√™s</h3>
              <div class="rounded-xl overflow-hidden bg-slate-900/30 p-3 mb-3">
                <canvas id="chartBairroMes"></canvas>
              </div>
              <div id="legendBairroMes" class="space-y-2 text-xs"></div>
            </div>
          </div>
        </section>
        
        <!-- P√°gina: Por Cadastrante -->
        <section id="page-cadastrante" style="display: none;">
          <header class="glass rounded-2xl p-6 mb-6">
            <div class="flex items-center justify-between mb-4">
              <h2 class="neon text-xl font-bold">üë§ Por Cadastrante / Unidade</h2>
              <div class="text-xs text-slate-400">An√°lise por servidor e unidade de cadastro</div>
            </div>
            
            <!-- Filtros -->
            <div class="mb-4">
              <div>
                <label for="filtroMesCadastrante" class="block text-sm font-medium text-slate-300 mb-2">
                  üìÖ Filtrar por m√™s:
                </label>
                <select 
                  id="filtroMesCadastrante" 
                  class="w-full px-4 py-3 bg-slate-800/50 border border-slate-700 rounded-lg text-slate-200 focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent transition-all"
                >
                  <option value="">Todos os meses</option>
                </select>
              </div>
            </div>
            
            <!-- KPIs Principais -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mt-4">
              <div class="glass rounded-xl p-4 border border-cyan-500/20">
                <div class="text-xs text-slate-400 mb-1">Total de Manifesta√ß√µes</div>
                <div id="kpiTotalCadastrante" class="text-2xl font-bold text-cyan-300">‚Äî</div>
              </div>
              <div class="glass rounded-xl p-4 border border-violet-500/20">
                <div class="text-xs text-slate-400 mb-1">Servidores √önicos</div>
                <div id="kpiServidoresUnicos" class="text-2xl font-bold text-violet-300">‚Äî</div>
              </div>
              <div class="glass rounded-xl p-4 border border-emerald-500/20">
                <div class="text-xs text-slate-400 mb-1">Unidades de Cadastro</div>
                <div id="kpiUnidadesUnicas" class="text-2xl font-bold text-emerald-300">‚Äî</div>
              </div>
              <div class="glass rounded-xl p-4 border border-amber-500/20">
                <div class="text-xs text-slate-400 mb-1">Servidor Mais Ativo</div>
                <div id="kpiServidorMaisAtivo" class="text-lg font-bold text-amber-300 truncate">‚Äî</div>
              </div>
            </div>
          </header>
          <div class="grid grid-cols-12 gap-6">
            <div class="col-span-12 lg:col-span-6 glass rounded-2xl p-5">
              <h3 class="font-semibold mb-3 text-cyan-400">Por Servidor</h3>
              <div id="listaServidores" class="space-y-2 max-h-[600px] overflow-y-auto">
                <div class="text-center text-slate-400 py-4">Carregando...</div>
              </div>
            </div>
            <div class="col-span-12 lg:col-span-6 glass rounded-2xl p-5">
              <h3 class="font-semibold mb-3 text-violet-400">Unidades de Cadastro</h3>
              <div id="listaUnidadesCadastro" class="space-y-2 max-h-[600px] overflow-y-auto">
                <div class="text-center text-slate-400 py-4">Carregando...</div>
              </div>
            </div>
            <div class="col-span-12 lg:col-span-6 glass rounded-2xl p-5">
              <h3 class="font-semibold mb-3 text-violet-400">Filtro / M√™s</h3>
              <div class="rounded-xl overflow-hidden bg-slate-900/30 p-3">
                <canvas id="chartCadastranteMes"></canvas>
              </div>
            </div>
            <div class="col-span-12 lg:col-span-6 glass rounded-2xl p-5 text-center" style="background: linear-gradient(135deg, rgba(34,211,238,0.15), rgba(167,139,250,0.15));">
              <div class="text-sm text-slate-400 mb-2">Manifesta√ß√µes</div>
              <div id="totalCadastrante" class="text-6xl font-extrabold text-cyan-300 mb-2">‚Äî</div>
              <div class="text-xs text-slate-400">TOTAL CADASTRADAS AT√â O MOMENTO</div>
            </div>
          </div>
        </section>
        
        <!-- P√°gina: Reclama√ß√µes -->
        <section id="page-reclamacoes" style="display: none;">
          <header class="glass rounded-2xl p-6 mb-6">
            <div class="flex items-center justify-between mb-4">
              <h2 class="neon text-xl font-bold">üö® Reclama√ß√µes e Den√∫ncias</h2>
              <div class="text-xs text-slate-400">An√°lise de reclama√ß√µes e den√∫ncias</div>
            </div>
            
            <!-- KPIs Principais -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mt-4">
              <div class="glass rounded-xl p-4 border border-rose-500/20">
                <div class="text-xs text-slate-400 mb-1">Total de Reclama√ß√µes</div>
                <div id="kpiTotalReclamacoes" class="text-2xl font-bold text-rose-300">‚Äî</div>
              </div>
              <div class="glass rounded-xl p-4 border border-red-500/20">
                <div class="text-xs text-slate-400 mb-1">Total de Den√∫ncias</div>
                <div id="kpiTotalDenuncias" class="text-2xl font-bold text-red-300">‚Äî</div>
              </div>
              <div class="glass rounded-xl p-4 border border-violet-500/20">
                <div class="text-xs text-slate-400 mb-1">Assuntos √önicos</div>
                <div id="kpiAssuntosUnicos" class="text-2xl font-bold text-violet-300">‚Äî</div>
              </div>
              <div class="glass rounded-xl p-4 border border-amber-500/20">
                <div class="text-xs text-slate-400 mb-1">Assunto Mais Comum</div>
                <div id="kpiAssuntoMaisComum" class="text-lg font-bold text-amber-300 truncate">‚Äî</div>
              </div>
            </div>
          </header>
          <div class="grid grid-cols-12 gap-6 mb-6">
            <div class="col-span-12 lg:col-span-6 glass rounded-2xl p-5">
              <h3 class="font-semibold mb-3 text-rose-400">Lista de Assuntos</h3>
              <div id="listaReclamacoes" class="space-y-2 max-h-[500px] overflow-y-auto">
                <div class="text-center text-slate-400 py-4">Carregando...</div>
              </div>
            </div>
            <div class="col-span-12 lg:col-span-6 glass rounded-2xl p-5">
              <h3 class="font-semibold mb-3 text-rose-400">Tipos de A√ß√£o</h3>
              <div class="rounded-xl overflow-hidden bg-slate-900/30 p-3">
                <canvas id="chartReclamacoesTipo"></canvas>
              </div>
            </div>
          </div>
          <div class="glass rounded-2xl p-5">
            <h3 class="font-semibold mb-3 text-rose-400">Reclama√ß√µes por M√™s</h3>
            <div class="rounded-xl overflow-hidden bg-slate-900/30 p-3">
              <canvas id="chartReclamacoesMes"></canvas>
            </div>
          </div>
        </section>
        
        <!-- P√°gina: Proje√ß√£o 2026 -->
        <section id="page-projecao-2026" style="display: none;">
          <header class="glass rounded-2xl p-6 mb-6">
            <h2 class="neon text-xl font-bold">üìà Proje√ß√£o 2026</h2>
            <p class="text-slate-400 text-sm mt-2">An√°lise de tend√™ncias e proje√ß√µes baseadas em dados hist√≥ricos com c√°lculo de sazonalidade e crescimento real</p>
          </header>
          
          <!-- KPIs Principais -->
          <div class="grid grid-cols-12 gap-6 mb-6">
            <div class="col-span-12 lg:col-span-3 glass rounded-2xl p-5">
              <div class="text-slate-400 text-sm mb-1">Total Hist√≥rico</div>
              <div id="totalHistorico" class="text-2xl font-bold text-cyan-300">‚Äî</div>
            </div>
            <div class="col-span-12 lg:col-span-3 glass rounded-2xl p-5">
              <div class="text-slate-400 text-sm mb-1">Total Projetado 2026</div>
              <div id="totalProjetado" class="text-2xl font-bold text-violet-300">‚Äî</div>
            </div>
            <div class="col-span-12 lg:col-span-3 glass rounded-2xl p-5">
              <div class="text-slate-400 text-sm mb-1">M√©dia Mensal</div>
              <div id="mediaMensal" class="text-2xl font-bold text-emerald-300">‚Äî</div>
            </div>
            <div class="col-span-12 lg:col-span-3 glass rounded-2xl p-5">
              <div class="text-slate-400 text-sm mb-1">Crescimento Anual</div>
              <div id="crescimentoAnual" class="text-2xl font-bold text-emerald-300">‚Äî</div>
              <div id="tendencia" class="text-xs text-slate-400 mt-1">‚Äî</div>
            </div>
          </div>
          
          <!-- Gr√°ficos Principais -->
          <div class="grid grid-cols-12 gap-6 mb-6">
            <div class="col-span-12 glass rounded-2xl p-5">
              <h3 class="font-semibold mb-4 text-cyan-400">üìä Tend√™ncia Mensal (Hist√≥rico + Proje√ß√£o)</h3>
              <p class="text-slate-400 text-xs mb-4">Evolu√ß√£o hist√≥rica e proje√ß√£o para 2026 baseada em an√°lise de tend√™ncia e sazonalidade</p>
              <canvas id="chartProjecaoMensal"></canvas>
              <div id="legendProjecaoMensal" class="mt-4 space-y-2"></div>
            </div>
          </div>
          
          <!-- An√°lise de Crescimento e Sazonalidade -->
          <div class="grid grid-cols-12 gap-6 mb-6">
            <div class="col-span-12 lg:col-span-6 glass rounded-2xl p-5">
              <h3 class="font-semibold mb-4 text-violet-400">üìà Crescimento Percentual M√™s a M√™s</h3>
              <p class="text-slate-400 text-xs mb-4">Varia√ß√£o percentual entre meses consecutivos (hist√≥rico e proje√ß√£o)</p>
              <canvas id="chartCrescimentoPercentual"></canvas>
              </div>
            <div class="col-span-12 lg:col-span-6 glass rounded-2xl p-5">
              <h3 class="font-semibold mb-4 text-emerald-400">üìÖ Sazonalidade Mensal</h3>
              <p class="text-slate-400 text-xs mb-4">Padr√£o sazonal identificado nos dados hist√≥ricos (100% = m√©dia mensal)</p>
              <canvas id="chartSazonalidade"></canvas>
            </div>
          </div>
          
          <!-- Compara√ß√£o Anual -->
          <div class="grid grid-cols-12 gap-6 mb-6">
            <div class="col-span-12 glass rounded-2xl p-5">
              <h3 class="font-semibold mb-4 text-cyan-400">üìä Compara√ß√£o Anual: M√©dia Hist√≥rica vs Proje√ß√£o 2026</h3>
              <p class="text-slate-400 text-xs mb-4">Compara√ß√£o m√™s a m√™s entre a m√©dia hist√≥rica e a proje√ß√£o para 2026</p>
              <canvas id="chartComparacaoAnual"></canvas>
              <div id="legendComparacaoAnual" class="mt-4 space-y-2"></div>
            </div>
          </div>
          
          <!-- Proje√ß√µes por Categoria -->
          <div class="grid grid-cols-12 gap-6 mb-6">
            <div class="col-span-12 lg:col-span-6 glass rounded-2xl p-5">
              <h3 class="font-semibold mb-4 text-violet-400">üéØ Proje√ß√£o por Tema (Top 10)</h3>
              <p class="text-slate-400 text-xs mb-4">Proje√ß√£o anual para 2026 baseada nos temas mais frequentes</p>
              <canvas id="chartProjecaoTema"></canvas>
                </div>
            <div class="col-span-12 lg:col-span-6 glass rounded-2xl p-5">
              <h3 class="font-semibold mb-4 text-cyan-400">üìã Proje√ß√£o por Tipo</h3>
              <p class="text-slate-400 text-xs mb-4">Distribui√ß√£o projetada por tipo de manifesta√ß√£o em 2026</p>
              <canvas id="chartProjecaoTipo"></canvas>
              <div id="legendProjecaoTipo" class="mt-4 space-y-2"></div>
                </div>
                </div>
          
          <!-- Rankings e Listas -->
          <div class="grid grid-cols-12 gap-6 mb-6">
            <div class="col-span-12 lg:col-span-4 glass rounded-2xl p-5">
              <h3 class="font-semibold mb-4 text-violet-400">üèÜ Top Temas</h3>
              <div id="listaTemasProjecao" class="space-y-2 max-h-[400px] overflow-y-auto">
                <div class="text-center text-slate-400 py-4">Carregando...</div>
              </div>
            </div>
            <div class="col-span-12 lg:col-span-4 glass rounded-2xl p-5">
              <h3 class="font-semibold mb-4 text-cyan-400">üìã Top Tipos</h3>
              <div id="listaTiposProjecao" class="space-y-2 max-h-[400px] overflow-y-auto">
                <div class="text-center text-slate-400 py-4">Carregando...</div>
              </div>
            </div>
            <div class="col-span-12 lg:col-span-4 glass rounded-2xl p-5">
              <h3 class="font-semibold mb-4 text-emerald-400">üèõÔ∏è Top √ìrg√£os</h3>
              <div id="listaOrgaosProjecao" class="space-y-2 max-h-[400px] overflow-y-auto">
                <div class="text-center text-slate-400 py-4">Carregando...</div>
              </div>
            </div>
          </div>
          
          <!-- KPIs Detalhados -->
          <div class="grid grid-cols-12 gap-6">
            <div class="col-span-12 glass rounded-2xl p-5">
              <h3 class="font-semibold mb-4 text-emerald-400">üìä Indicadores Detalhados</h3>
              <div id="kpisProjecao" class="space-y-4">
                <div class="text-center text-slate-400 py-4">Carregando...</div>
              </div>
            </div>
          </div>
        </section>
        
        <!-- P√°gina: Filtros Avan√ßados -->
        <section id="page-filtros-avancados" style="display: none;">
          <div class="glass rounded-2xl p-6 mb-6">
            <div class="flex items-center justify-between mb-4">
              <div class="flex items-center gap-3">
                <div class="text-2xl">üîç</div>
                <h2 class="neon text-xl font-bold">Filtros Avan√ßados</h2>
              </div>
              <div class="flex items-center gap-3">
                <span class="text-xs text-slate-400">Filtre protocolos por m√∫ltiplos crit√©rios</span>
                <label class="relative inline-flex items-center cursor-pointer">
                  <input type="checkbox" id="toggleFiltros" class="sr-only peer" checked>
                  <div class="w-11 h-6 bg-slate-700 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-yellow-500"></div>
                </label>
              </div>
            </div>
            
            <!-- Estat√≠sticas -->
            <div class="grid grid-cols-4 gap-4 mt-4 mb-6">
              <div class="glass rounded-lg p-4 border border-cyan-500/20">
                <div class="text-xs text-slate-400 mb-1">Filtros Ativos</div>
                <div id="contadorFiltrosAtivos" class="text-2xl font-bold text-cyan-300">0</div>
              </div>
              <div class="glass rounded-lg p-4 border border-violet-500/20">
                <div class="text-xs text-slate-400 mb-1">Protocolos Filtrados</div>
                <div id="totalProtocolosFiltrados" class="text-2xl font-bold text-violet-300">‚Äî</div>
              </div>
              <div class="glass rounded-lg p-4 border border-emerald-500/20">
                <div class="text-xs text-slate-400 mb-1">Total de Protocolos</div>
                <div id="totalProtocolos" class="text-2xl font-bold text-emerald-300">‚Äî</div>
              </div>
              <div class="glass rounded-lg p-4 border border-amber-500/20">
                <div class="text-xs text-slate-400 mb-1">% Filtrado</div>
                <div id="percentualFiltrado" class="text-2xl font-bold text-amber-300">‚Äî</div>
              </div>
            </div>
          </div>
          
          <!-- Filtros Dispon√≠veis -->
          <div class="glass rounded-2xl p-6 mb-6">
            <div class="flex items-center justify-between mb-4">
              <h3 class="text-lg font-semibold text-cyan-300">Filtros Dispon√≠veis</h3>
              <div class="flex gap-2">
                <button id="btnAplicarFiltros" class="px-4 py-2 bg-green-500/20 border border-green-500/50 rounded-lg text-green-300 hover:bg-green-500/30 transition-colors flex items-center gap-2">
                  <span>‚úì</span>
                  <span>Aplicar Filtros</span>
                </button>
                <button id="btnLimparTodos" class="px-4 py-2 bg-slate-700/50 border border-slate-600/50 rounded-lg text-slate-300 hover:bg-slate-700/70 transition-colors flex items-center gap-2">
                  <span>‚Üª</span>
                  <span>Limpar Todos</span>
                </button>
              </div>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
              <!-- Coluna 1 -->
              <div class="space-y-4">
                <div>
                  <label class="block text-sm font-medium text-slate-300 mb-2">Protocolo</label>
                  <input 
                    type="text" 
                    id="filtroProtocolo" 
                    placeholder="Digite o protocolo..." 
                    class="w-full px-4 py-2 bg-slate-800/50 border border-slate-700 rounded-lg text-slate-200 placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent transition-all"
                  />
                </div>
                
                <div>
                  <label class="block text-sm font-medium text-slate-300 mb-2">Status Demanda</label>
                  <select 
                    id="filtroStatusDemanda" 
                    class="w-full px-4 py-2 bg-slate-800/50 border border-slate-700 rounded-lg text-slate-200 focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent transition-all"
                  >
                    <option value="">Todos</option>
                  </select>
                </div>
                
                <div>
                  <label class="block text-sm font-medium text-slate-300 mb-2">Unidade/Cadastro</label>
                  <select 
                    id="filtroUnidadeCadastro" 
                    class="w-full px-4 py-2 bg-slate-800/50 border border-slate-700 rounded-lg text-slate-200 focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent transition-all"
                  >
                    <option value="">Todos</option>
                  </select>
                </div>
                
                <div>
                  <label class="block text-sm font-medium text-slate-300 mb-2">Canal</label>
                  <select 
                    id="filtroCanal" 
                    class="w-full px-4 py-2 bg-slate-800/50 border border-slate-700 rounded-lg text-slate-200 focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent transition-all"
                  >
                    <option value="">Todos</option>
                  </select>
                </div>
              </div>
              
              <!-- Coluna 2 -->
              <div class="space-y-4">
                <div>
                  <label class="block text-sm font-medium text-slate-300 mb-2">Servidor</label>
                  <select 
                    id="filtroServidor" 
                    class="w-full px-4 py-2 bg-slate-800/50 border border-slate-700 rounded-lg text-slate-200 focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent transition-all"
                  >
                    <option value="">Todos</option>
                  </select>
                </div>
                
                <div>
                  <label class="block text-sm font-medium text-slate-300 mb-2">Tipo de Manifesta√ß√£o</label>
                  <select 
                    id="filtroTipoManifestacao" 
                    class="w-full px-4 py-2 bg-slate-800/50 border border-slate-700 rounded-lg text-slate-200 focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent transition-all"
                  >
                    <option value="">Todos</option>
                  </select>
                </div>
                
                <div>
                  <label class="block text-sm font-medium text-slate-300 mb-2">Tema</label>
                  <select 
                    id="filtroTema" 
                    class="w-full px-4 py-2 bg-slate-800/50 border border-slate-700 rounded-lg text-slate-200 focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent transition-all"
                  >
                    <option value="">Todos</option>
                  </select>
                </div>
                
                <div>
                  <label class="block text-sm font-medium text-slate-300 mb-2">Prioridade</label>
                  <select 
                    id="filtroPrioridade" 
                    class="w-full px-4 py-2 bg-slate-800/50 border border-slate-700 rounded-lg text-slate-200 focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent transition-all"
                  >
                    <option value="">Todos</option>
                  </select>
                </div>
                
                <div>
                  <label class="block text-sm font-medium text-slate-300 mb-2">Unidade/Sa√∫de</label>
                  <select 
                    id="filtroUnidadeSaude" 
                    class="w-full px-4 py-2 bg-slate-800/50 border border-slate-700 rounded-lg text-slate-200 focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent transition-all"
                  >
                    <option value="">Todos</option>
                  </select>
                </div>
              </div>
              
              <!-- Coluna 3 -->
              <div class="space-y-4">
                <div>
                  <label class="block text-sm font-medium text-slate-300 mb-2">Per√≠odo da Cria√ß√£o</label>
                  <div class="grid grid-cols-2 gap-3">
                    <div class="relative">
                      <label class="block text-xs text-slate-400 mb-1">Data Inicial</label>
                      <input 
                        type="date" 
                        id="filtroDataCriacaoInicial" 
                        class="w-full px-4 py-2 bg-slate-800/50 border border-slate-700 rounded-lg text-slate-200 focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent transition-all"
                      />
                      <div class="absolute right-3 top-[1.75rem] text-slate-400 pointer-events-none">üìÖ</div>
                    </div>
                    <div class="relative">
                      <label class="block text-xs text-slate-400 mb-1">Data Final</label>
                      <input 
                        type="date" 
                        id="filtroDataCriacaoFinal" 
                        class="w-full px-4 py-2 bg-slate-800/50 border border-slate-700 rounded-lg text-slate-200 focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent transition-all"
                      />
                      <div class="absolute right-3 top-[1.75rem] text-slate-400 pointer-events-none">üìÖ</div>
                    </div>
                  </div>
                </div>
                
                <div>
                  <label class="block text-sm font-medium text-slate-300 mb-2">Assunto</label>
                  <select 
                    id="filtroAssunto" 
                    class="w-full px-4 py-2 bg-slate-800/50 border border-slate-700 rounded-lg text-slate-200 focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent transition-all"
                  >
                    <option value="">Todos</option>
                  </select>
                </div>
                
                <div>
                  <label class="block text-sm font-medium text-slate-300 mb-2">Respons√°vel</label>
                  <select 
                    id="filtroResponsavel" 
                    class="w-full px-4 py-2 bg-slate-800/50 border border-slate-700 rounded-lg text-slate-200 focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent transition-all"
                  >
                    <option value="">Todos</option>
                  </select>
                </div>
                
                <div>
                  <label class="block text-sm font-medium text-slate-300 mb-2">Status</label>
                  <select 
                    id="filtroStatus" 
                    class="w-full px-4 py-2 bg-slate-800/50 border border-slate-700 rounded-lg text-slate-200 focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent transition-all"
                  >
                    <option value="">Todos</option>
                  </select>
                </div>
              </div>
            </div>
          </div>
          
          <!-- Protocolos Filtrados -->
          <div class="glass rounded-2xl p-6">
            <h3 class="text-lg font-semibold text-cyan-300 mb-2">Protocolos Filtrados</h3>
            <p class="text-sm text-slate-400 mb-4">Resultados baseados nos filtros aplicados acima.</p>
            <div id="resultadosFiltros" class="min-h-[400px] flex items-center justify-center overflow-x-auto">
              <div class="text-center">
                <div class="text-6xl mb-4 text-slate-600">üîç</div>
                <p class="text-slate-400">Aplique os filtros acima para visualizar os resultados</p>
              </div>
            </div>
          </div>
          
          <!-- Bot√£o Flutuante: Voltar ao Topo -->
          <button 
            id="btnVoltarTopo" 
            class="fixed bottom-8 right-8 w-14 h-14 bg-gradient-to-r from-cyan-500/80 to-violet-500/80 hover:from-cyan-500 hover:to-violet-500 border-2 border-cyan-400/50 rounded-full shadow-lg shadow-cyan-500/20 flex items-center justify-center text-white text-2xl transition-all duration-300 opacity-0 pointer-events-none z-50 backdrop-blur-sm"
            onclick="voltarAoTopo()"
            title="Voltar ao topo"
          >
            ‚Üë
          </button>
        </section>
        
        <!-- P√°gina: Cora Chat -->
        <section id="page-cora-chat" style="display: none;">
          <header class="glass rounded-2xl p-6 mb-6">
            <h2 class="neon text-xl font-bold">üí¨ Cora - Assistente Virtual</h2>
          </header>
          <div class="grid grid-cols-12 gap-6">
            <div class="col-span-12 glass rounded-2xl p-5">
              <div class="flex flex-col h-[600px]">
                <div id="chatMessages" class="flex-1 overflow-y-auto mb-4 space-y-4 p-4 bg-slate-900/30 rounded-lg">
                  <div class="text-center text-slate-400 py-4">Carregando mensagens...</div>
                </div>
                <form id="chatForm" class="flex gap-2" onsubmit="return false;" action="javascript:void(0);">
                  <input 
                    type="text" 
                    id="chatInput" 
                    placeholder="Digite sua mensagem..." 
                    class="flex-1 bg-slate-800/60 border border-white/10 rounded-lg px-4 py-2 text-sm text-slate-200 placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-purple-500/50"
                    autocomplete="off"
                  />
                  <button 
                    type="button" 
                    id="chatSubmitBtn"
                    class="px-4 py-2 bg-gradient-to-r from-purple-500 to-pink-500 rounded-lg text-white font-semibold hover:from-purple-600 hover:to-pink-600 transition-all glow-ring"
                  >
                    Enviar
                  </button>
                </form>
              </div>
            </div>
          </div>
        </section>
        
        <!-- P√°gina Unificada de Unidades de Sa√∫de -->
        <section id="page-unidades-saude" style="display: none;">
          <header class="glass rounded-2xl p-6 mb-6">
            <div class="flex items-center justify-between mb-4">
              <h2 class="neon text-xl font-bold">üè• Unidades de Sa√∫de</h2>
              <div class="text-xs text-slate-400">An√°lise por unidade de sa√∫de</div>
            </div>
            
            <!-- KPIs Principais -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mt-4 mb-4">
              <div class="glass rounded-xl p-4 border border-cyan-500/20">
                <div class="text-xs text-slate-400 mb-1">Total de Manifesta√ß√µes</div>
                <div id="kpiTotalUnidadeSaude" class="text-2xl font-bold text-cyan-300">‚Äî</div>
              </div>
              <div class="glass rounded-xl p-4 border border-violet-500/20">
                <div class="text-xs text-slate-400 mb-1">Assuntos √önicos</div>
                <div id="kpiAssuntosUnicosUnidade" class="text-2xl font-bold text-violet-300">‚Äî</div>
              </div>
              <div class="glass rounded-xl p-4 border border-emerald-500/20">
                <div class="text-xs text-slate-400 mb-1">Assunto Mais Comum</div>
                <div id="kpiAssuntoMaisComumUnidade" class="text-lg font-bold text-emerald-300 truncate">‚Äî</div>
              </div>
              <div class="glass rounded-xl p-4 border border-amber-500/20">
                <div class="text-xs text-slate-400 mb-1">Tipos de Manifesta√ß√£o</div>
                <div id="kpiTiposUnicosUnidade" class="text-2xl font-bold text-amber-300">‚Äî</div>
              </div>
            </div>
            
            <div class="mt-4">
              <label for="selectUnidade" class="block text-sm font-medium text-slate-300 mb-2">
                Selecione uma unidade de sa√∫de:
              </label>
              <select 
                id="selectUnidade" 
                class="w-full px-4 py-3 bg-slate-800/50 border border-slate-700 rounded-lg text-slate-200 focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent transition-all"
              >
                <option value="" disabled selected>Carregando unidades...</option>
              </select>
            </div>
          </header>
          <div id="unidadeConteudo">
            <div class="glass rounded-2xl p-12 text-center">
              <div class="text-6xl mb-4">üè•</div>
              <h3 class="text-xl font-semibold text-slate-300 mb-2">Selecione uma Unidade de Sa√∫de</h3>
              <p class="text-slate-400">Use o menu acima para escolher uma unidade e visualizar seus dados</p>
            </div>
          </div>
        </section>
        
        <!-- P√°ginas de Unidades de Sa√∫de (Din√¢micas) - OBSOLETAS (mantidas para compatibilidade) -->
        <!-- Estas p√°ginas s√£o criadas dinamicamente via loadUnit() ou pr√©-definidas abaixo -->
        <section id="page-unit-adao" class="unit-page" style="display: none;">
          <header class="glass rounded-2xl p-6 mb-6"><h2 class="neon text-xl font-bold">Total de Assuntos Hospital Ad√£o</h2></header>
          <div class="grid grid-cols-12 gap-6">
            <div class="col-span-12 lg:col-span-8 glass rounded-2xl p-5">
              <h3 class="font-semibold mb-4 text-cyan-400">Assuntos</h3>
              <div class="unit-assuntos space-y-2 max-h-[600px] overflow-y-auto"></div>
            </div>
            <div class="col-span-12 lg:col-span-4 glass rounded-2xl p-5">
              <h3 class="font-semibold mb-4 text-cyan-400">Record Count por Tipo de A√ß√£o</h3>
              <canvas class="unit-tipos"></canvas>
            </div>
          </div>
        </section>
        <section id="page-unit-cer-iv" class="unit-page" style="display: none;">
          <header class="glass rounded-2xl p-6 mb-6"><h2 class="neon text-xl font-bold">Total de Assuntos CER IV</h2></header>
          <div class="grid grid-cols-12 gap-6">
            <div class="col-span-12 lg:col-span-8 glass rounded-2xl p-5">
              <h3 class="font-semibold mb-4 text-cyan-400">Assuntos</h3>
              <div class="unit-assuntos space-y-2 max-h-[600px] overflow-y-auto"></div>
            </div>
            <div class="col-span-12 lg:col-span-4 glass rounded-2xl p-5">
              <h3 class="font-semibold mb-4 text-cyan-400">Record Count por Tipo de A√ß√£o</h3>
              <canvas class="unit-tipos"></canvas>
            </div>
          </div>
        </section>
        <section id="page-unit-hospital-olho" class="unit-page" style="display: none;">
          <header class="glass rounded-2xl p-6 mb-6"><h2 class="neon text-xl font-bold">Total de Assuntos Hospital do Olho</h2></header>
          <div class="grid grid-cols-12 gap-6">
            <div class="col-span-12 lg:col-span-8 glass rounded-2xl p-5">
              <h3 class="font-semibold mb-4 text-cyan-400">Assuntos</h3>
              <div class="unit-assuntos space-y-2 max-h-[600px] overflow-y-auto"></div>
            </div>
            <div class="col-span-12 lg:col-span-4 glass rounded-2xl p-5">
              <h3 class="font-semibold mb-4 text-cyan-400">Record Count por Tipo de A√ß√£o</h3>
              <canvas class="unit-tipos"></canvas>
            </div>
          </div>
        </section>
        <section id="page-unit-hospital-duque" class="unit-page" style="display: none;">
          <header class="glass rounded-2xl p-6 mb-6"><h2 class="neon text-xl font-bold">Total de Assuntos Hospital Duque</h2></header>
          <div class="grid grid-cols-12 gap-6">
            <div class="col-span-12 lg:col-span-8 glass rounded-2xl p-5">
              <h3 class="font-semibold mb-4 text-cyan-400">Assuntos</h3>
              <div class="unit-assuntos space-y-2 max-h-[600px] overflow-y-auto"></div>
            </div>
            <div class="col-span-12 lg:col-span-4 glass rounded-2xl p-5">
              <h3 class="font-semibold mb-4 text-cyan-400">Record Count por Tipo de A√ß√£o</h3>
              <canvas class="unit-tipos"></canvas>
            </div>
          </div>
        </section>
        <section id="page-unit-hospital-infantil" class="unit-page" style="display: none;">
          <header class="glass rounded-2xl p-6 mb-6"><h2 class="neon text-xl font-bold">Total de Assuntos Hospital Infantil</h2></header>
          <div class="grid grid-cols-12 gap-6">
            <div class="col-span-12 lg:col-span-8 glass rounded-2xl p-5">
              <h3 class="font-semibold mb-4 text-cyan-400">Assuntos</h3>
              <div class="unit-assuntos space-y-2 max-h-[600px] overflow-y-auto"></div>
            </div>
            <div class="col-span-12 lg:col-span-4 glass rounded-2xl p-5">
              <h3 class="font-semibold mb-4 text-cyan-400">Record Count por Tipo de A√ß√£o</h3>
              <canvas class="unit-tipos"></canvas>
            </div>
          </div>
        </section>
        <section id="page-unit-hospital-moacyr" class="unit-page" style="display: none;">
          <header class="glass rounded-2xl p-6 mb-6"><h2 class="neon text-xl font-bold">Total de Assuntos Hospital Moacyr</h2></header>
          <div class="grid grid-cols-12 gap-6">
            <div class="col-span-12 lg:col-span-8 glass rounded-2xl p-5">
              <h3 class="font-semibold mb-4 text-cyan-400">Assuntos</h3>
              <div class="unit-assuntos space-y-2 max-h-[600px] overflow-y-auto"></div>
            </div>
            <div class="col-span-12 lg:col-span-4 glass rounded-2xl p-5">
              <h3 class="font-semibold mb-4 text-cyan-400">Record Count por Tipo de A√ß√£o</h3>
              <canvas class="unit-tipos"></canvas>
            </div>
          </div>
        </section>
        <section id="page-unit-maternidade-santa-cruz" class="unit-page" style="display: none;">
          <header class="glass rounded-2xl p-6 mb-6"><h2 class="neon text-xl font-bold">Total de Assuntos Maternidade Santa Cruz</h2></header>
          <div class="grid grid-cols-12 gap-6">
            <div class="col-span-12 lg:col-span-8 glass rounded-2xl p-5">
              <h3 class="font-semibold mb-4 text-cyan-400">Assuntos</h3>
              <div class="unit-assuntos space-y-2 max-h-[600px] overflow-y-auto"></div>
            </div>
            <div class="col-span-12 lg:col-span-4 glass rounded-2xl p-5">
              <h3 class="font-semibold mb-4 text-cyan-400">Record Count por Tipo de A√ß√£o</h3>
              <canvas class="unit-tipos"></canvas>
            </div>
          </div>
        </section>
        <section id="page-unit-upa-beira-mar" class="unit-page" style="display: none;">
          <header class="glass rounded-2xl p-6 mb-6"><h2 class="neon text-xl font-bold">Total de Assuntos UPA Beira Mar</h2></header>
          <div class="grid grid-cols-12 gap-6">
            <div class="col-span-12 lg:col-span-8 glass rounded-2xl p-5">
              <h3 class="font-semibold mb-4 text-cyan-400">Assuntos</h3>
              <div class="unit-assuntos space-y-2 max-h-[600px] overflow-y-auto"></div>
            </div>
            <div class="col-span-12 lg:col-span-4 glass rounded-2xl p-5">
              <h3 class="font-semibold mb-4 text-cyan-400">Record Count por Tipo de A√ß√£o</h3>
              <canvas class="unit-tipos"></canvas>
            </div>
          </div>
        </section>
        <section id="page-unit-uph-pilar" class="unit-page" style="display: none;">
          <header class="glass rounded-2xl p-6 mb-6"><h2 class="neon text-xl font-bold">Total de Assuntos UPH Pilar</h2></header>
          <div class="grid grid-cols-12 gap-6">
            <div class="col-span-12 lg:col-span-8 glass rounded-2xl p-5">
              <h3 class="font-semibold mb-4 text-cyan-400">Assuntos</h3>
              <div class="unit-assuntos space-y-2 max-h-[600px] overflow-y-auto"></div>
            </div>
            <div class="col-span-12 lg:col-span-4 glass rounded-2xl p-5">
              <h3 class="font-semibold mb-4 text-cyan-400">Record Count por Tipo de A√ß√£o</h3>
              <canvas class="unit-tipos"></canvas>
            </div>
          </div>
        </section>
        <section id="page-unit-uph-saracuruna" class="unit-page" style="display: none;">
          <header class="glass rounded-2xl p-6 mb-6"><h2 class="neon text-xl font-bold">Total de Assuntos UPH Saracuruna</h2></header>
          <div class="grid grid-cols-12 gap-6">
            <div class="col-span-12 lg:col-span-8 glass rounded-2xl p-5">
              <h3 class="font-semibold mb-4 text-cyan-400">Assuntos</h3>
              <div class="unit-assuntos space-y-2 max-h-[600px] overflow-y-auto"></div>
            </div>
            <div class="col-span-12 lg:col-span-4 glass rounded-2xl p-5">
              <h3 class="font-semibold mb-4 text-cyan-400">Record Count por Tipo de A√ß√£o</h3>
              <canvas class="unit-tipos"></canvas>
            </div>
          </div>
        </section>
        <section id="page-unit-uph-xerem" class="unit-page" style="display: none;">
          <header class="glass rounded-2xl p-6 mb-6"><h2 class="neon text-xl font-bold">Total de Assuntos UPH Xer√©m</h2></header>
          <div class="grid grid-cols-12 gap-6">
            <div class="col-span-12 lg:col-span-8 glass rounded-2xl p-5">
              <h3 class="font-semibold mb-4 text-cyan-400">Assuntos</h3>
              <div class="unit-assuntos space-y-2 max-h-[600px] overflow-y-auto"></div>
            </div>
            <div class="col-span-12 lg:col-span-4 glass rounded-2xl p-5">
              <h3 class="font-semibold mb-4 text-cyan-400">Record Count por Tipo de A√ß√£o</h3>
              <canvas class="unit-tipos"></canvas>
            </div>
          </div>
        </section>
        <section id="page-unit-hospital-veterinario" class="unit-page" style="display: none;">
          <header class="glass rounded-2xl p-6 mb-6"><h2 class="neon text-xl font-bold">Total de Assuntos Hospital Veterin√°rio</h2></header>
          <div class="grid grid-cols-12 gap-6">
            <div class="col-span-12 lg:col-span-8 glass rounded-2xl p-5">
              <h3 class="font-semibold mb-4 text-cyan-400">Assuntos</h3>
              <div class="unit-assuntos space-y-2 max-h-[600px] overflow-y-auto"></div>
            </div>
            <div class="col-span-12 lg:col-span-4 glass rounded-2xl p-5">
              <h3 class="font-semibold mb-4 text-cyan-400">Record Count por Tipo de A√ß√£o</h3>
              <canvas class="unit-tipos"></canvas>
            </div>
          </div>
        </section>
        <section id="page-unit-upa-walter-garcia" class="unit-page" style="display: none;">
          <header class="glass rounded-2xl p-6 mb-6"><h2 class="neon text-xl font-bold">Total de Assuntos UPA Walter Garcia</h2></header>
          <div class="grid grid-cols-12 gap-6">
            <div class="col-span-12 lg:col-span-8 glass rounded-2xl p-5">
              <h3 class="font-semibold mb-4 text-cyan-400">Assuntos</h3>
              <div class="unit-assuntos space-y-2 max-h-[600px] overflow-y-auto"></div>
            </div>
            <div class="col-span-12 lg:col-span-4 glass rounded-2xl p-5">
              <h3 class="font-semibold mb-4 text-cyan-400">Record Count por Tipo de A√ß√£o</h3>
              <canvas class="unit-tipos"></canvas>
            </div>
          </div>
        </section>
        <section id="page-unit-uph-campos-eliseos" class="unit-page" style="display: none;">
          <header class="glass rounded-2xl p-6 mb-6"><h2 class="neon text-xl font-bold">Total de Assuntos UPH Campos El√≠seos</h2></header>
          <div class="grid grid-cols-12 gap-6">
            <div class="col-span-12 lg:col-span-8 glass rounded-2xl p-5">
              <h3 class="font-semibold mb-4 text-cyan-400">Assuntos</h3>
              <div class="unit-assuntos space-y-2 max-h-[600px] overflow-y-auto"></div>
            </div>
            <div class="col-span-12 lg:col-span-4 glass rounded-2xl p-5">
              <h3 class="font-semibold mb-4 text-cyan-400">Record Count por Tipo de A√ß√£o</h3>
              <canvas class="unit-tipos"></canvas>
            </div>
          </div>
        </section>
        <section id="page-unit-uph-parque-equitativa" class="unit-page" style="display: none;">
          <header class="glass rounded-2xl p-6 mb-6"><h2 class="neon text-xl font-bold">Total de Assuntos UPH Parque Equitativa</h2></header>
          <div class="grid grid-cols-12 gap-6">
            <div class="col-span-12 lg:col-span-8 glass rounded-2xl p-5">
              <h3 class="font-semibold mb-4 text-cyan-400">Assuntos</h3>
              <div class="unit-assuntos space-y-2 max-h-[600px] overflow-y-auto"></div>
            </div>
            <div class="col-span-12 lg:col-span-4 glass rounded-2xl p-5">
              <h3 class="font-semibold mb-4 text-cyan-400">Record Count por Tipo de A√ß√£o</h3>
              <canvas class="unit-tipos"></canvas>
            </div>
          </div>
        </section>
        <section id="page-unit-ubs-antonio-granja" class="unit-page" style="display: none;">
          <header class="glass rounded-2xl p-6 mb-6"><h2 class="neon text-xl font-bold">Total de Assuntos UBS Antonio Granja</h2></header>
          <div class="grid grid-cols-12 gap-6">
            <div class="col-span-12 lg:col-span-8 glass rounded-2xl p-5">
              <h3 class="font-semibold mb-4 text-cyan-400">Assuntos</h3>
              <div class="unit-assuntos space-y-2 max-h-[600px] overflow-y-auto"></div>
            </div>
            <div class="col-span-12 lg:col-span-4 glass rounded-2xl p-5">
              <h3 class="font-semibold mb-4 text-cyan-400">Record Count por Tipo de A√ß√£o</h3>
              <canvas class="unit-tipos"></canvas>
            </div>
          </div>
        </section>
        <section id="page-unit-upa-sarapui" class="unit-page" style="display: none;">
          <header class="glass rounded-2xl p-6 mb-6"><h2 class="neon text-xl font-bold">Total de Assuntos UPA Sarapu√≠</h2></header>
          <div class="grid grid-cols-12 gap-6">
            <div class="col-span-12 lg:col-span-8 glass rounded-2xl p-5">
              <h3 class="font-semibold mb-4 text-cyan-400">Assuntos</h3>
              <div class="unit-assuntos space-y-2 max-h-[600px] overflow-y-auto"></div>
            </div>
            <div class="col-span-12 lg:col-span-4 glass rounded-2xl p-5">
              <h3 class="font-semibold mb-4 text-cyan-400">Record Count por Tipo de A√ß√£o</h3>
              <canvas class="unit-tipos"></canvas>
            </div>
          </div>
        </section>
        <section id="page-unit-uph-imbarie" class="unit-page" style="display: none;">
          <header class="glass rounded-2xl p-6 mb-6"><h2 class="neon text-xl font-bold">Total de Assuntos UPH Imbari√™</h2></header>
          <div class="grid grid-cols-12 gap-6">
            <div class="col-span-12 lg:col-span-8 glass rounded-2xl p-5">
              <h3 class="font-semibold mb-4 text-cyan-400">Assuntos</h3>
              <div class="unit-assuntos space-y-2 max-h-[600px] overflow-y-auto"></div>
            </div>
            <div class="col-span-12 lg:col-span-4 glass rounded-2xl p-5">
              <h3 class="font-semibold mb-4 text-cyan-400">Record Count por Tipo de A√ß√£o</h3>
              <canvas class="unit-tipos"></canvas>
            </div>
          </div>
        </section>
        
        <!-- P√°ginas de Zeladoria -->
        <section id="page-zeladoria-home" style="display: none;">
          <div class="glass rounded-2xl p-8 md:p-12 text-center">
            <div class="mb-8">
              <div class="inline-block relative">
                <div class="w-32 h-32 md:w-40 md:h-40 mx-auto rounded-full bg-gradient-to-br from-cyan-400 via-purple-500 to-pink-500 flex items-center justify-center text-6xl md:text-7xl">
                  üèóÔ∏è
                </div>
              </div>
            </div>
            
            <h1 class="text-4xl md:text-6xl font-extrabold mb-4 neon">
              Zeladoria Municipal
            </h1>
            <h2 class="text-2xl md:text-4xl font-bold text-cyan-300 mb-8">
              Gest√£o de Servi√ßos Urbanos
            </h2>
            
            <p class="text-lg md:text-xl text-slate-300 mb-12 max-w-3xl mx-auto">
              Dashboard completo para an√°lise e gest√£o dos servi√ßos de zeladoria e manuten√ß√£o urbana
            </p>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-12">
              <div class="glass rounded-xl p-6 hover:scale-105 transition-transform duration-100">
                <div class="text-4xl mb-4">üìä</div>
                <h3 class="text-xl font-bold text-cyan-300 mb-2">An√°lises Detalhadas</h3>
                <p class="text-sm text-slate-400">
                  Visualize dados por status, categoria, departamento e muito mais
                </p>
              </div>
              
              <div class="glass rounded-xl p-6 hover:scale-105 transition-transform duration-100">
                <div class="text-4xl mb-4">üó∫Ô∏è</div>
                <h3 class="text-xl font-bold text-purple-300 mb-2">An√°lise Geogr√°fica</h3>
                <p class="text-sm text-slate-400">
                  Mapeamento de ocorr√™ncias por bairro e localiza√ß√£o
                </p>
              </div>
              
              <div class="glass rounded-xl p-6 hover:scale-105 transition-transform duration-100">
                <div class="text-4xl mb-4">‚è±Ô∏è</div>
                <h3 class="text-xl font-bold text-pink-300 mb-2">Tempo de Resolu√ß√£o</h3>
                <p class="text-sm text-slate-400">
                  Acompanhe o tempo m√©dio de resolu√ß√£o dos servi√ßos
                </p>
              </div>
            </div>
          </div>
        </section>
        
        <section id="page-zeladoria-overview" style="display: none;">
          <header class="glass rounded-2xl p-6 mb-6">
            <div class="flex items-center justify-between mb-4">
              <h2 class="neon text-xl font-bold">üìä Vis√£o Geral ‚Ä¢ Zeladoria</h2>
              <div class="text-xs text-slate-400">Dashboard executivo de zeladoria</div>
            </div>
            
            <!-- KPIs Principais -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mt-4">
              <div class="glass rounded-xl p-4 border border-cyan-500/20">
                <div class="text-xs text-slate-400 mb-1">Total de Ocorr√™ncias</div>
                <div id="zeladoria-kpi-total" class="text-2xl font-bold text-cyan-300">‚Äî</div>
            </div>
              <div class="glass rounded-xl p-4 border border-emerald-500/20">
                <div class="text-xs text-slate-400 mb-1">Fechados</div>
                <div id="zeladoria-kpi-fechados" class="text-2xl font-bold text-emerald-300">‚Äî</div>
              </div>
              <div class="glass rounded-xl p-4 border border-amber-500/20">
                <div class="text-xs text-slate-400 mb-1">Em Aberto</div>
                <div id="zeladoria-kpi-abertos" class="text-2xl font-bold text-amber-300">‚Äî</div>
              </div>
              <div class="glass rounded-xl p-4 border border-violet-500/20">
                <div class="text-xs text-slate-400 mb-1">Tempo M√©dio (dias)</div>
                <div id="zeladoria-kpi-tempo" class="text-2xl font-bold text-violet-300">‚Äî</div>
              </div>
              </div>
          </header>
          
          <section class="mb-6">
            <div class="flex items-center gap-2 mb-4">
              <div class="h-px flex-1 bg-gradient-to-r from-transparent via-blue-500/50 to-transparent"></div>
              <h2 class="text-sm font-semibold text-blue-400 uppercase tracking-wider px-3">üìà An√°lises</h2>
              <div class="h-px flex-1 bg-gradient-to-r from-transparent via-blue-500/50 to-transparent"></div>
            </div>
            <div class="grid grid-cols-12 gap-6">
              <div class="col-span-12 lg:col-span-6 glass rounded-2xl p-5">
                <h3 class="font-semibold text-cyan-300 mb-4">üìä Por Status</h3>
                <canvas id="zeladoria-chart-status"></canvas>
              </div>
              <div class="col-span-12 lg:col-span-6 glass rounded-2xl p-5">
                <h3 class="font-semibold text-violet-300 mb-4">üìÇ Por Categoria</h3>
                <canvas id="zeladoria-chart-categoria"></canvas>
              </div>
              <div class="col-span-12 lg:col-span-6 glass rounded-2xl p-5">
                <h3 class="font-semibold text-emerald-300 mb-4">üè¢ Por Departamento</h3>
                <canvas id="zeladoria-chart-departamento"></canvas>
              </div>
              <div class="col-span-12 lg:col-span-6 glass rounded-2xl p-5">
                <h3 class="font-semibold text-amber-300 mb-4">üìÖ Tend√™ncia Mensal</h3>
                <canvas id="zeladoria-chart-mensal"></canvas>
              </div>
            </div>
          </section>
        </section>
        
        <section id="page-zeladoria-status" style="display: none;">
          <header class="glass rounded-2xl p-6 mb-6">
            <div class="flex items-center justify-between mb-4">
              <h2 class="neon text-xl font-bold">üìä An√°lise por Status ‚Ä¢ Zeladoria</h2>
              <div class="text-xs text-slate-400">Distribui√ß√£o de demandas por status</div>
            </div>
            
            <!-- KPIs Principais -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mt-4">
              <div class="glass rounded-xl p-4 border border-cyan-500/20">
                <div class="text-xs text-slate-400 mb-1">Total de Demandas</div>
                <div id="zeladoria-status-kpi-total" class="text-2xl font-bold text-cyan-300">‚Äî</div>
              </div>
              <div class="glass rounded-xl p-4 border border-emerald-500/20">
                <div class="text-xs text-slate-400 mb-1">Fechados</div>
                <div id="zeladoria-status-kpi-fechados" class="text-2xl font-bold text-emerald-300">‚Äî</div>
              </div>
              <div class="glass rounded-xl p-4 border border-amber-500/20">
                <div class="text-xs text-slate-400 mb-1">Em Aberto</div>
                <div id="zeladoria-status-kpi-abertos" class="text-2xl font-bold text-amber-300">‚Äî</div>
              </div>
              <div class="glass rounded-xl p-4 border border-violet-500/20">
                <div class="text-xs text-slate-400 mb-1">Taxa de Resolu√ß√£o</div>
                <div id="zeladoria-status-kpi-taxa" class="text-2xl font-bold text-violet-300">‚Äî</div>
              </div>
            </div>
          </header>
          <div class="glass rounded-2xl p-5 mb-6">
            <canvas id="zeladoria-status-chart"></canvas>
          </div>
        </section>
        
        <section id="page-zeladoria-categoria" style="display: none;">
          <header class="glass rounded-2xl p-6 mb-6">
            <div class="flex items-center justify-between mb-4">
              <h2 class="neon text-xl font-bold">üìÇ An√°lise por Categoria ‚Ä¢ Zeladoria</h2>
              <div class="text-xs text-slate-400">Distribui√ß√£o por tipo de demanda</div>
            </div>
            
            <!-- KPIs Principais -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mt-4">
              <div class="glass rounded-xl p-4 border border-cyan-500/20">
                <div class="text-xs text-slate-400 mb-1">Total de Ocorr√™ncias</div>
                <div id="zeladoria-categoria-kpi-total" class="text-2xl font-bold text-cyan-300">‚Äî</div>
              </div>
              <div class="glass rounded-xl p-4 border border-violet-500/20">
                <div class="text-xs text-slate-400 mb-1">Categorias √önicas</div>
                <div id="zeladoria-categoria-kpi-unicas" class="text-2xl font-bold text-violet-300">‚Äî</div>
              </div>
              <div class="glass rounded-xl p-4 border border-amber-500/20">
                <div class="text-xs text-slate-400 mb-1">Categoria Mais Comum</div>
                <div id="zeladoria-categoria-kpi-mais-comum" class="text-lg font-bold text-amber-300 truncate">‚Äî</div>
              </div>
              <div class="glass rounded-xl p-4 border border-emerald-500/20">
                <div class="text-xs text-slate-400 mb-1">M√©dia por Categoria</div>
                <div id="zeladoria-categoria-kpi-media" class="text-2xl font-bold text-emerald-300">‚Äî</div>
              </div>
            </div>
          </header>
          <div class="glass rounded-2xl p-5 mb-6">
            <canvas id="zeladoria-categoria-chart"></canvas>
          </div>
        </section>
        
        <section id="page-zeladoria-departamento" style="display: none;">
          <header class="glass rounded-2xl p-6 mb-6">
            <div class="flex items-center justify-between mb-4">
              <h2 class="neon text-xl font-bold">üè¢ An√°lise por Departamento ‚Ä¢ Zeladoria</h2>
              <div class="text-xs text-slate-400">Distribui√ß√£o por departamento respons√°vel</div>
            </div>
            
            <!-- KPIs Principais -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mt-4">
              <div class="glass rounded-xl p-4 border border-cyan-500/20">
                <div class="text-xs text-slate-400 mb-1">Total de Ocorr√™ncias</div>
                <div id="zeladoria-departamento-kpi-total" class="text-2xl font-bold text-cyan-300">‚Äî</div>
              </div>
              <div class="glass rounded-xl p-4 border border-violet-500/20">
                <div class="text-xs text-slate-400 mb-1">Departamentos √önicos</div>
                <div id="zeladoria-departamento-kpi-unicos" class="text-2xl font-bold text-violet-300">‚Äî</div>
              </div>
              <div class="glass rounded-xl p-4 border border-amber-500/20">
                <div class="text-xs text-slate-400 mb-1">Dept. Mais Ativo</div>
                <div id="zeladoria-departamento-kpi-mais-ativo" class="text-lg font-bold text-amber-300 truncate">‚Äî</div>
              </div>
              <div class="glass rounded-xl p-4 border border-emerald-500/20">
                <div class="text-xs text-slate-400 mb-1">M√©dia por Departamento</div>
                <div id="zeladoria-departamento-kpi-media" class="text-2xl font-bold text-emerald-300">‚Äî</div>
              </div>
            </div>
          </header>
          <div class="glass rounded-2xl p-5 mb-6">
            <canvas id="zeladoria-departamento-chart"></canvas>
          </div>
        </section>
        
        <section id="page-zeladoria-bairro" style="display: none;">
          <header class="glass rounded-2xl p-6 mb-6">
            <div class="flex items-center justify-between mb-4">
              <h2 class="neon text-xl font-bold">üèòÔ∏è An√°lise por Bairro ‚Ä¢ Zeladoria</h2>
              <div class="text-xs text-slate-400">Distribui√ß√£o geogr√°fica das demandas</div>
            </div>
            
            <!-- KPIs Principais -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mt-4">
              <div class="glass rounded-xl p-4 border border-cyan-500/20">
                <div class="text-xs text-slate-400 mb-1">Total de Ocorr√™ncias</div>
                <div id="zeladoria-bairro-kpi-total" class="text-2xl font-bold text-cyan-300">‚Äî</div>
              </div>
              <div class="glass rounded-xl p-4 border border-violet-500/20">
                <div class="text-xs text-slate-400 mb-1">Bairros √önicos</div>
                <div id="zeladoria-bairro-kpi-unicos" class="text-2xl font-bold text-violet-300">‚Äî</div>
              </div>
              <div class="glass rounded-xl p-4 border border-amber-500/20">
                <div class="text-xs text-slate-400 mb-1">Bairro Mais Ativo</div>
                <div id="zeladoria-bairro-kpi-mais-ativo" class="text-lg font-bold text-amber-300 truncate">‚Äî</div>
              </div>
              <div class="glass rounded-xl p-4 border border-emerald-500/20">
                <div class="text-xs text-slate-400 mb-1">M√©dia por Bairro</div>
                <div id="zeladoria-bairro-kpi-media" class="text-2xl font-bold text-emerald-300">‚Äî</div>
              </div>
            </div>
          </header>
          <div class="glass rounded-2xl p-5 mb-6">
            <canvas id="zeladoria-bairro-chart"></canvas>
          </div>
        </section>
        
        <section id="page-zeladoria-responsavel" style="display: none;">
          <header class="glass rounded-2xl p-6 mb-6">
            <div class="flex items-center justify-between mb-4">
              <h2 class="neon text-xl font-bold">üë• An√°lise por Respons√°vel ‚Ä¢ Zeladoria</h2>
              <div class="text-xs text-slate-400">Distribui√ß√£o por respons√°vel</div>
            </div>
            
            <!-- KPIs Principais -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mt-4">
              <div class="glass rounded-xl p-4 border border-cyan-500/20">
                <div class="text-xs text-slate-400 mb-1">Total de Ocorr√™ncias</div>
                <div id="zeladoria-responsavel-kpi-total" class="text-2xl font-bold text-cyan-300">‚Äî</div>
              </div>
              <div class="glass rounded-xl p-4 border border-violet-500/20">
                <div class="text-xs text-slate-400 mb-1">Respons√°veis √önicos</div>
                <div id="zeladoria-responsavel-kpi-unicos" class="text-2xl font-bold text-violet-300">‚Äî</div>
              </div>
              <div class="glass rounded-xl p-4 border border-amber-500/20">
                <div class="text-xs text-slate-400 mb-1">Respons√°vel Mais Ativo</div>
                <div id="zeladoria-responsavel-kpi-mais-ativo" class="text-lg font-bold text-amber-300 truncate">‚Äî</div>
              </div>
              <div class="glass rounded-xl p-4 border border-emerald-500/20">
                <div class="text-xs text-slate-400 mb-1">M√©dia por Respons√°vel</div>
                <div id="zeladoria-responsavel-kpi-media" class="text-2xl font-bold text-emerald-300">‚Äî</div>
              </div>
            </div>
          </header>
          <div class="glass rounded-2xl p-5 mb-6">
            <canvas id="zeladoria-responsavel-chart"></canvas>
          </div>
        </section>
        
        <section id="page-zeladoria-canal" style="display: none;">
          <header class="glass rounded-2xl p-6 mb-6">
            <div class="flex items-center justify-between mb-4">
              <h2 class="neon text-xl font-bold">üìû An√°lise por Canal ‚Ä¢ Zeladoria</h2>
              <div class="text-xs text-slate-400">Distribui√ß√£o por canal de entrada</div>
            </div>
            
            <!-- KPIs Principais -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mt-4">
              <div class="glass rounded-xl p-4 border border-cyan-500/20">
                <div class="text-xs text-slate-400 mb-1">Total de Ocorr√™ncias</div>
                <div id="zeladoria-canal-kpi-total" class="text-2xl font-bold text-cyan-300">‚Äî</div>
              </div>
              <div class="glass rounded-xl p-4 border border-violet-500/20">
                <div class="text-xs text-slate-400 mb-1">Canais √önicos</div>
                <div id="zeladoria-canal-kpi-unicos" class="text-2xl font-bold text-violet-300">‚Äî</div>
              </div>
              <div class="glass rounded-xl p-4 border border-amber-500/20">
                <div class="text-xs text-slate-400 mb-1">Canal Mais Usado</div>
                <div id="zeladoria-canal-kpi-mais-usado" class="text-lg font-bold text-amber-300 truncate">‚Äî</div>
              </div>
              <div class="glass rounded-xl p-4 border border-emerald-500/20">
                <div class="text-xs text-slate-400 mb-1">M√©dia por Canal</div>
                <div id="zeladoria-canal-kpi-media" class="text-2xl font-bold text-emerald-300">‚Äî</div>
              </div>
            </div>
          </header>
          <div class="glass rounded-2xl p-5 mb-6">
            <canvas id="zeladoria-canal-chart"></canvas>
          </div>
        </section>
        
        <section id="page-zeladoria-tempo" style="display: none;">
          <header class="glass rounded-2xl p-6 mb-6">
            <div class="flex items-center justify-between mb-4">
              <h2 class="neon text-xl font-bold">‚è±Ô∏è Tempo de Resolu√ß√£o ‚Ä¢ Zeladoria</h2>
              <div class="text-xs text-slate-400">An√°lise de efici√™ncia no atendimento</div>
            </div>
            
            <!-- KPIs Principais -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mt-4">
              <div class="glass rounded-xl p-4 border border-cyan-500/20">
                <div class="text-xs text-slate-400 mb-1">Tempo M√©dio (dias)</div>
                <div id="zeladoria-tempo-kpi-medio" class="text-2xl font-bold text-cyan-300">‚Äî</div>
              </div>
              <div class="glass rounded-xl p-4 border border-emerald-500/20">
                <div class="text-xs text-slate-400 mb-1">Fechados</div>
                <div id="zeladoria-tempo-kpi-fechados" class="text-2xl font-bold text-emerald-300">‚Äî</div>
              </div>
              <div class="glass rounded-xl p-4 border border-amber-500/20">
                <div class="text-xs text-slate-400 mb-1">Em Aberto</div>
                <div id="zeladoria-tempo-kpi-abertos" class="text-2xl font-bold text-amber-300">‚Äî</div>
              </div>
              <div class="glass rounded-xl p-4 border border-violet-500/20">
                <div class="text-xs text-slate-400 mb-1">Efici√™ncia</div>
                <div id="zeladoria-tempo-kpi-eficiencia" class="text-2xl font-bold text-violet-300">‚Äî</div>
              </div>
            </div>
          </header>
          <div class="glass rounded-2xl p-5 mb-6">
            <canvas id="zeladoria-tempo-chart"></canvas>
          </div>
        </section>
        
        <section id="page-zeladoria-mensal" style="display: none;">
          <header class="glass rounded-2xl p-6 mb-6">
            <div class="flex items-center justify-between mb-4">
              <h2 class="neon text-xl font-bold">üìÖ An√°lise Mensal ‚Ä¢ Zeladoria</h2>
              <div class="text-xs text-slate-400">Evolu√ß√£o temporal das demandas</div>
            </div>
            
            <!-- KPIs Principais -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mt-4">
              <div class="glass rounded-xl p-4 border border-cyan-500/20">
                <div class="text-xs text-slate-400 mb-1">Total no Per√≠odo</div>
                <div id="zeladoria-mensal-kpi-total" class="text-2xl font-bold text-cyan-300">‚Äî</div>
              </div>
              <div class="glass rounded-xl p-4 border border-violet-500/20">
                <div class="text-xs text-slate-400 mb-1">M√©dia Mensal</div>
                <div id="zeladoria-mensal-kpi-media" class="text-2xl font-bold text-violet-300">‚Äî</div>
              </div>
              <div class="glass rounded-xl p-4 border border-amber-500/20">
                <div class="text-xs text-slate-400 mb-1">Pico de Demanda</div>
                <div id="zeladoria-mensal-kpi-pico" class="text-2xl font-bold text-amber-300">‚Äî</div>
              </div>
              <div class="glass rounded-xl p-4 border border-emerald-500/20">
                <div class="text-xs text-slate-400 mb-1">Crescimento</div>
                <div id="zeladoria-mensal-kpi-crescimento" class="text-2xl font-bold text-emerald-300">‚Äî</div>
              </div>
            </div>
          </header>
          <div class="glass rounded-2xl p-5 mb-6">
            <canvas id="zeladoria-mensal-chart"></canvas>
          </div>
        </section>
        
        <section id="page-zeladoria-geografica" style="display: none;">
          <header class="glass rounded-2xl p-6 mb-6">
            <div class="flex items-center justify-between mb-4">
              <h2 class="neon text-xl font-bold">üó∫Ô∏è An√°lise Geogr√°fica ‚Ä¢ Zeladoria</h2>
              <div class="text-xs text-slate-400">Distribui√ß√£o geogr√°fica das demandas</div>
            </div>
            
            <!-- KPIs Principais -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mt-4">
              <div class="glass rounded-xl p-4 border border-cyan-500/20">
                <div class="text-xs text-slate-400 mb-1">Total de Bairros</div>
                <div id="zeladoria-geografica-kpi-bairros" class="text-2xl font-bold text-cyan-300">‚Äî</div>
              </div>
              <div class="glass rounded-xl p-4 border border-violet-500/20">
                <div class="text-xs text-slate-400 mb-1">Total de Ocorr√™ncias</div>
                <div id="zeladoria-geografica-kpi-total" class="text-2xl font-bold text-violet-300">‚Äî</div>
              </div>
              <div class="glass rounded-xl p-4 border border-amber-500/20">
                <div class="text-xs text-slate-400 mb-1">Bairro Mais Ativo</div>
                <div id="zeladoria-geografica-kpi-mais-ativo" class="text-lg font-bold text-amber-300 truncate">‚Äî</div>
              </div>
              <div class="glass rounded-xl p-4 border border-emerald-500/20">
                <div class="text-xs text-slate-400 mb-1">M√©dia por Bairro</div>
                <div id="zeladoria-geografica-kpi-media" class="text-2xl font-bold text-emerald-300">‚Äî</div>
              </div>
            </div>
          </header>
          <div class="glass rounded-2xl p-5 mb-6">
            <div id="zeladoria-geografica-content">
              <p class="text-slate-400">Carregando dados geogr√°ficos...</p>
            </div>
          </div>
        </section>
        
        <section id="page-zeladoria-mapa" style="display: none;">
          <header class="glass rounded-2xl p-6 mb-6">
            <div class="flex items-center justify-between mb-4">
              <h2 class="neon text-xl font-bold">üó∫Ô∏è Mapa Interativo ‚Ä¢ Zeladoria</h2>
              <div class="text-xs text-slate-400">Visualiza√ß√£o geogr√°fica das demandas</div>
            </div>
            <div id="zeladoria-mapa-stats" class="mb-4">
              <div class="glass rounded-lg p-3 text-center text-slate-400">Carregando estat√≠sticas...</div>
            </div>
            <div class="flex gap-4 mb-4 flex-wrap items-center">
              <select id="mapa-filter-status" class="px-4 py-2 bg-slate-800 rounded-lg text-sm border border-slate-700">
                <option value="">Carregando status...</option>
              </select>
              <select id="mapa-filter-categoria" class="px-4 py-2 bg-slate-800 rounded-lg text-sm border border-slate-700">
                <option value="">Carregando categorias...</option>
              </select>
              <select id="mapa-filter-departamento" class="px-4 py-2 bg-slate-800 rounded-lg text-sm border border-slate-700">
                <option value="">Carregando departamentos...</option>
              </select>
              <select id="mapa-filter-distrito" class="px-4 py-2 bg-slate-800 rounded-lg text-sm border border-slate-700">
                <option value="">Carregando distritos...</option>
              </select>
              <select id="mapa-theme-select" class="px-4 py-2 bg-slate-800 rounded-lg text-sm border border-slate-700">
                <option value="osm">OpenStreetMap</option>
              </select>
              <button id="mapa-clear-filters" class="px-4 py-2 bg-slate-700 hover:bg-slate-600 rounded-lg text-sm font-semibold transition-colors">
                üîÑ Limpar Filtros
              </button>
            </div>
            <div class="flex gap-4 mb-4 flex-wrap items-center text-sm">
              <div class="flex items-center gap-2 glass rounded-lg px-3 py-2">
                <input type="checkbox" id="mapa-toggle-clusters" checked class="w-4 h-4 rounded border-slate-600 bg-slate-700">
                <label for="mapa-toggle-clusters" class="text-slate-300 cursor-pointer">Agrupar marcadores</label>
              </div>
              <div class="flex items-center gap-2 glass rounded-lg px-3 py-2">
                <label for="mapa-marker-size" class="text-slate-300">Tamanho:</label>
                <select id="mapa-marker-size" class="px-2 py-1 bg-slate-800 rounded text-xs border border-slate-700">
                  <option value="small">Pequeno</option>
                  <option value="normal" selected>Normal</option>
                  <option value="large">Grande</option>
                </select>
              </div>
              <div class="flex items-center gap-2 glass rounded-lg px-3 py-2">
                <input type="checkbox" id="mapa-toggle-legend" checked class="w-4 h-4 rounded border-slate-600 bg-slate-700">
                <label for="mapa-toggle-legend" class="text-slate-300 cursor-pointer">Legenda</label>
              </div>
              <div class="flex items-center gap-2 glass rounded-lg px-3 py-2">
                <input type="checkbox" id="mapa-toggle-coordinates" checked class="w-4 h-4 rounded border-slate-600 bg-slate-700">
                <label for="mapa-toggle-coordinates" class="text-slate-300 cursor-pointer">Coordenadas</label>
              </div>
              <div class="flex items-center gap-2 glass rounded-lg px-3 py-2">
                <input type="checkbox" id="mapa-toggle-heatmap" class="w-4 h-4 rounded border-slate-600 bg-slate-700">
                <label for="mapa-toggle-heatmap" class="text-slate-300 cursor-pointer">üó∫Ô∏è Mapa de Calor</label>
              </div>
            </div>
          </header>
          <div id="zeladoria-mapa-content" class="glass rounded-2xl p-6">
            <div id="zeladoria-map-container" style="height: 600px; width: 100%; border-radius: 12px; overflow: hidden;"></div>
          </div>
        </section>
        
        <!-- P√°ginas do Colab - Zeladoria -->
        <section id="page-zeladoria-colab-demandas" style="display: none;">
          <div class="glass rounded-2xl p-6 mb-6">
            <div class="flex items-center justify-between mb-4">
              <h2 class="neon text-2xl font-bold">üìã Demandas do Colab</h2>
              <button onclick="loadSection('zeladoria-colab-criar')" class="px-4 py-2 bg-cyan-500 hover:bg-cyan-600 rounded-lg text-sm font-semibold transition-colors">
                ‚ûï Nova Demanda
              </button>
            </div>
            <div class="flex gap-4 mb-4 flex-wrap">
              <select id="zeladoria-colab-filter-status" class="px-4 py-2 bg-slate-800 rounded-lg text-sm border border-slate-700">
                <option value="">Todos os Status</option>
                <option value="NOVO">Novo</option>
                <option value="ABERTO">Aberto</option>
                <option value="ATENDIMENTO">Em Atendimento</option>
                <option value="ATENDIDO">Atendido</option>
                <option value="FECHADO">Fechado</option>
                <option value="RECUSADO">Recusado</option>
              </select>
              <input type="date" id="zeladoria-colab-filter-start-date" class="px-4 py-2 bg-slate-800 rounded-lg text-sm border border-slate-700">
              <input type="date" id="zeladoria-colab-filter-end-date" class="px-4 py-2 bg-slate-800 rounded-lg text-sm border border-slate-700">
              <button onclick="loadColabDemandas()" class="px-4 py-2 bg-emerald-500 hover:bg-emerald-600 rounded-lg text-sm font-semibold transition-colors">
                üîç Buscar
              </button>
            </div>
          </div>
          <div id="zeladoria-colab-lista-demandas" class="space-y-4">
            <div class="glass rounded-xl p-6 text-center text-slate-400">
              Carregando demandas...
            </div>
          </div>
        </section>
        
        <section id="page-zeladoria-colab-criar" style="display: none;">
          <div class="glass rounded-2xl p-6 mb-6">
            <h2 class="neon text-2xl font-bold mb-4">‚ûï Criar Nova Demanda</h2>
            <form id="zeladoria-colab-form-criar" class="space-y-4">
              <div>
                <label class="block text-sm text-slate-400 mb-2">Descri√ß√£o *</label>
                <textarea id="zeladoria-colab-descricao" required class="w-full px-4 py-2 bg-slate-800 rounded-lg border border-slate-700 text-sm" rows="4" placeholder="Descreva a demanda detalhadamente..."></textarea>
              </div>
              <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                  <label class="block text-sm text-slate-400 mb-2">Endere√ßo *</label>
                  <input type="text" id="zeladoria-colab-endereco" required class="w-full px-4 py-2 bg-slate-800 rounded-lg border border-slate-700 text-sm" placeholder="Rua, n√∫mero...">
                </div>
                <div>
                  <label class="block text-sm text-slate-400 mb-2">Bairro</label>
                  <input type="text" id="zeladoria-colab-bairro" class="w-full px-4 py-2 bg-slate-800 rounded-lg border border-slate-700 text-sm" placeholder="Nome do bairro">
                </div>
              </div>
              <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                  <label class="block text-sm text-slate-400 mb-2">Latitude *</label>
                  <input type="number" id="zeladoria-colab-latitude" required step="any" class="w-full px-4 py-2 bg-slate-800 rounded-lg border border-slate-700 text-sm" placeholder="-22.7855">
                </div>
                <div>
                  <label class="block text-sm text-slate-400 mb-2">Longitude *</label>
                  <input type="number" id="zeladoria-colab-longitude" required step="any" class="w-full px-4 py-2 bg-slate-800 rounded-lg border border-slate-700 text-sm" placeholder="-43.3093">
                </div>
              </div>
              <div>
                <label class="block text-sm text-slate-400 mb-2">Categoria *</label>
                <select id="zeladoria-colab-categoria-id" required class="w-full px-4 py-2 bg-slate-800 rounded-lg border border-slate-700 text-sm">
                  <option value="">Carregando categorias...</option>
                </select>
              </div>
              <div>
                <label class="block text-sm text-slate-400 mb-2">URLs de Imagens (separadas por v√≠rgula)</label>
                <input type="text" id="zeladoria-colab-imagens" class="w-full px-4 py-2 bg-slate-800 rounded-lg border border-slate-700 text-sm" placeholder="https://exemplo.com/img1.jpg, https://exemplo.com/img2.jpg">
              </div>
              <div class="flex gap-4">
                <button type="submit" class="px-6 py-2 bg-cyan-500 hover:bg-cyan-600 rounded-lg font-semibold transition-colors">
                  ‚úÖ Criar Demanda
                </button>
                <button type="button" onclick="loadSection('zeladoria-colab-demandas')" class="px-6 py-2 bg-slate-700 hover:bg-slate-600 rounded-lg font-semibold transition-colors">
                  Cancelar
                </button>
              </div>
            </form>
          </div>
        </section>
        
        <section id="page-zeladoria-colab-categorias" style="display: none;">
          <div class="glass rounded-2xl p-6 mb-6">
            <h2 class="neon text-2xl font-bold mb-4">üè∑Ô∏è Categorias do Colab</h2>
          </div>
          <div id="zeladoria-colab-lista-categorias" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
            <div class="glass rounded-xl p-6 text-center text-slate-400">
              Carregando categorias...
            </div>
          </div>
        </section>
        
        <section id="page-zeladoria-colab-mapa" style="display: none;">
          <div class="glass rounded-2xl p-6 mb-6">
            <div class="flex items-center justify-between mb-4">
              <h2 class="neon text-2xl font-bold">üó∫Ô∏è Mapa Interativo - Demandas Colab</h2>
            </div>
            <div id="zeladoria-colab-mapa-stats" class="mb-4">
              <div class="glass rounded-lg p-3 text-center text-slate-400">Carregando estat√≠sticas...</div>
            </div>
            <div class="flex gap-4 mb-4 flex-wrap">
              <select id="zeladoria-colab-mapa-filter-status" class="px-4 py-2 bg-slate-800 rounded-lg text-sm border border-slate-700">
                <option value="">Carregando status...</option>
              </select>
              <select id="zeladoria-colab-mapa-filter-categoria" class="px-4 py-2 bg-slate-800 rounded-lg text-sm border border-slate-700">
                <option value="">Carregando categorias...</option>
              </select>
              <select id="zeladoria-colab-mapa-theme-select" class="px-4 py-2 bg-slate-800 rounded-lg text-sm border border-slate-700">
                <option value="osm">OpenStreetMap</option>
              </select>
              <button id="zeladoria-colab-mapa-clear-filters" class="px-4 py-2 bg-slate-700 hover:bg-slate-600 rounded-lg text-sm font-semibold transition-colors">
                üîÑ Limpar Filtros
              </button>
            </div>
          </div>
          <div id="zeladoria-colab-mapa-content" class="glass rounded-2xl p-6">
            <div id="zeladoria-colab-map-container" style="height: 600px; width: 100%; border-radius: 12px; overflow: hidden;"></div>
          </div>
        </section>
        
        <section id="page-zeladoria-cora-chat" style="display: none;">
          <div class="glass rounded-2xl p-6 mb-6">
            <h2 class="neon text-2xl font-bold mb-4">üí¨ Cora - Assistente Virtual</h2>
          </div>
          <div class="grid grid-cols-12 gap-6">
            <div class="col-span-12 glass rounded-2xl p-5">
              <div class="flex flex-col h-[600px]">
                <div id="chatMessages" class="flex-1 overflow-y-auto mb-4 space-y-4 p-4 bg-slate-900/30 rounded-lg">
                  <div class="text-center text-slate-400 py-4">Carregando mensagens...</div>
                </div>
                <form id="chatForm" class="flex gap-2" onsubmit="return false;" action="javascript:void(0);">
                  <input 
                    type="text" 
                    id="chatInput" 
                    placeholder="Digite sua mensagem..." 
                    class="flex-1 bg-slate-800/60 border border-white/10 rounded-lg px-4 py-2 text-sm text-slate-200 placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-purple-500/50"
                    autocomplete="off"
                  />
                  <button 
                    type="button" 
                    id="chatSubmitBtn"
                    class="px-4 py-2 bg-gradient-to-r from-purple-500 to-pink-500 rounded-lg text-white font-semibold hover:from-purple-600 hover:to-pink-600 transition-all glow-ring"
                  >
                    Enviar
                  </button>
                </form>
              </div>
            </div>
          </div>
        </section>
        
        <!-- P√°ginas de E-SIC -->
        <section id="page-esic-home" style="display: none;">
          <div class="glass rounded-2xl p-8 md:p-12 text-center">
            <div class="mb-8">
              <div class="inline-block relative">
                <div class="w-32 h-32 md:w-40 md:h-40 mx-auto rounded-full bg-gradient-to-br from-cyan-400 via-purple-500 to-pink-500 flex items-center justify-center text-6xl md:text-7xl">
                  üìã
                </div>
              </div>
            </div>
            
            <h1 class="text-4xl md:text-6xl font-extrabold mb-4 neon">
              E-SIC
            </h1>
            <h2 class="text-2xl md:text-4xl font-bold text-cyan-300 mb-8">
              Sistema Eletr√¥nico de Informa√ß√µes ao Cidad√£o
            </h2>
            
            <p class="text-lg md:text-xl text-slate-300 mb-12 max-w-3xl mx-auto">
              Dashboard completo para an√°lise e gest√£o das solicita√ß√µes de informa√ß√£o ao cidad√£o
            </p>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-12">
              <div class="glass rounded-xl p-6 hover:scale-105 transition-transform duration-100">
                <div class="text-4xl mb-4">üìä</div>
                <h3 class="text-xl font-bold text-cyan-300 mb-2">An√°lises Detalhadas</h3>
                <p class="text-sm text-slate-400">
                  Visualize dados por status, tipo de informa√ß√£o, respons√°vel e muito mais
                </p>
              </div>
              <div class="glass rounded-xl p-6 hover:scale-105 transition-transform duration-100">
                <div class="text-4xl mb-4">üìà</div>
                <h3 class="text-xl font-bold text-emerald-300 mb-2">M√©tricas em Tempo Real</h3>
                <p class="text-sm text-slate-400">
                  Acompanhe o desempenho e tempo m√©dio de resposta das solicita√ß√µes
                </p>
              </div>
              <div class="glass rounded-xl p-6 hover:scale-105 transition-transform duration-100">
                <div class="text-4xl mb-4">üîç</div>
                <h3 class="text-xl font-bold text-violet-300 mb-2">Transpar√™ncia</h3>
                <p class="text-sm text-slate-400">
                  Acesso transparente √†s informa√ß√µes p√∫blicas solicitadas pelos cidad√£os
                </p>
              </div>
            </div>
            
            <div class="flex flex-wrap justify-center gap-4">
              <button onclick="loadSection('esic-overview')" class="px-6 py-3 bg-gradient-to-r from-cyan-500 to-blue-600 hover:from-cyan-600 hover:to-blue-700 rounded-lg font-semibold transition-all transform hover:scale-105 shadow-lg">
                üìä Ver Vis√£o Geral
              </button>
              <button onclick="loadSection('esic-status')" class="px-6 py-3 bg-gradient-to-r from-purple-500 to-pink-600 hover:from-purple-600 hover:to-pink-700 rounded-lg font-semibold transition-all transform hover:scale-105 shadow-lg">
                üìà An√°lise por Status
              </button>
            </div>
          </div>
        </section>
        
        <section id="page-esic-overview" style="display: none;">
          <header class="glass rounded-2xl p-6 mb-6">
            <div class="flex items-center justify-between mb-4">
              <h2 class="neon text-xl font-bold">üìä Vis√£o Geral ‚Ä¢ E-SIC</h2>
              <div class="text-xs text-slate-400">Dashboard executivo</div>
            </div>
            
            <!-- KPIs Principais -->
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mt-4">
              <div class="glass rounded-xl p-4">
                <div class="text-slate-400 text-sm mb-1">Total de Solicita√ß√µes</div>
                <div id="esic-kpi-total" class="text-2xl font-bold text-cyan-300">-</div>
              </div>
              <div class="glass rounded-xl p-4">
                <div class="text-slate-400 text-sm mb-1">Encerradas</div>
                <div id="esic-kpi-encerradas" class="text-2xl font-bold text-emerald-300">-</div>
              </div>
              <div class="glass rounded-xl p-4">
                <div class="text-slate-400 text-sm mb-1">Em Aberto</div>
                <div id="esic-kpi-abertas" class="text-2xl font-bold text-amber-300">-</div>
              </div>
              <div class="glass rounded-xl p-4">
                <div class="text-slate-400 text-sm mb-1">Tempo M√©dio</div>
                <div id="esic-kpi-tempo" class="text-2xl font-bold text-violet-300">-</div>
              </div>
            </div>
          </header>
          
          <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <div class="glass rounded-2xl p-6">
              <h3 class="font-semibold mb-4 text-cyan-400">Solicita√ß√µes por Status</h3>
              <canvas id="esic-chart-status"></canvas>
            </div>
            <div class="glass rounded-2xl p-6">
              <h3 class="font-semibold mb-4 text-cyan-400">Solicita√ß√µes por Tipo de Informa√ß√£o</h3>
              <canvas id="esic-chart-tipo-informacao"></canvas>
            </div>
            <div class="glass rounded-2xl p-6">
              <h3 class="font-semibold mb-4 text-cyan-400">Solicita√ß√µes por Respons√°vel</h3>
              <canvas id="esic-chart-responsavel"></canvas>
            </div>
            <div class="glass rounded-2xl p-6">
              <h3 class="font-semibold mb-4 text-cyan-400">Evolu√ß√£o Mensal</h3>
              <canvas id="esic-chart-mensal"></canvas>
            </div>
          </div>
        </section>
        
        <section id="page-esic-status" style="display: none;">
          <header class="glass rounded-2xl p-6 mb-6">
            <div class="flex items-center justify-between mb-4">
              <h2 class="neon text-xl font-bold">üìà Solicita√ß√µes por Status ‚Ä¢ E-SIC</h2>
            </div>
          </header>
          
          <div id="esic-status-stats" class="mb-6"></div>
          
          <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
            <div class="glass rounded-2xl p-5">
              <h3 class="font-semibold mb-4 text-cyan-400">Distribui√ß√£o por Status</h3>
              <canvas id="esic-chart-status-detail"></canvas>
            </div>
            <div class="glass rounded-2xl p-5">
              <h3 class="font-semibold mb-4 text-cyan-400">Ranking de Status</h3>
              <div id="esic-status-ranking" class="space-y-1 max-h-[500px] overflow-y-auto"></div>
            </div>
          </div>
        </section>
        
        <section id="page-esic-tipo-informacao" style="display: none;">
          <header class="glass rounded-2xl p-6 mb-6">
            <div class="flex items-center justify-between mb-4">
              <h2 class="neon text-xl font-bold">üìë Solicita√ß√µes por Tipo de Informa√ß√£o ‚Ä¢ E-SIC</h2>
            </div>
          </header>
          
          <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
            <div class="glass rounded-2xl p-5">
              <h3 class="font-semibold mb-4 text-cyan-400">Distribui√ß√£o por Tipo</h3>
              <canvas id="esic-chart-tipo-informacao-detail"></canvas>
            </div>
            <div class="glass rounded-2xl p-5">
              <h3 class="font-semibold mb-4 text-cyan-400">Ranking de Tipos</h3>
              <div id="esic-tipo-ranking" class="space-y-1 max-h-[500px] overflow-y-auto"></div>
            </div>
          </div>
        </section>
        
        <section id="page-esic-responsavel" style="display: none;">
          <header class="glass rounded-2xl p-6 mb-6">
            <div class="flex items-center justify-between mb-4">
              <h2 class="neon text-xl font-bold">üë§ Solicita√ß√µes por Respons√°vel ‚Ä¢ E-SIC</h2>
            </div>
          </header>
          
          <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
            <div class="glass rounded-2xl p-5">
              <h3 class="font-semibold mb-4 text-cyan-400">Distribui√ß√£o por Respons√°vel</h3>
              <canvas id="esic-chart-responsavel-detail"></canvas>
            </div>
            <div class="glass rounded-2xl p-5">
              <h3 class="font-semibold mb-4 text-cyan-400">Ranking de Respons√°veis</h3>
              <div id="esic-responsavel-ranking" class="space-y-1 max-h-[500px] overflow-y-auto"></div>
            </div>
          </div>
        </section>
        
        <section id="page-esic-unidade" style="display: none;">
          <header class="glass rounded-2xl p-6 mb-6">
            <div class="flex items-center justify-between mb-4">
              <h2 class="neon text-xl font-bold">üè¢ Solicita√ß√µes por Unidade ‚Ä¢ E-SIC</h2>
            </div>
          </header>
          
          <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
            <div class="glass rounded-2xl p-5">
              <h3 class="font-semibold mb-4 text-cyan-400">Distribui√ß√£o por Unidade</h3>
              <canvas id="esic-chart-unidade-detail"></canvas>
            </div>
            <div class="glass rounded-2xl p-5">
              <h3 class="font-semibold mb-4 text-cyan-400">Ranking de Unidades</h3>
              <div id="esic-unidade-ranking" class="space-y-1 max-h-[500px] overflow-y-auto"></div>
            </div>
          </div>
        </section>
        
        <section id="page-esic-canal" style="display: none;">
          <header class="glass rounded-2xl p-6 mb-6">
            <div class="flex items-center justify-between mb-4">
              <h2 class="neon text-xl font-bold">üìû Solicita√ß√µes por Canal ‚Ä¢ E-SIC</h2>
            </div>
          </header>
          
          <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
            <div class="glass rounded-2xl p-5">
              <h3 class="font-semibold mb-4 text-cyan-400">Distribui√ß√£o por Canal</h3>
              <canvas id="esic-chart-canal-detail"></canvas>
            </div>
            <div class="glass rounded-2xl p-5">
              <h3 class="font-semibold mb-4 text-cyan-400">Ranking de Canais</h3>
              <div id="esic-canal-ranking" class="space-y-1 max-h-[500px] overflow-y-auto"></div>
            </div>
          </div>
        </section>
        
        <section id="page-esic-mensal" style="display: none;">
          <header class="glass rounded-2xl p-6 mb-6">
            <div class="flex items-center justify-between mb-4">
              <h2 class="neon text-xl font-bold">üìÖ An√°lise Mensal ‚Ä¢ E-SIC</h2>
            </div>
          </header>
          
          <div id="esic-mensal-stats" class="mb-6"></div>
          
          <div class="glass rounded-2xl p-5 mb-6">
            <h3 class="font-semibold mb-4 text-cyan-400">Evolu√ß√£o Mensal</h3>
            <canvas id="esic-chart-mensal-detail"></canvas>
          </div>
        </section>
      </main>

      <!-- Modal: Informa√ß√µes de Secretarias -->
      <div id="secretariasInfoModal" class="fixed inset-0 bg-slate-900/80 backdrop-blur-sm z-[1200] items-center justify-center hidden">
        <div class="max-w-4xl w-full mx-4 glass rounded-2xl p-6 border border-cyan-500/30 shadow-2xl">
          <div class="flex items-start justify-between mb-4">
            <div>
              <h2 class="text-lg font-semibold text-cyan-300 flex items-center gap-2">
                <span>üèõÔ∏è Informa√ß√µes de Secretarias</span>
              </h2>
              <p class="text-xs text-slate-400 mt-1">
                Dados carregados automaticamente da planilha <strong>Dados e emails.xlsx</strong>.
                Selecione uma secretaria para visualizar detalhes e imprimir em folha A4.
              </p>
            </div>
            <button id="secretariasInfoClose" class="text-slate-400 hover:text-slate-100 text-xl leading-none px-2">
              ‚úï
            </button>
          </div>

          <div id="secretariasInfoContent" class="space-y-4">
            <div id="secretariasInfoLoading" class="flex items-center gap-3 text-sm text-slate-300">
              <span class="animate-spin text-lg">‚è≥</span>
              <span>Carregando dados das secretarias...</span>
            </div>

            <div id="secretariasInfoError" class="hidden text-sm text-rose-300 bg-rose-500/10 border border-rose-500/40 rounded-lg px-3 py-2">
              Erro ao carregar informa√ß√µes de secretarias. Verifique se a planilha foi importada.
            </div>

            <div id="secretariasInfoList" class="hidden max-h-[420px] overflow-y-auto border border-white/5 rounded-xl">
              <table class="min-w-full text-sm">
                <thead class="bg-slate-900/60 text-slate-300 text-xs uppercase sticky top-0 z-10">
                  <tr>
                    <th class="px-3 py-2 text-left w-10"></th>
                    <th class="px-3 py-2 text-left">Secretaria / √ìrg√£o</th>
                    <th class="px-3 py-2 text-left">Email</th>
                    <th class="px-3 py-2 text-left">Telefone</th>
                    <th class="px-3 py-2 text-left">Distrito</th>
                  </tr>
                </thead>
                <tbody id="secretariasInfoTableBody" class="divide-y divide-white/5 bg-slate-950/40"></tbody>
              </table>
            </div>

            <div class="flex items-center justify-between pt-3 border-t border-white/5">
              <div id="secretariasInfoSummary" class="text-xs text-slate-400">
                ‚Äî
              </div>
              <div class="flex items-center gap-2">
                <button id="secretariasInfoPrint" class="px-4 py-2 rounded-lg bg-cyan-500/90 hover:bg-cyan-400 text-slate-900 text-sm font-semibold shadow-md disabled:opacity-40 disabled:cursor-not-allowed"
                        disabled>
                  üñ®Ô∏è Imprimir Secretaria Selecionada
                </button>
                <button id="secretariasInfoCancel" class="px-3 py-2 rounded-lg bg-slate-800/80 hover:bg-slate-700 text-xs text-slate-200">
                  Fechar
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Scripts -->
    <script src="/scripts/utils/lazy-libraries.js"></script>
    <script src="/scripts/utils/logger.js"></script>
    <script src="/scripts/utils/errorHandler.js"></script>
    <script src="/scripts/utils/dataValidator.js"></script>
    <script src="/scripts/utils/loadingManager.js"></script>
    <script src="/scripts/utils/pageHelper.js"></script>
    <script src="/scripts/utils/timerManager.js"></script>
    <script src="/scripts/utils/dateUtils.js" defer></script>
    <script src="/scripts/core/config.js"></script>
    <script src="/scripts/core/cache-config.js"></script>
    <script src="/scripts/core/dataLoader.js"></script>
    <script src="/scripts/core/global-store.js" defer></script>
    <!-- Chart Communication - M√≥dulos (ordem importa) -->
    <!-- Chart Communication - M√≥dulos (ordem importa) -->
    <!-- MIGRA√á√ÉO TYPESCRIPT: Arquivos .ts mantidos para desenvolvimento, .js para produ√ß√£o -->
    <!-- TODO: Configurar build process para compilar .ts ‚Üí .js -->
    <script src="/scripts/core/chart-communication/event-bus.js"></script>
    <script src="/scripts/core/chart-communication/chart-registry.js"></script>
    <script src="/scripts/core/chart-communication/global-filters.js"></script>
    <script src="/scripts/core/chart-communication/auto-connect.js"></script>
    <script src="/scripts/core/chart-communication.js" defer></script>
    <script src="/scripts/core/crossfilter-overview.js" defer></script>
    <!-- Script de teste do crossfilter (apenas em desenvolvimento) -->
    <script src="/scripts/test/test-crossfilter-browser.js" defer></script>
    <script src="/scripts/test/test-crossfilter-aggregation.js" defer></script>
    <!-- MIGRA√á√ÉO TYPESCRIPT: chart-legend.ts criado, mantendo .js para compatibilidade -->
    <script src="/scripts/core/chart-legend.js" defer></script>
    <script src="/scripts/core/chart-factory.js" defer></script>
    <script src="/scripts/modules/data-tables.js" defer></script>
    <!-- P√°ginas Painel Central -->
    <script src="/scripts/pages/central/central-dashboard.js" defer></script>
    <!-- P√°ginas Ouvidoria -->
    <script src="/scripts/core/month-filter-helper.js" defer></script>
    <script src="/scripts/pages/ouvidoria/overview.js" defer></script>
    <script src="/scripts/pages/ouvidoria/orgao-mes.js" defer></script>
    <script src="/scripts/pages/ouvidoria/tempo-medio.js" defer></script>
    <script src="/scripts/pages/ouvidoria/vencimento.js" defer></script>
    <script src="/scripts/pages/ouvidoria/protocolos-demora.js" defer></script>
    <script src="/scripts/pages/ouvidoria/notificacoes.js" defer></script>
    <script src="/scripts/pages/filtros-avancados.js" defer></script>
    <script src="/scripts/pages/ouvidoria/tema.js" defer></script>
    <script src="/scripts/pages/ouvidoria/assunto.js" defer></script>
    <script src="/scripts/pages/ouvidoria/tipo.js" defer></script>
    <script src="/scripts/pages/ouvidoria/status.js" defer></script>
    <script src="/scripts/pages/ouvidoria/bairro.js" defer></script>
    <script src="/scripts/pages/ouvidoria/responsavel.js" defer></script>
    <script src="/scripts/pages/ouvidoria/canal.js" defer></script>
    <script src="/scripts/pages/ouvidoria/prioridade.js" defer></script>
    <script src="/scripts/pages/ouvidoria/cadastrante.js" defer></script>
    <script src="/scripts/pages/ouvidoria/reclamacoes.js" defer></script>
    <script src="/scripts/pages/ouvidoria/projecao-2026.js" defer></script>
    <script src="/scripts/pages/ouvidoria/cora-chat.js" defer></script>
    <script src="/scripts/pages/ouvidoria/unidades-saude.js" defer></script>
    <script src="/scripts/pages/ouvidoria/unit.js" defer></script>
    <script src="/scripts/utils/generate-unit-pages.js" defer></script>
    <!-- P√°ginas Zeladoria -->
    <script src="/scripts/pages/zeladoria/zeladoria-overview.js" defer></script>
    <script src="/scripts/pages/zeladoria/zeladoria-status.js" defer></script>
    <script src="/scripts/pages/zeladoria/zeladoria-categoria.js" defer></script>
    <script src="/scripts/pages/zeladoria/zeladoria-departamento.js" defer></script>
    <script src="/scripts/pages/zeladoria/zeladoria-bairro.js" defer></script>
    <script src="/scripts/pages/zeladoria/zeladoria-responsavel.js" defer></script>
    <script src="/scripts/pages/zeladoria/zeladoria-canal.js" defer></script>
    <script src="/scripts/pages/zeladoria/zeladoria-tempo.js" defer></script>
    <script src="/scripts/pages/zeladoria/zeladoria-mensal.js" defer></script>
    <script src="/scripts/pages/zeladoria/zeladoria-geografica.js" defer></script>
    <script src="/scripts/pages/zeladoria/zeladoria-mapa.js" defer></script>
    <script src="/scripts/pages/zeladoria/zeladoria-colab.js" defer></script>
    <script src="/scripts/pages/esic/esic-overview.js" defer></script>
    <script src="/scripts/pages/esic/esic-status.js" defer></script>
    <script src="/scripts/pages/esic/esic-tipo-informacao.js" defer></script>
    <script src="/scripts/pages/esic/esic-responsavel.js" defer></script>
    <script src="/scripts/pages/esic/esic-unidade.js" defer></script>
    <script src="/scripts/pages/esic/esic-canal.js" defer></script>
    <script src="/scripts/pages/esic/esic-mensal.js" defer></script>
    <script src="/scripts/utils/secretarias-info.js" defer></script>
    <script src="/scripts/main.js" defer></script>
    
    <!-- Tratamento global de promises n√£o tratadas -->
    <script>
      // Capturar promises n√£o tratadas para evitar erros silenciosos
      window.addEventListener('unhandledrejection', (event) => {
        // Ignorar erros de extens√µes do navegador
        if (event.reason && (
          event.reason.message?.includes('message channel closed') ||
          event.reason.message?.includes('Extension context invalidated') ||
          event.reason.message?.includes('Receiving end does not exist')
        )) {
          event.preventDefault(); // Previne o erro no console
          return;
        }
        
        // Logar outros erros n√£o tratados
        if (window.Logger) {
          window.Logger.error('Promise rejeitada n√£o tratada:', event.reason);
        } else {
          console.error('Promise rejeitada n√£o tratada:', event.reason);
        }
      });
      
      // Capturar erros globais
      window.addEventListener('error', (event) => {
        // Ignorar erros de extens√µes do navegador
        if (event.message && (
          event.message.includes('message channel closed') ||
          event.message.includes('Extension context invalidated') ||
          event.message.includes('Receiving end does not exist')
        )) {
          event.preventDefault();
          return;
        }
      });
    </script>
  </body>
</html>

